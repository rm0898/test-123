<xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.1.0_CIS_NGINX_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
   <xccdf:status date="2019-05-20">draft</xccdf:status>
   <xccdf:title xml:lang="en">CIS NGINX Benchmark</xccdf:title>
   <xccdf:description xml:lang="en">
      <xhtml:p>This document, CIS NGINX Benchmark, provides prescriptive guidance for establishing a secure configuration posture for NGINX version 1.14.0 running on Linux.</xhtml:p>
      <xhtml:p>This guide was tested against NGINX version 1.14.0 using the packages installed using yum from <xhtml:a href="https://nginx.org/">nginx.org</xhtml:a>. This Benchmark was written using commands for, and tested on, CentOS 7.6.  For other versions of Linux, please substitute the CentOS specific commands for the equivalent commands on the Linux distribution you are using.</xhtml:p>
      <xhtml:p>To obtain the latest version of this guide, please visit <xhtml:a href="http://benchmarks.cisecurity.org">http://benchmarks.cisecurity.org</xhtml:a>. If you have questions or comments, or have identified ways to improve this guide, please write us at <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>.</xhtml:p>
   </xccdf:description>
   <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
   <cpe:platform-specification xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check">
      <cpe:platform id="a_nginx_nginx_installed">
         <cpe:title xml:lang="en-US">Correct platform is installed on CISCAT Host</cpe:title>
         <cpe:logical-test negate="false" operator="AND">
            <check-fact-ref xmlns="http://cpe.mitre.org/language/2.0" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" id-ref="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:101" system="http://oval.mitre.org/XMLSchema/oval-definitions-5"/>
         </cpe:logical-test>
      </cpe:platform>
   </cpe:platform-specification>
   <xccdf:platform xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" idref="#a_nginx_nginx_installed"/>
   <xccdf:version>1.1.0</xccdf:version>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1_-_Webserver">
      <xccdf:title xml:lang="en">Level 1 - Webserver</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Items in this profile intend to:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>be practical and prudent;</xhtml:li>
            <xhtml:li>provide a clear security benefit; and</xhtml:li>
            <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1_Ensure_NGINX_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_package_manager_repositories_are_properly_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_the_latest_software_package_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.4_Ensure_the_autoindex_module_is_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_that_NGINX_is_run_using_a_non-privileged_dedicated_service_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_the_NGINX_service_account_is_locked" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.3_Ensure_the_NGINX_service_account_has_an_invalid_shell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_NGINX_directories_and_files_are_owned_by_root" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_access_to_NGINX_directories_and_files_is_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_the_NGINX_process_ID_PID_file_is_secured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.4_Ensure_the_core_dump_directory_is_secured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_NGINX_only_listens_for_network_connections_on_authorized_ports" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_requests_for_unknown_host_names_are_rejected" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_keepalive_timeout_is_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_send_timeout_is_set_to_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1_Ensure_server_tokens_directive_is_set_to_off" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Ensure_default_error_and_index.html_pages_do_not_reference_NGINX" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_detailed_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_access_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_error_logging_is_enabled_and_set_to_the_info_logging_level" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_log_files_are_rotated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_HTTP_is_redirected_to_HTTPS" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Ensure_a_trusted_certificate_and_trust_chain_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Ensure_private_key_permissions_are_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Ensure_only_modern_TLS_protocols_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Disable_weak_ciphers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_custom_Diffie-Hellman_parameters_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Ensure_Online_Certificate_Status_Protocol_OCSP_stapling_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Ensure_HTTP_Strict_Transport_Security_HSTS_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_only_whitelisted_HTTP_methods_are_allowed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_timeout_values_for_reading_the_client_header_and_body_are_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_the_maximum_request_body_size_is_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_the_maximum_buffer_size_for_URIs_is_defined" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_X-Frame-Options_header_is_configured_and_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.2_Ensure_X-Content-Type-Options_header_is_configured_and_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.3_Ensure_the_X-XSS-Protection_Header_is_enabled_and_configured_properly" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1_-_Proxy">
      <xccdf:title xml:lang="en">Level 1 - Proxy</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Items in this profile intend to:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>be practical and prudent;</xhtml:li>
            <xhtml:li>provide a clear security benefit; and</xhtml:li>
            <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1_Ensure_NGINX_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_package_manager_repositories_are_properly_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_the_latest_software_package_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_that_NGINX_is_run_using_a_non-privileged_dedicated_service_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_the_NGINX_service_account_is_locked" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.3_Ensure_the_NGINX_service_account_has_an_invalid_shell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_NGINX_directories_and_files_are_owned_by_root" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_access_to_NGINX_directories_and_files_is_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_the_NGINX_process_ID_PID_file_is_secured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_NGINX_only_listens_for_network_connections_on_authorized_ports" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_requests_for_unknown_host_names_are_rejected" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_keepalive_timeout_is_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_send_timeout_is_set_to_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Ensure_default_error_and_index.html_pages_do_not_reference_NGINX" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.4_Ensure_the_NGINX_reverse_proxy_does_not_enable_information_disclosure" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_detailed_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_access_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_error_logging_is_enabled_and_set_to_the_info_logging_level" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_log_files_are_rotated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_proxies_pass_source_IP_information" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_HTTP_is_redirected_to_HTTPS" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Ensure_a_trusted_certificate_and_trust_chain_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Ensure_private_key_permissions_are_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Ensure_only_modern_TLS_protocols_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Disable_weak_ciphers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_custom_Diffie-Hellman_parameters_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Ensure_Online_Certificate_Status_Protocol_OCSP_stapling_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Ensure_HTTP_Strict_Transport_Security_HSTS_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Ensure_upstream_server_traffic_is_authenticated_with_a_client_certificate" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_only_whitelisted_HTTP_methods_are_allowed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_timeout_values_for_reading_the_client_header_and_body_are_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_the_maximum_request_body_size_is_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_the_maximum_buffer_size_for_URIs_is_defined" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1_-_Loadbalancer">
      <xccdf:title xml:lang="en">Level 1 - Loadbalancer</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Items in this profile intend to:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>be practical and prudent;</xhtml:li>
            <xhtml:li>provide a clear security benefit; and</xhtml:li>
            <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1_Ensure_NGINX_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_package_manager_repositories_are_properly_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_the_latest_software_package_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_that_NGINX_is_run_using_a_non-privileged_dedicated_service_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_the_NGINX_service_account_is_locked" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.3_Ensure_the_NGINX_service_account_has_an_invalid_shell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_NGINX_directories_and_files_are_owned_by_root" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_access_to_NGINX_directories_and_files_is_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_the_NGINX_process_ID_PID_file_is_secured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_NGINX_only_listens_for_network_connections_on_authorized_ports" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_requests_for_unknown_host_names_are_rejected" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_keepalive_timeout_is_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_send_timeout_is_set_to_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Ensure_default_error_and_index.html_pages_do_not_reference_NGINX" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.4_Ensure_the_NGINX_reverse_proxy_does_not_enable_information_disclosure" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_detailed_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_access_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_error_logging_is_enabled_and_set_to_the_info_logging_level" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_log_files_are_rotated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_proxies_pass_source_IP_information" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_HTTP_is_redirected_to_HTTPS" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Ensure_a_trusted_certificate_and_trust_chain_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Ensure_private_key_permissions_are_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Ensure_only_modern_TLS_protocols_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Disable_weak_ciphers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_custom_Diffie-Hellman_parameters_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Ensure_Online_Certificate_Status_Protocol_OCSP_stapling_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Ensure_HTTP_Strict_Transport_Security_HSTS_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Ensure_upstream_server_traffic_is_authenticated_with_a_client_certificate" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_only_whitelisted_HTTP_methods_are_allowed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_timeout_values_for_reading_the_client_header_and_body_are_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_the_maximum_request_body_size_is_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_the_maximum_buffer_size_for_URIs_is_defined" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2_-_Webserver">
      <xccdf:title xml:lang="en">Level 2 - Webserver</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
            <xhtml:li>acts as defense in depth measure</xhtml:li>
            <xhtml:li>may negatively inhibit the utility or performance of the technology</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1_Ensure_NGINX_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.2_Ensure_NGINX_is_installed_from_source" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_package_manager_repositories_are_properly_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_the_latest_software_package_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_only_required_modules_are_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_HTTP_WebDAV_module_is_not_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.3_Ensure_modules_with_gzip_functionality_are_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.4_Ensure_the_autoindex_module_is_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_that_NGINX_is_run_using_a_non-privileged_dedicated_service_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_the_NGINX_service_account_is_locked" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.3_Ensure_the_NGINX_service_account_has_an_invalid_shell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_NGINX_directories_and_files_are_owned_by_root" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_access_to_NGINX_directories_and_files_is_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_the_NGINX_process_ID_PID_file_is_secured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.4_Ensure_the_core_dump_directory_is_secured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_NGINX_only_listens_for_network_connections_on_authorized_ports" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_requests_for_unknown_host_names_are_rejected" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_keepalive_timeout_is_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_send_timeout_is_set_to_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.1_Ensure_server_tokens_directive_is_set_to_off" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Ensure_default_error_and_index.html_pages_do_not_reference_NGINX" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.3_Ensure_hidden_file_serving_is_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_detailed_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_access_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_error_logging_is_enabled_and_set_to_the_info_logging_level" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_log_files_are_rotated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_error_logs_are_sent_to_a_remote_syslog_server" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_access_logs_are_sent_to_a_remote_syslog_server" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_HTTP_is_redirected_to_HTTPS" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Ensure_a_trusted_certificate_and_trust_chain_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Ensure_private_key_permissions_are_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Ensure_only_modern_TLS_protocols_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Disable_weak_ciphers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_custom_Diffie-Hellman_parameters_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Ensure_Online_Certificate_Status_Protocol_OCSP_stapling_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Ensure_HTTP_Strict_Transport_Security_HSTS_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.9_Ensure_HTTP_Public_Key_Pinning_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.12_Ensure_your_domain_is_preloaded" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.13_Ensure_session_resumption_is_disabled_to_enable_perfect_forward_security" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.14_Ensure_HTTP2.0_is_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_allow_and_deny_filters_limit_access_to_specific_IP_addresses" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_only_whitelisted_HTTP_methods_are_allowed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_timeout_values_for_reading_the_client_header_and_body_are_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_the_maximum_request_body_size_is_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_the_maximum_buffer_size_for_URIs_is_defined" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_the_number_of_connections_per_IP_address_is_limited" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_rate_limits_by_IP_address_are_set" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_X-Frame-Options_header_is_configured_and_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.2_Ensure_X-Content-Type-Options_header_is_configured_and_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.3_Ensure_the_X-XSS-Protection_Header_is_enabled_and_configured_properly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.4_Ensure_that_Content_Security_Policy_CSP_is_enabled_and_configured_properly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.5_Ensure_the_Referrer_Policy_is_enabled_and_configured_properly" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2_-_Proxy">
      <xccdf:title xml:lang="en">Level 2 - Proxy</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
            <xhtml:li>acts as defense in depth measure</xhtml:li>
            <xhtml:li>may negatively inhibit the utility or performance of the technology</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1_Ensure_NGINX_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.2_Ensure_NGINX_is_installed_from_source" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_package_manager_repositories_are_properly_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_the_latest_software_package_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_only_required_modules_are_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_HTTP_WebDAV_module_is_not_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.3_Ensure_modules_with_gzip_functionality_are_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_that_NGINX_is_run_using_a_non-privileged_dedicated_service_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_the_NGINX_service_account_is_locked" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.3_Ensure_the_NGINX_service_account_has_an_invalid_shell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_NGINX_directories_and_files_are_owned_by_root" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_access_to_NGINX_directories_and_files_is_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_the_NGINX_process_ID_PID_file_is_secured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_NGINX_only_listens_for_network_connections_on_authorized_ports" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_requests_for_unknown_host_names_are_rejected" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_keepalive_timeout_is_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_send_timeout_is_set_to_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Ensure_default_error_and_index.html_pages_do_not_reference_NGINX" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.4_Ensure_the_NGINX_reverse_proxy_does_not_enable_information_disclosure" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_detailed_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_access_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_error_logging_is_enabled_and_set_to_the_info_logging_level" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_log_files_are_rotated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_error_logs_are_sent_to_a_remote_syslog_server" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_access_logs_are_sent_to_a_remote_syslog_server" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_proxies_pass_source_IP_information" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_HTTP_is_redirected_to_HTTPS" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Ensure_a_trusted_certificate_and_trust_chain_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Ensure_private_key_permissions_are_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Ensure_only_modern_TLS_protocols_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Disable_weak_ciphers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_custom_Diffie-Hellman_parameters_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Ensure_Online_Certificate_Status_Protocol_OCSP_stapling_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Ensure_HTTP_Strict_Transport_Security_HSTS_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.9_Ensure_HTTP_Public_Key_Pinning_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Ensure_upstream_server_traffic_is_authenticated_with_a_client_certificate" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.11_Ensure_the_upstream_traffic_server_certificate_is_trusted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.12_Ensure_your_domain_is_preloaded" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.13_Ensure_session_resumption_is_disabled_to_enable_perfect_forward_security" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_allow_and_deny_filters_limit_access_to_specific_IP_addresses" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_only_whitelisted_HTTP_methods_are_allowed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_timeout_values_for_reading_the_client_header_and_body_are_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_the_maximum_request_body_size_is_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_the_maximum_buffer_size_for_URIs_is_defined" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_the_number_of_connections_per_IP_address_is_limited" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_rate_limits_by_IP_address_are_set" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2_-_Loadbalancer">
      <xccdf:title xml:lang="en">Level 2 - Loadbalancer</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
            <xhtml:li>acts as defense in depth measure</xhtml:li>
            <xhtml:li>may negatively inhibit the utility or performance of the technology</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1_Ensure_NGINX_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.2_Ensure_NGINX_is_installed_from_source" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_package_manager_repositories_are_properly_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_the_latest_software_package_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_only_required_modules_are_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_HTTP_WebDAV_module_is_not_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.3_Ensure_modules_with_gzip_functionality_are_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_that_NGINX_is_run_using_a_non-privileged_dedicated_service_account" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_the_NGINX_service_account_is_locked" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.3_Ensure_the_NGINX_service_account_has_an_invalid_shell" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_NGINX_directories_and_files_are_owned_by_root" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_access_to_NGINX_directories_and_files_is_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_the_NGINX_process_ID_PID_file_is_secured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_NGINX_only_listens_for_network_connections_on_authorized_ports" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_requests_for_unknown_host_names_are_rejected" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_keepalive_timeout_is_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_send_timeout_is_set_to_10_seconds_or_less_but_not_0" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Ensure_default_error_and_index.html_pages_do_not_reference_NGINX" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5.4_Ensure_the_NGINX_reverse_proxy_does_not_enable_information_disclosure" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_detailed_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_access_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_error_logging_is_enabled_and_set_to_the_info_logging_level" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_log_files_are_rotated" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_error_logs_are_sent_to_a_remote_syslog_server" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_access_logs_are_sent_to_a_remote_syslog_server" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_proxies_pass_source_IP_information" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_HTTP_is_redirected_to_HTTPS" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Ensure_a_trusted_certificate_and_trust_chain_is_installed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Ensure_private_key_permissions_are_restricted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Ensure_only_modern_TLS_protocols_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Disable_weak_ciphers" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_custom_Diffie-Hellman_parameters_are_used" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Ensure_Online_Certificate_Status_Protocol_OCSP_stapling_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Ensure_HTTP_Strict_Transport_Security_HSTS_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.9_Ensure_HTTP_Public_Key_Pinning_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Ensure_upstream_server_traffic_is_authenticated_with_a_client_certificate" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.11_Ensure_the_upstream_traffic_server_certificate_is_trusted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.12_Ensure_your_domain_is_preloaded" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.13_Ensure_session_resumption_is_disabled_to_enable_perfect_forward_security" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_allow_and_deny_filters_limit_access_to_specific_IP_addresses" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_only_whitelisted_HTTP_methods_are_allowed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_timeout_values_for_reading_the_client_header_and_body_are_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_the_maximum_request_body_size_is_set_correctly" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_the_maximum_buffer_size_for_URIs_is_defined" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_the_number_of_connections_per_IP_address_is_limited" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_rate_limits_by_IP_address_are_set" selected="true"/>
   </xccdf:Profile>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.1.2.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure HTTP WebDAV module is not installed</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure HTTP WebDAV module is not installed" -&gt; "Ensure HTTP WebDAV module is not installed</xccdf:description>
      <xccdf:value>^.*\s+\-\-with\-http_dav_module\s+.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.1.3.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure 'nginx -V' output Pattern Not Match 'http_gzip_' (string)</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure modules with gzip functionality are disabled" -&gt; "Ensure 'nginx -V' output Pattern Not Match 'http_gzip_' (string)</xccdf:description>
      <xccdf:value>http_gzip_</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.1.4.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure any file(s) named nginx.conf in /etc/nginx exists and matches pattern ^\s*(?i)autoindex\s+off;[a-z\s]*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the autoindex module is disabled" -&gt; "Ensure any file(s) named nginx.conf in /etc/nginx exists and matches pattern ^\s*(?i)autoindex\s+off;[a-z\s]*$</xccdf:description>
      <xccdf:value>^\s*(?i)autoindex\s+off;[a-z\s]*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.1.4.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure any file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)autoindex\s+off;[a-z\s]*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the autoindex module is disabled" -&gt; "Ensure any file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)autoindex\s+off;[a-z\s]*$</xccdf:description>
      <xccdf:value>^\s*(?i)autoindex\s+off;[a-z\s]*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.2.2.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/shadow exists and matches pattern ^nginx:(!:|!!:).*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the NGINX service account is locked" -&gt; "Ensure at least one file named /etc/shadow exists and matches pattern ^nginx:(!:|!!:).*$</xccdf:description>
      <xccdf:value>^nginx:(!:|!!:).*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.2.2.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/shadow exists and does not match pattern ^nginx:</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the NGINX service account is locked" -&gt; "Ensure at least one file named /etc/shadow exists and does not match pattern ^nginx:</xccdf:description>
      <xccdf:value>^nginx:</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.2.3.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/passwd exists and matches pattern ^.*nginx\:(\/sbin\/nologin|\/bin\/false)$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the NGINX service account has an invalid shell" -&gt; "Ensure at least one file named /etc/passwd exists and matches pattern ^.*nginx\:(\/sbin\/nologin|\/bin\/false)$</xccdf:description>
      <xccdf:value>^.*nginx\:(\/sbin\/nologin|\/bin\/false)$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.2.3.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/passwd exists and does not match pattern ^nginx\:.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the NGINX service account has an invalid shell" -&gt; "Ensure at least one file named /etc/passwd exists and does not match pattern ^nginx\:.*$</xccdf:description>
      <xccdf:value>^nginx\:.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.4.3.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure any files named ^(?i)\S+\.conf$ in /etc/nginx exists and matches pattern ^\s*keepalive_timeout\s+(10|[1-9])\;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure keepalive_timeout is 10 seconds or less, but not 0" -&gt; "Ensure any files named ^(?i)\S+\.conf$ in /etc/nginx exists and matches pattern ^\s*keepalive_timeout\s+(10|[1-9])\;.*$</xccdf:description>
      <xccdf:value>^\s*keepalive_timeout\s+(10|[1-9])\;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.4.3.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure any files named ^(?i)\S+\.conf$ in /etc/nginx/conf.d exists and matches pattern ^\s*keepalive_timeout\s+(10|[1-9])\;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure keepalive_timeout is 10 seconds or less, but not 0" -&gt; "Ensure any files named ^(?i)\S+\.conf$ in /etc/nginx/conf.d exists and matches pattern ^\s*keepalive_timeout\s+(10|[1-9])\;.*$</xccdf:description>
      <xccdf:value>^\s*keepalive_timeout\s+(10|[1-9])\;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.4.4.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure any file(s) named ^(?i)\S+\.conf$ in /etc/nginx exists and matches pattern ^\s*send_timeout\s+(10|[1-9])\;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure send_timeout is set to 10 seconds or less, but not 0" -&gt; "Ensure any file(s) named ^(?i)\S+\.conf$ in /etc/nginx exists and matches pattern ^\s*send_timeout\s+(10|[1-9])\;.*$</xccdf:description>
      <xccdf:value>^\s*send_timeout\s+(10|[1-9])\;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.4.4.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure any files named ^(?i)\S+\.conf$ in /etc/nginx/conf.d exists and matches pattern ^\s*send_timeout\s+(10|[1-9])\;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure send_timeout is set to 10 seconds or less, but not 0" -&gt; "Ensure any files named ^(?i)\S+\.conf$ in /etc/nginx/conf.d exists and matches pattern ^\s*send_timeout\s+(10|[1-9])\;.*$</xccdf:description>
      <xccdf:value>^\s*send_timeout\s+(10|[1-9])\;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.5.1.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^.*server_tokens.*off;$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure server_tokens directive is set to `off`" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^.*server_tokens.*off;$</xccdf:description>
      <xccdf:value>^.*server_tokens.*off;$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.5.2.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /usr/share/nginx/html/index.html exists and does not match pattern ((?i)(NGINX))</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure default error and index.html pages do not reference NGINX" -&gt; "Ensure at least one file named /usr/share/nginx/html/index.html exists and does not match pattern ((?i)(NGINX))</xccdf:description>
      <xccdf:value>((?i)(NGINX))</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.5.2.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named grep -i nginx /usr/share/nginx/html/50x.html exists and does not match pattern ((?i)(NGINX))</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure default error and index.html pages do not reference NGINX" -&gt; "Ensure at least one file named grep -i nginx /usr/share/nginx/html/50x.html exists and does not match pattern ((?i)(NGINX))</xccdf:description>
      <xccdf:value>((?i)(NGINX))</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.5.4.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*proxy_hide_header\s+(?i)x-powered-by;[a-z\s]*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the NGINX reverse proxy does not enable information disclosure" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*proxy_hide_header\s+(?i)x-powered-by;[a-z\s]*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_hide_header\s+x-powered-by;[a-z\s]*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_2.5.4.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*proxy_hide_header\s+(?i)server;[a-z\s]*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the NGINX reverse proxy does not enable information disclosure" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*proxy_hide_header\s+(?i)server;[a-z\s]*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_hide_header\s+server;[a-z\s]*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_3.2.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx exists and does not match pattern ^\s*(?i)access_log\s*off;[a-z\s]*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure access logging is enabled" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx exists and does not match pattern ^\s*(?i)access_log\s*off;[a-z\s]*$</xccdf:description>
      <xccdf:value>^\s*(?i)access_log\s*off;[a-z\s]*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_3.2.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and does not match pattern ^\s*(?i)access_log\s*off;[a-z\s]*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure access logging is enabled" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and does not match pattern ^\s*(?i)access_log\s*off;[a-z\s]*$</xccdf:description>
      <xccdf:value>^\s*(?i)access_log\s*off;[a-z\s]*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_3.3.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)error_log\s+\S+\s+info;[a-z\s]*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure error logging is enabled and set to the info logging level" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)error_log\s+\S+\s+info;[a-z\s]*$</xccdf:description>
      <xccdf:value>^\s*(?i)error_log\s+\S+\s+info;[a-z\s]*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_3.4.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/logrotate.d/nginx exists and matches pattern ^\s*weekly\s*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure log files are rotated" -&gt; "Ensure at least one file named /etc/logrotate.d/nginx exists and matches pattern ^\s*weekly\s*$</xccdf:description>
      <xccdf:value>^\s*weekly\s*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_3.4.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/logrotate.d/nginx exists and matches pattern ^\s*rotate\s+13\s*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure log files are rotated" -&gt; "Ensure at least one file named /etc/logrotate.d/nginx exists and matches pattern ^\s*rotate\s+13\s*$</xccdf:description>
      <xccdf:value>^\s*rotate\s+13\s*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.2.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*ssl_certificate_key\s+\/\S+;[a-z\s]*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure a trusted certificate and trust chain is installed" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*ssl_certificate_key\s+\/\S+;[a-z\s]*$</xccdf:description>
      <xccdf:value>^\s*ssl_certificate_key\s+\/\S+;[a-z\s]*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.4.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and does not match pattern \s*(?i)ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure only modern TLS protocols are used" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and does not match pattern \s*(?i)ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:description>
      <xccdf:value>^\s*(?i)ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.4.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and does not match pattern ^\s*(?i)proxy_ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure only modern TLS protocols are used" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and does not match pattern ^\s*(?i)proxy_ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.4.3_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and does not match pattern ^\s*(?i)ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure only modern TLS protocols are used" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and does not match pattern ^\s*(?i)ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:description>
      <xccdf:value>^\s*(?i)ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.4.4_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and does not match pattern ^\s*(?i)proxy_ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure only modern TLS protocols are used" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and does not match pattern ^\s*(?i)proxy_ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_ssl_protocols\s+(SSLv2(\s+|;)|SSLv3(\s+|;)|TLSv1(\s+|;)|TLSv1\.1(\s+|;)).*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.4.5_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)(ssl_protocols\s+|proxy_ssl_protocols\s+).*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure only modern TLS protocols are used" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)(ssl_protocols\s+|proxy_ssl_protocols\s+).*$</xccdf:description>
      <xccdf:value>^\s*(?i)(ssl_protocols\s+|proxy_ssl_protocols\s+).*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.4.6_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)(ssl_protocols\s+|proxy_ssl_protocols\s+).*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure only modern TLS protocols are used" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)(ssl_protocols\s+|proxy_ssl_protocols\s+).*$</xccdf:description>
      <xccdf:value>^\s*(?i)(ssl_protocols\s+|proxy_ssl_protocols\s+).*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.7.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)ssl_stapling\s+on;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure Online Certificate Status Protocol (OCSP) stapling is enabled" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)ssl_stapling\s+on;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)ssl_stapling\s+on;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.7.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)ssl_stapling_verify\s+on;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure Online Certificate Status Protocol (OCSP) stapling is enabled" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)ssl_stapling_verify\s+on;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)ssl_stapling_verify\s+on;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.7.3_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)ssl_stapling\s+on;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure Online Certificate Status Protocol (OCSP) stapling is enabled" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)ssl_stapling\s+on;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)ssl_stapling\s+on;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.7.4_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)ssl_stapling_verify\s+on;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure Online Certificate Status Protocol (OCSP) stapling is enabled" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)ssl_stapling_verify\s+on;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)ssl_stapling_verify\s+on;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.8.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)add_header\s+strict-transport-security\s+"max-age=(1576[89]\d{3}|157[7-9]\d{4}|15[89]\d{5}|1[6-9]\d{6}|[2-9]\d{7}|[1-9]\d{8,});.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure HTTP Strict Transport Security (HSTS) is enabled" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)add_header\s+strict-transport-security\s+"max-age=(1576[89]\d{3}|157[7-9]\d{4}|15[89]\d{5}|1[6-9]\d{6}|[2-9]\d{7}|[1-9]\d{8,});.*$</xccdf:description>
      <xccdf:value>^\s*(?i)add_header\s+strict-transport-security\s+"max-age=(1576[89]\d{3}|157[7-9]\d{4}|15[89]\d{5}|1[6-9]\d{6}|[2-9]\d{7}|[1-9]\d{8,});.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.8.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx exists and matches pattern ^\s*(?i)add_header\s+strict-transport-security\s+"max-age=(1576[89]\d{3}|157[7-9]\d{4}|15[89]\d{5}|1[6-9]\d{6}|[2-9]\d{7}|[1-9]\d{8,});.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure HTTP Strict Transport Security (HSTS) is enabled" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx exists and matches pattern ^\s*(?i)add_header\s+strict-transport-security\s+"max-age=(1576[89]\d{3}|157[7-9]\d{4}|15[89]\d{5}|1[6-9]\d{6}|[2-9]\d{7}|[1-9]\d{8,});.*$</xccdf:description>
      <xccdf:value>^\s*(?i)add_header\s+strict-transport-security\s+"max-age=(1576[89]\d{3}|157[7-9]\d{4}|15[89]\d{5}|1[6-9]\d{6}|[2-9]\d{7}|[1-9]\d{8,});.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.9.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*pin-sha256="\S+";.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure HTTP Public Key Pinning is enabled" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*pin-sha256="\S+";.*$</xccdf:description>
      <xccdf:value>^\s*pin-sha256="\S+";.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.9.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*pin-sha256="\S+";.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure HTTP Public Key Pinning is enabled" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*pin-sha256="\S+";.*$</xccdf:description>
      <xccdf:value>^\s*pin-sha256="\S+";.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.10.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named \etc\nginx\nginx.conf exists and matches pattern ^\s*(?i)proxy_ssl_certificate\s+\/\S+;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure upstream server traffic is authenticated with a client certificate" -&gt; "Ensure at least one file named \etc\nginx\nginx.conf exists and matches pattern ^\s*(?i)proxy_ssl_certificate\s+\/\S+;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_ssl_certificate\s+\/\S+;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.10.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named \etc\nginx\nginx.conf exists and matches pattern ^\s*(?i)proxy_ssl_certificate_key\s+\/\S+;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure upstream server traffic is authenticated with a client certificate" -&gt; "Ensure at least one file named \etc\nginx\nginx.conf exists and matches pattern ^\s*(?i)proxy_ssl_certificate_key\s+\/\S+;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_ssl_certificate_key\s+\/\S+;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.10.3_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)proxy_ssl_certificate\s+\/\S+;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure upstream server traffic is authenticated with a client certificate" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)proxy_ssl_certificate\s+\/\S+;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_ssl_certificate\s+\/\S+;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.10.4_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)proxy_ssl_certificate_key\s+\/\S+;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure upstream server traffic is authenticated with a client certificate" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)proxy_ssl_certificate_key\s+\/\S+;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_ssl_certificate_key\s+\/\S+;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.11.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)proxy_ssl_trusted_certificate\s+\/\S+;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the upstream traffic server certificate is trusted" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)proxy_ssl_trusted_certificate\s+\/\S+;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_ssl_trusted_certificate\s+\/\S+;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.11.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)proxy_ssl_verify\s+on;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the upstream traffic server certificate is trusted" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)proxy_ssl_verify\s+on;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_ssl_verify\s+on;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.11.3_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)proxy_ssl_trusted_certificate\s+\/\S+;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the upstream traffic server certificate is trusted" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)proxy_ssl_trusted_certificate\s+\/\S+;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_ssl_trusted_certificate\s+\/\S+;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.11.4_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)proxy_ssl_verify\s+on;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the upstream traffic server certificate is trusted" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)proxy_ssl_verify\s+on;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)proxy_ssl_verify\s+on;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.13.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)ssl_session_tickets\s+off;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure session resumption is disabled to enable perfect forward security" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)ssl_session_tickets\s+off;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)ssl_session_tickets\s+off;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.13.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)ssl_session_tickets\s+off;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure session resumption is disabled to enable perfect forward security" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)ssl_session_tickets\s+off;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)ssl_session_tickets\s+off;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.14.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named \etc\nginx\nginx.conf exists and matches pattern ^\s*(?i)listen\s+\d{1,5}\s+ssl\s+http2;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure HTTP/2.0 is used" -&gt; "Ensure at least one file named \etc\nginx\nginx.conf exists and matches pattern ^\s*(?i)listen\s+\d{1,5}\s+ssl\s+http2;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)listen\s+\d{1,5}\s+ssl\s+http2;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_4.1.14.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in \etc\nginx\conf.d exists and matches pattern ^\s*(?i)listen\s+\d{1,5}\s+ssl\s+http2;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure HTTP/2.0 is used" -&gt; "Ensure at least one file(s) named ^.*$ in \etc\nginx\conf.d exists and matches pattern ^\s*(?i)listen\s+\d{1,5}\s+ssl\s+http2;.*$</xccdf:description>
      <xccdf:value>^\s*(?i)listen\s+\d{1,5}\s+ssl\s+http2;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.2.1.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)client_body_timeout\s+(10|[1-9]);.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure timeout values for reading the client header and body are set correctly" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)client_body_timeout\s+(10|[1-9]);.*$</xccdf:description>
      <xccdf:value>^\s*(?i)client_body_timeout\s+(10|[1-9]);.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.2.1.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern \s*(?i)client_header_timeout\s+(10|[1-9]);.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure timeout values for reading the client header and body are set correctly" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern \s*(?i)client_header_timeout\s+(10|[1-9]);.*$</xccdf:description>
      <xccdf:value>\s*(?i)client_header_timeout\s+(10|[1-9]);.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.2.1.3_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)client_body_timeout\s+(10|[1-9]);.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure timeout values for reading the client header and body are set correctly" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)client_body_timeout\s+(10|[1-9]);.*$</xccdf:description>
      <xccdf:value>^\s*(?i)client_body_timeout\s+(10|[1-9]);.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.2.1.4_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern \s*(?i)client_header_timeout\s+(10|[1-9]);.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure timeout values for reading the client header and body are set correctly" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern \s*(?i)client_header_timeout\s+(10|[1-9]);.*$</xccdf:description>
      <xccdf:value>\s*(?i)client_header_timeout\s+(10|[1-9]);.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.2.2.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)client_max_body_size\s+(100|[1-9][0-9]|[1-9])k\b.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the maximum request body size is set correctly" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)client_max_body_size\s+(100|[1-9][0-9]|[1-9])k\b.*$</xccdf:description>
      <xccdf:value>^\s*(?i)client_max_body_size\s+(100|[1-9][0-9]|[1-9])k\b.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.2.2.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)client_max_body_size\s+(100|[1-9][0-9]|[1-9])k\b.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the maximum request body size is set correctly" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)client_max_body_size\s+(100|[1-9][0-9]|[1-9])k\b.*$</xccdf:description>
      <xccdf:value>^\s*(?i)client_max_body_size\s+(100|[1-9][0-9]|[1-9])k\b.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.2.3.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)large_client_header_buffers\s+\d{1,3}\s+\d{1,3}\S\b.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the maximum buffer size for URIs is defined" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)large_client_header_buffers\s+\d{1,3}\s+\d{1,3}\S\b.*$</xccdf:description>
      <xccdf:value>^\s*(?i)large_client_header_buffers\s+\d{1,3}\s+\d{1,3}\S\b.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.2.3.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)large_client_header_buffers\s+\d{1,3}\s+\d{1,3}\S\b.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the maximum buffer size for URIs is defined" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)large_client_header_buffers\s+\d{1,3}\s+\d{1,3}\S\b.*$</xccdf:description>
      <xccdf:value>^\s*(?i)large_client_header_buffers\s+\d{1,3}\s+\d{1,3}\S\b.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.3.1.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern \s*(?i)X-Frame-Options\s+\S+;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure X-Frame-Options header is configured and enabled" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern \s*(?i)X-Frame-Options\s+\S+;.*$</xccdf:description>
      <xccdf:value>\s*(?i)X-Frame-Options\s+\S+;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.3.1.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern \s*(?i)X-Frame-Options\s+\S+;.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure X-Frame-Options header is configured and enabled" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern \s*(?i)X-Frame-Options\s+\S+;.*$</xccdf:description>
      <xccdf:value>\s*(?i)X-Frame-Options\s+\S+;.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.3.2.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)add_header\s+X-Content-Type-Options\s+\"nosniff\";.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure X-Content-Type-Options header is configured and enabled" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)add_header\s+X-Content-Type-Options\s+\"nosniff\";.*$</xccdf:description>
      <xccdf:value>^\s*(?i)add_header\s+X-Content-Type-Options\s+\"nosniff\";.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.3.2.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)add_header\s+X-Content-Type-Options\s+\"nosniff\";.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure X-Content-Type-Options header is configured and enabled" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)add_header\s+X-Content-Type-Options\s+\"nosniff\";.*$</xccdf:description>
      <xccdf:value>^\s*(?i)add_header\s+X-Content-Type-Options\s+\"nosniff\";.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.3.3.1_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)add_header\s+X-Xss-Protection\s+\"1;\s+mode=block\";.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the X-XSS-Protection Header is enabled and configured properly" -&gt; "Ensure at least one file named /etc/nginx/nginx.conf exists and matches pattern ^\s*(?i)add_header\s+X-Xss-Protection\s+\"1;\s+mode=block\";.*$</xccdf:description>
      <xccdf:value>^\s*(?i)add_header\s+X-Xss-Protection\s+\"1;\s+mode=block\";.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Value id="xccdf_org.cisecurity.benchmarks_value_5.3.3.2_var" operator="pattern match" type="string">
      <xccdf:title>Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)add_header\s+X-Xss-Protection\s+\"1;\s+mode=block\";.*$</xccdf:title>
      <xccdf:description>This variable is used in Rule "Ensure the X-XSS-Protection Header is enabled and configured properly" -&gt; "Ensure at least one file(s) named ^.*$ in /etc/nginx/conf.d exists and matches pattern ^\s*(?i)add_header\s+X-Xss-Protection\s+\"1;\s+mode=block\";.*$</xccdf:description>
      <xccdf:value>^\s*(?i)add_header\s+X-Xss-Protection\s+\"1;\s+mode=block\";.*$</xccdf:value>
   </xccdf:Value>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Initial_Setup">
      <xccdf:title xml:lang="en">Initial Setup</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations for the installation and maintenance of an NGINX server.</xhtml:p>
      </xccdf:description>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.1_Installation">
         <xccdf:title xml:lang="en">Installation</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.1_Ensure_NGINX_is_installed" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure NGINX is installed</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The CIS NGINX Benchmark recommends using the NGINX binary provided by your vendor for most situations.</xhtml:p>
               <xhtml:p>As an alternative, packages from <xhtml:a href="https://nginx.org/">nginx.org</xhtml:a> are available for a variety of platforms, including Linux and FreeBSD.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The main benefits of using NGINX packages from your vendor are:</xhtml:p>
               <xhtml:ul>
                  <xhtml:li>Ease of installation</xhtml:li>
                  <xhtml:li>Dependency resolution</xhtml:li>
                  <xhtml:li>Increased effectiveness of maintenance and security patches</xhtml:li>
                  <xhtml:li>Q&amp;A procedures carried out by your vendor</xhtml:li>
               </xhtml:ul>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/install.html</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/linux_packages.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Configure repo:</xhtml:p>
                     <xhtml:p>Example:</xhtml:p>
                     <xhtml:code class="code_block">#Configure your repo<br/>cat &lt;&lt; EOF &gt; /etc/yum.repos.d/nginx.repo<br/>[nginx]<br/>name=nginx repo<br/>baseurl=http://nginx.org/packages/centos/7/\$basearch/<br/>gpgcheck=1<br/>enabled=1<br/>EOF
</xhtml:code>
                     <xhtml:p>Download signing key:</xhtml:p>
                     <xhtml:p>Example:</xhtml:p>
                     <xhtml:code class="code_block">#Download Signing Key From The Internet<br/>curl -O https://nginx.org/keys/nginx_signing.key<br/>#import signing key so you do not get an error installing nginx<br/>rpm --import nginx_signing.key
</xhtml:code>
                     <xhtml:p>Install NGNIX:</xhtml:p>
                     <xhtml:p>Example:</xhtml:p>
                     <xhtml:code class="code_block">yum install nginx -y
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26464100"/>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.2_Ensure_NGINX_is_installed_from_source" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure NGINX is installed from source</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Installing NGINX directly from source allows you to install NGINX without the use of a package manager.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Installing NGINX from source allows you to harden your instance of NGINX by minimizing modules. NGINX is unable to remove modules when installed using a package manager. By installing from source, you are able to minimize modules, however, some additional configuration will be required and updates will not be automated out of the box for you.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://docs.nginx.com/nginx/admin-guide/installing-nginx/installing-nginx-open-source/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Installation depends on the operating system platform. For a source build, consult the NGINX documentation <xhtml:a href="https://docs.nginx.com/nginx/admin-guide/installing-nginx/installing-nginx-open-source/">"Building nginx from Sources"</xhtml:a>.</xhtml:p>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>By installing NGINX from source, you will have to manually upgrade NGINX or automate upgrades yourself. The default values for NGINX may also vary from this guide using this method.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.2_Configure_Software_Updates">
         <xccdf:title xml:lang="en">Configure Software Updates</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_package_manager_repositories_are_properly_configured" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure package manager repositories are properly configured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Systems need to have package manager repositories properly configured to ensure they receive the latest patches and updates.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>Package update and installation commands are based on CentOS 7. If using a different Linux distribution, please substitute with the appropriate command(s).</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>If a system's package manager repositories are misconfigured, important patches may not be identified, or a rogue repository could introduce compromised software.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/linux_packages.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Configure your package manager repositories according to your vendor.</xhtml:p>
                     <xhtml:p>As an alternative, package manager repositories from <xhtml:a href="https://nginx.org/">nginx.org</xhtml:a> are available for a variety of Linux platforms.</xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_the_latest_software_package_is_installed" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure the latest software package is installed</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>As new security vulnerabilities are discovered, the corresponding fixes are implemented by your NGINX software package provider. Installing the latest software version ensures these fixes are available on your system.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>Package update and installation commands are based on CentOS 7. If using a different Linux distribution, please substitute with the appropriate command(s).</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Up-to-date software provides the best possible protection against exploitation of security vulnerabilities, such as the execution of malicious code.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/linux_packages.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>To install the latest NGINX package, run the following command:</xhtml:p>
                     <xhtml:code class="code_block">yum update nginx -y
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Basic_Configuration">
      <xccdf:title xml:lang="en">Basic Configuration</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1_Minimize_NGINX_Modules">
         <xccdf:title xml:lang="en">Minimize NGINX Modules</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Ensure_only_required_modules_are_installed" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure only required modules are installed</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>This NGINX installation comes with several modules out of the box. These modules are not all always needed. Installations of NGINX should be hardened to ensure only the necessary modules are installed.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>
                     <xhtml:strong>NOTE:</xhtml:strong> NGINX does not support the removal of modules using the yum method of installation. In order to remove modules from NGINX, you will need to compile it from source.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Minimizing features and functionality built into NGINX can help to reduce the number of vulnerabilities your server has, which reduces the likelihood of a successful compromise by attackers.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/configure.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Consult <xhtml:a href="https://nginx.org/en/docs/">the NGINX module documentation</xhtml:a> to determine which modules are needed for your specific installation.</xhtml:p>
                     <xhtml:p>Modules may be removed using the <xhtml:a href="http://nginx.org/en/docs/configure.html">configure command.</xhtml:a>
                     </xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.2_Ensure_HTTP_WebDAV_module_is_not_installed" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure HTTP WebDAV module is not installed</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The http_dav_module enables HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV) as defined by RFC 4918. This enables file-based operations on your web server, such as the ability to create, delete, change and move files on your server. Most modern architectures have replaced this functionality with cloud-based object storage, in which case the module should not be installed.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>NGINX does not support the removal of modules using the yum method of installation. In order to remove modules from NGINX, you will need to compile from source.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>WebDAV functionality opens up an unnecessary path for exploiting your web server. Through misconfigurations of WebDAV operations, an attacker may be able to access and manipulate files on the server.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/configure.html</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://tools.ietf.org/html/rfc4918</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>To remove the http_dav_module, recompile nginx from source without the --with-http_dav_module flag.</xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:47052000" value-id="xccdf_org.cisecurity.benchmarks_value_2.1.2.1_var"/>
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:47052000"/>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.3_Ensure_modules_with_gzip_functionality_are_disabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure modules with gzip functionality are disabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>gzip is used for compression. Compression functionality should be disabled to prevent certain types of attacks from being performed successfully.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>NGINX does not support the removal of modules using the yum method of installation. In order to remove modules from NGINX, you will need to compile from source.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Compression has been linked with the Breach attack and others. While the Breach attack has been mitigated with modern usages of the HTTP protocol, disabling the use of compression is considered a defense-in-depth strategy to mitigate other attacks.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/configure.html</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/configure.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In order to disable the http_gzip_module, nginx must be recompiled from source. This can be accomplished using the below command in the folder you used during your original compilation. This must be done without the --with-http_gzip_static_module configuration directive.</xhtml:p>
                     <xhtml:code class="code_block">./configure --without-http_gzip_module
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26465500" value-id="xccdf_org.cisecurity.benchmarks_value_2.1.3.1_var"/>
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26465500"/>
            </xccdf:check>
            
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.4_Ensure_the_autoindex_module_is_disabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure the autoindex module is disabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The autoindex module processes requests ending with the slash character. This feature enables directory listing, which could be useful in attacker reconnaissance, so it should be disabled.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Automated directory listings may reveal information helpful to an attacker, such as naming conventions and directory paths. Directory listings may also reveal files that were not intended to be revealed.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_autoindex_module.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Perform the following to disable the autoindex module:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Search the NGINX configuration files (nginx.conf and any included configuration files) to find autoindex directives.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:code class="code_block">  egrep -i '^\s*autoindex\s+' /etc/nginx/nginx.conf<br/>  egrep -i '^\s*autoindex\s+' /etc/nginx/conf.d/*
</xhtml:code>
                     <xhtml:ol start="2">
                        <xhtml:li>Set the value for all autoindex directives to off, or remove those directives.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26465600" value-id="xccdf_org.cisecurity.benchmarks_value_2.1.4.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26465600"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26465700" value-id="xccdf_org.cisecurity.benchmarks_value_2.1.4.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26465700"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.2_Account_Security">
         <xccdf:title xml:lang="en">Account Security</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_that_NGINX_is_run_using_a_non-privileged_dedicated_service_account" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure that NGINX is run using a non-privileged, dedicated service account</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The nginx user directive designates which user account nginx worker processes run under. Ensuring a non-privileged, dedicated service account is used is a defense in depth measure to limit what an attacker who compromises the account can do.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Running a web server under a non-privileged, dedicated service account helps mitigate the risk of lateral movement to other services or processes in the event the user account running the web services is compromised. The default user nobody is typically used for several processes, and if this is compromised, it could allow an attacker to have access to all processes running as that user.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/ngx_core_module.html#user</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Add a system account for the nginx user with a home directory of /var/cache/nginx and a shell of /sbin/nologin so it does not have the ability to log in, then add the nginx user to be used by nginx:</xhtml:p>
                     <xhtml:code class="code_block">user add nginx -r -g nginx -d /var/cache/nginx -s /sbin/nologin
</xhtml:code>
                     <xhtml:p>Then add the nginx user to /etc/nginx/nginx.conf by adding the user directive as shown below:</xhtml:p>
                     <xhtml:code class="code_block">user nginx;
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_the_NGINX_service_account_is_locked" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure the NGINX service account is locked</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The nginx user account should have a valid password, but the account should be locked.</xhtml:p>
               <xhtml:p>NOTE: If a different account is used to run nginx, that account's name should be substituted for nginx in the audit and remediation procedures.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>As a defense-in-depth measure, the nginx user account should be locked to prevent logins and to prevent someone from switching users to nginx using the password. In general, there shouldn't be a need for anyone to have to su as nginx, and when there is a need, sudo should be used instead, which would not require the nginx account password.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Use the <xhtml:span class="inline_block">passwd</xhtml:span> command to lock the nginx service account:</xhtml:p>
                     <xhtml:code class="code_block">passwd -l nginx
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>This ensures the nginx user account may not be used by a human user.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26465000" value-id="xccdf_org.cisecurity.benchmarks_value_2.2.2.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26465000"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26465100" value-id="xccdf_org.cisecurity.benchmarks_value_2.2.2.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26465100"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.3_Ensure_the_NGINX_service_account_has_an_invalid_shell" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure the NGINX service account has an invalid shell</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The nginx account should not have the ability to log in, so the /sbin/nologin shell should be set for the account.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The account used for nginx should only be used for the nginx service and does not need to have the ability to log in. This prevents an attacker who compromises the account to log in with it.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Change the login shell for the nginx account to /sbin/nologin by using the following command:</xhtml:p>
                     <xhtml:code class="code_block">chsh -s /sbin/nologin nginx
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26465200" value-id="xccdf_org.cisecurity.benchmarks_value_2.2.3.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26465200"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26465300" value-id="xccdf_org.cisecurity.benchmarks_value_2.2.3.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26465300"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.3_Permissions_and_Ownership">
         <xccdf:title xml:lang="en">Permissions and Ownership</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.1_Ensure_NGINX_directories_and_files_are_owned_by_root" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure NGINX directories and files are owned by root</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The owner and group of the /etc/nginx directory and its files should be root.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Setting ownership to only those users in the root group and the root user will reduce the likelihood of unauthorized modifications to the nginx configuration files.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command to ensure ownership and group ownership is set to root:</xhtml:p>
                     <xhtml:code class="code_block">chown -R root:root /etc/nginx
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26464200"/>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.2_Ensure_access_to_NGINX_directories_and_files_is_restricted" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure access to NGINX directories and files is restricted</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Permissions on the /etc/nginx directory should enforce the principle of least privilege.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>Note: You should always check your private key permissions after implementing this recommendation. This recommendation assumes the private key has not yet been created or is not in the /etc/nginx directory.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>This ensures that only users who need access to configuration files are able to view them, thus preventing unauthorized access. Other users will need to use sudo in order to access these files.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
            <xccdf:ident system="http://cce.mitre.org">https://dev-sec.io/baselines/nginx/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>To set permissions to least privilege on the nginx configuration files, issue these commands:</xhtml:p>
                     <xhtml:code class="code_block">find /etc/nginx -type d | xargs chmod 750<br/>find /etc/nginx -type f | xargs chmod 640
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26464300"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26464400"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.3_Ensure_the_NGINX_process_ID_PID_file_is_secured" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure the NGINX process ID (PID) file is secured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The PID file stores the main process ID of the nginx process. This file should be protected from unauthorized modification.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The PID file should be owned by root and the group root. It should also be readable to everyone, but only writable by root (permissions 644). This will prevent unauthorized modification of the PID file, which could cause a denial of service.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>If the PID file is not owned by root, issue this command:</xhtml:p>
                     <xhtml:code class="code_block">chown root:root /var/run/nginx.pid
</xhtml:code>
                     <xhtml:p>If the PID file has permissions greater than 644, issue this command:</xhtml:p>
                     <xhtml:code class="code_block">chown 644 /var/run/nginx.pid
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26464500"/>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3.4_Ensure_the_core_dump_directory_is_secured" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure the core dump directory is secured</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Core dumps are snapshots of memory. The <xhtml:span class="inline_block">working_directory</xhtml:span> directive is used to specify the directory NGINX attempts to create core dumps in. Core dumps will be disabled if the directory is not writable by the NGINX user. It is recommended that the <xhtml:span class="inline_block">working_directory</xhtml:span> directive be set to a directory that is owned by the root user and the group the NGINX process executes as, and is inaccessible to other users. Usually, production systems should not have this enabled.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Core dumps may contain sensitive information that should not be accessible by other accounts on the system.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.nginx.com/resources/wiki/start/topics/tutorials/debugging/#core-dump</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Either remove the <xhtml:span class="inline_block">working_directory</xhtml:span> directive from the NGINX configuration files or ensure that the configured directory meets the following requirements:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>It is not within the NGINX web document root.</xhtml:li>
                        <xhtml:li>It is owned by root and has a group ownership of the NGINX group:</xhtml:li>
                     </xhtml:ol>
                     <xhtml:code class="code_block">chown root:nginx /var/log/nginx   
</xhtml:code>
                     <xhtml:ol start="3">
                        <xhtml:li>It has no read-write-search access permission for other users:</xhtml:li>
                     </xhtml:ol>
                     <xhtml:code class="code_block">chmod o-rwx /var/log/nginx   
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.4_Network_Configuration">
         <xccdf:title xml:lang="en">Network Configuration</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.1_Ensure_NGINX_only_listens_for_network_connections_on_authorized_ports" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure NGINX only listens for network connections on authorized ports</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>NGINX can be configured to listen on any port, but it should be configured to listen on authorized ports only.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Limiting the listening ports to only those that are authorized helps to ensure no unauthorized services are running through the use of nginx.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>If any ports are listening that are not authorized, comment out or delete the associated configuration for that listener.</xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.2_Ensure_requests_for_unknown_host_names_are_rejected" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure requests for unknown host names are rejected</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Your host header should be part of a predefined whitelist of known good hosts, which enables blocking access to other hosts. You should treat the host header as another input to be validated, as it is defined by the user agent.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Whitelisting specific hosts and blocking access to all other hosts, you help to mitigate host header injection attacks against your server. Such attacks could be used by an attacker to redirect you to a rogue host and execute scripts or get you to input credentials.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.acunetix.com/blog/articles/automated-detection-of-host-header-attacks/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://hackerone.com/reports/94637</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://stackoverflow.com/questions/9824328/why-is-nginx-responding-to-any-domain-name</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Ensure your first server block mirrors the below in your nginx configuration, either at /etc/nginx/nginx.conf or any included file within your nginx config:</xhtml:p>
                     <xhtml:code class="code_block">server {<br/>    return 404;<br/>}
</xhtml:code>
                     <xhtml:p>Then investigate each server block to ensure the server_name directive is explicitly defined. Each server block should look similar to the below with the defined hostname of the associated server block in the server_name directive. For example, if your server is cisecurity.org, the configuration should look like the below example:</xhtml:p>
                     <xhtml:code class="code_block">server {<br/>    listen       443;<br/>    server_name  cisecurity.org;<br/>    .....<br/>}
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If you are in an environment such as the cloud, you should not put an IP address or default hostname as your server_name because these addresses are often ephemeral in nature. Additionally, you will be blocked from accessing your site if you use a means of access that does not directly reference names in the server_name directive. You should reserve a DNS name to use for implementing this recommendation.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.3_Ensure_keepalive_timeout_is_10_seconds_or_less_but_not_0" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure keepalive_timeout is 10 seconds or less, but not 0</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Persistent connections are leveraged by all modern browsers to facilitate greater web performance. The keep-alive timeout limits the time a persistent connection may remain open. Setting the keep-alive timeout allows this timeout to be controlled on the server side.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Setting a keep-alive timeout on the server side helps mitigate denial of service attacks that establish too many persistent connections, exhausting server resources.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_core_module.html#keepalive_timeout</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Find the HTTP or server block of your nginx configuration, and add the keepalive_timeout directive. Set it to 10 seconds or less, but not 0. This example command sets it to 10 seconds:</xhtml:p>
                     <xhtml:code class="code_block">keepalive_timeout 10;
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26464600" value-id="xccdf_org.cisecurity.benchmarks_value_2.4.3.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26464600"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26464700" value-id="xccdf_org.cisecurity.benchmarks_value_2.4.3.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26464700"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4.4_Ensure_send_timeout_is_set_to_10_seconds_or_less_but_not_0" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure send_timeout is set to 10 seconds or less, but not 0</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The send_timeout directive sets a timeout for transmitting a response to the client between two successive write operations.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Setting the send_timeout directive on the server side helps mitigate slow HTTP denial of service attacks by ensuring write operations taking up large amounts of time are closed.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident system="http://cce.mitre.org">https://www.owasp.org/index.php/SCG_WS_nginx</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_core_module.html#send_timeout</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Find the HTTP or server block of your nginx configuration, and add the send_timeout directive. Set it to 10 seconds or less, but not 0.</xhtml:p>
                     <xhtml:code class="code_block">send_timeout   10;
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26464800" value-id="xccdf_org.cisecurity.benchmarks_value_2.4.4.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26464800"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26464900" value-id="xccdf_org.cisecurity.benchmarks_value_2.4.4.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26464900"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.5_Information_Disclosure">
         <xccdf:title xml:lang="en">Information Disclosure</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.1_Ensure_server_tokens_directive_is_set_to_off" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure server_tokens directive is set to `off`</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The <xhtml:span class="inline_block">server_tokens</xhtml:span> directive is responsible for displaying the NGINX version number and operating system version on error pages and in the <xhtml:span class="inline_block">Server</xhtml:span> HTTP response header field. This information should not be displayed.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Attackers can conduct reconnaissance on a website using these response headers, then target attacks for specific known vulnerabilities associated with the underlying technologies. Hiding the version will slow down and deter some potential attackers.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>To disable the <xhtml:span class="inline_block">server_tokens</xhtml:span> directive, set it to <xhtml:span class="inline_block">off</xhtml:span> inside a server block in your nginx.conf:</xhtml:p>
                     <xhtml:code class="code_block">server {<br/>    ...<br/>    server_tokens        off;<br/>    ...<br/>}
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26465800" value-id="xccdf_org.cisecurity.benchmarks_value_2.5.1.1_var"/>
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26465800"/>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.2_Ensure_default_error_and_index.html_pages_do_not_reference_NGINX" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure default error and index.html pages do not reference NGINX</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The default error and index.html pages for NGINX reveal that the server is NGINX. These default pages should be removed or modified so they do not advertise the underlying infrastructure of the server.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>By gathering information about the server, attackers can target attacks against its known vulnerabilities. Removing pages that disclose the server runs NGINX helps reduce targeted attacks on the server.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Edit <xhtml:span class="inline_block">/usr/share/nginx/html/index.html</xhtml:span> and <xhtml:span class="inline_block">usr/share/nginx/html/50x.html</xhtml:span> and remove any lines that reference <xhtml:span class="inline_block">NGINX</xhtml:span>.</xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26465900" value-id="xccdf_org.cisecurity.benchmarks_value_2.5.2.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26465900"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26466000" value-id="xccdf_org.cisecurity.benchmarks_value_2.5.2.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26466000"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.3_Ensure_hidden_file_serving_is_disabled" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure hidden file serving is disabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Disabling hidden files is a defense-in-depth mechanism to help prevent accidentally exposing sensitive information.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Disabling hidden files prevents an attacker from being able to reference a hidden file that may be put in your location and have sensitive information, like .git files.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://programming-review.com/nginx-disable-access-to-htaccess-file/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Edit the <xhtml:span class="inline_block">nginx.conf</xhtml:span> file and add the following line:</xhtml:p>
                     <xhtml:code class="code_block">location ~ /\.  { deny all; return 404; }
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>This may break well-known hidden files that are needed for functionality. For example, it may prevent functionality used by LetsEncrypt. To enable, configure a location exception like that shown below:</xhtml:p>
                        <xhtml:code class="code_block">location ~ /\.well-known\/acme-challenge {<br/>    allow all;<br/>}
</xhtml:code>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5.4_Ensure_the_NGINX_reverse_proxy_does_not_enable_information_disclosure" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure the NGINX reverse proxy does not enable information disclosure</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The server and x-powered-by header may specify the underlying technology used by an application. The NGINX reverse proxy may pass these headers if not explicitly directed to remove them.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Attackers can conduct reconnaissance on a website using these response headers, then target attacks for specific known vulnerabilities associated with the underlying technologies. Removing these headers will reduce the likelihood of targeted attacks.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_proxy_module.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Implement the below directives as part of your location block. Edit <xhtml:span class="inline_block">/etc/nginx/nginx.conf</xhtml:span> and add the following:</xhtml:p>
                     <xhtml:code class="code_block">location /docs {<br/>....<br/>proxy_hide_header X-Powered-By;<br/>proxy_hide_header Server;<br/>....<br/>}
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26466100" value-id="xccdf_org.cisecurity.benchmarks_value_2.5.4.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26466100"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26466200" value-id="xccdf_org.cisecurity.benchmarks_value_2.5.4.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26466200"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Logging">
      <xccdf:title xml:lang="en">Logging</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1_Ensure_detailed_logging_is_enabled" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Ensure detailed logging is enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>System logging should be configured to meet your organizational security and privacy policies. Enabling detailed logging to include information about events, event sources, timestamps, and users may assist in incident response activities.</xhtml:p>
            <xhtml:p>NOTE: Aim to keep sensitive information out of logs. For example, keep sensitive information out of query strings and URIs to avoid this.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <notes:notes xml:lang="en">
               <xhtml:p>
                  <xhtml:strong>Note:</xhtml:strong> Load balancers are not source IP transparent. We must configure the X-Forwarded-For Header on the proxy and in the logs to show where the request is coming from.</xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Performing detailed logging ensures that incident responders, auditors, and others are able to clearly view the activity that has occurred on your server.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_log_module.html#log_format</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Edit the log format directive in /etc/nginx/nginx.conf so it logs everything needed to meet your organizational policies.</xhtml:p>
                  <xhtml:p>The following variables may be considered as useful examples include in your log_format with descriptive logging. You should consult the NGINX documentation and your organizational policy to ensure you are logging sufficient information and removing sensitive information where needed.</xhtml:p>
                  <xhtml:code class="code_block">$remote_addr - client address<br/>$remote_user - the user if basic authentication is used<br/>$status - the HTTP response status<br/>$content_type - Content-Type request header field<br/>$time_local - local time in the Common Log Format<br/>$request_method - request method, usually GET or POST<br/>$request - full original request line<br/>$uri - normalized URI in request<br/>$server_port - port of the server which accepted a request<br/>$server_name - name of the server which accepted a request<br/>$http_user_agent - user agent of the client requesting access<br/>$http_x_forwarded_for - client address a proxy or load balancer is forwarding traffic for
</xhtml:code>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_Ensure_access_logging_is_enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure access logging is enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The access_log directive should be on for every core site. It is enabled by default.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Access logging allows incident responders and auditors to investigate access to a system in the event of an incident.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_log_module.html#log_format</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Ensure the access_log directive is configured for every core site your organization requires logging for.</xhtml:p>
                  <xhtml:p>This should look similar to the below configuration snippet. You may use different log file locations based on your needs.</xhtml:p>
                  <xhtml:code class="code_block">access_log  /var/log/nginx/host.access.log  main;
</xhtml:code>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26463700" value-id="xccdf_org.cisecurity.benchmarks_value_3.2.1_var"/>
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26463700"/>
            </xccdf:check>
            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26463800" value-id="xccdf_org.cisecurity.benchmarks_value_3.2.2_var"/>
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26463800"/>
            </xccdf:check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_Ensure_error_logging_is_enabled_and_set_to_the_info_logging_level" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure error logging is enabled and set to the info logging level</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>All errors for applications should be logged.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Error logging can be useful in identifying an attacker attempting to exploit a system and recreating an attacker's steps. Error logging also helps with identifying possible issues with an application.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Edit /etc/nginx/nginx.conf so the error_log directive is present and not commented out. The error_log should be configured to the logging location of your choice. The configuration should look similar to the below:</xhtml:p>
                  <xhtml:code class="code_block">error_log  /var/log/nginx/error.log info;
</xhtml:code>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26463600" value-id="xccdf_org.cisecurity.benchmarks_value_3.3.1_var"/>
            <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26463600"/>
         </xccdf:check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4_Ensure_log_files_are_rotated" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure log files are rotated</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Log rotation ensures log files do not consume excessive disk space, potentially causing a denial of service.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <notes:notes xml:lang="en">
               <xhtml:p>You should always comply with your organizational log retention policy.</xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Log files are important to track activity that occurs on your server, but they take up significant amounts of space. Log rotation should be configured in order to ensure the logs do not consume so much disk space that logging becomes unavailable.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v6.1"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Follow the below procedure to change the default configuration to the recommended log rotation configuration. You may need to manually edit or change the below command if the configuration is not the default.</xhtml:p>
                  <xhtml:p>To change log compression from daily to weekly:</xhtml:p>
                  <xhtml:code class="code_block">sed -i "s/daily/weekly/" /etc/logrotate.d/nginx
</xhtml:code>
                  <xhtml:p>To change log rotation from every year to every 13 weeks:</xhtml:p>
                  <xhtml:code class="code_block">sed -i "s/rotate 52/rotate 13/" /etc/logrotate.d/nginx
</xhtml:code>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26463900" value-id="xccdf_org.cisecurity.benchmarks_value_3.4.1_var"/>
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26463900"/>
            </xccdf:check>
            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26464000" value-id="xccdf_org.cisecurity.benchmarks_value_3.4.2_var"/>
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26464000"/>
            </xccdf:check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5_Ensure_error_logs_are_sent_to_a_remote_syslog_server" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Ensure error logs are sent to a remote syslog server</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Centralized log management helps ensure logs are forensically sound and are available at a central location for auditing and incident investigation.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>A centralized logging solution aggregates logs from multiple systems to ensure logs can be referenced in the event systems are thought to be compromised. Centralized log servers are also often used to correlate logs for potential patterns of attack. If a centralized logging solution is not used and systems (and their logs) are believed to be compromised, then logs may not be permitted to be used as evidence.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/syslog.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To enable central logging for your error logs, add the below line to your server block in your server configuration file. 192.168.2.1 should be replaced with the location of your central log server.</xhtml:p>
                  <xhtml:code class="code_block">error_log syslog:server=192.168.2.1 info;
</xhtml:code>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6_Ensure_access_logs_are_sent_to_a_remote_syslog_server" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">Ensure access logs are sent to a remote syslog server</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Centralized log management helps ensure logs are forensically sound and are available at a central location for auditing and incident investigation.</xhtml:p>
         </xccdf:description>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>A centralized logging solution aggregates logs from multiple systems to ensure logs can be referenced in the event systems are thought to be compromised. Centralized log servers are also often used to correlate logs for potential patterns of attack. If a centralized logging solution is not used and systems (and their logs) are believed to be compromised, then logs may not be permitted to be used as evidence.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/syslog.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To enable central logging for your access logs, add the below line to your server block in your server configuration file. 192.168.2.1 should be replaced with the location of your central log server. The local logging facility may be changed to any unconfigured facility on your server.</xhtml:p>
                  <xhtml:code class="code_block">access_log syslog:server=192.168.2.1,facility=local7,tag=nginx,severity=info combined;
</xhtml:code>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7_Ensure_proxies_pass_source_IP_information" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">Ensure proxies pass source IP information</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The x-forwarded-for and remote address headers help identify and separate the originating client IP address of the user agent and the proxy IP address. The two types of addresses are the same, and one should always be present.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <notes:notes xml:lang="en">
               <xhtml:p>Users' privacy should be kept in mind when deploying this header. If it is deployed, you should ensure your privacy policy includes that you collect IP address information about your users.</xhtml:p>
            </notes:notes>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Being able to identify the originating client IP address can help auditors or incident responders identify where the corresponding user came from. This may be useful in the event of an attack to analyze if the IP address is a good candidate for blocking. It may also be useful to correlate an attacker's actions.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v6.1"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="http://cce.mitre.org">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For</xccdf:ident>
         <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_proxy_module.html</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To ensure your proxy or load balancer will forward information about the client and the proxy to the application, you must set the below headers in your location block. Edit your location block so it shows the proxy_set_header directives for the client and the proxy as shown below. These headers are the exact same and there is no need to have both present.</xhtml:p>
                  <xhtml:code class="code_block">server {<br/>    ...<br/> location / {<br/>     proxy_pass (Insert Application URL here);<br/>     proxy_set_header X-Real-IP $remote_addr;<br/>     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;<br/>    }<br/>}
</xhtml:code>
                  <xhtml:p> </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Encryption">
      <xccdf:title xml:lang="en">Encryption</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.1_TLS__SSL_Configuration">
         <xccdf:title xml:lang="en">TLS / SSL Configuration</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_HTTP_is_redirected_to_HTTPS" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure HTTP is redirected to HTTPS</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Browsers and clients establish encrypted connections with servers by leveraging HTTPS. Requests leveraging HTTP are unencrypted. Unencrypted requests should be redirected so they are encrypted. Any listening HTTP port on your web server should redirect to a server profile that uses encryption. The default HTTP (unencrypted) port is 80.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Redirecting user agent traffic to HTTPS helps to ensure all user traffic is encrypted. Modern browsers alert users that your website is insecure when HTTPS is not used. This can decrease user trust in your website and ultimately result in decreased use of your web services. Redirection from HTTP to HTTPS couples security with usability; users are able to access your website even if they lack the security awareness to use HTTPS over HTTP when requesting your website.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://serversforhackers.com/c/redirect-http-to-https-nginx</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Edit your web server or proxy configuration file to redirect all unencrypted listening ports, such as port 80, using a redirection through the return directive (cisecurity.org is used as an example server name).</xhtml:p>
                     <xhtml:code class="code_block">server {<br/>    listen 80;<br/>
                        <br/>    server_name cisecurity.org;<br/>
                        <br/>    return 301 https://$host$request_uri;<br/>}
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Use of HTTPS does result in a performance reduction in traffic to your website, however, due to the increased value of the security, many businesses consider this to be a cost of doing business.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Ensure_a_trusted_certificate_and_trust_chain_is_installed" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure a trusted certificate and trust chain is installed</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Certificates and their trust chains are needed to establish the identity of a web server as legitimate and trusted. Certificate authorities validate a web server's identity and that you are the owner of that web server domain name.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Without a certificate and full trust chain installed on your web server, modern browsers will flag your web server as untrusted.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/configuring_https_servers.html#chains</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.digicert.com/csr-ssl-installation/nginx-openssl.htm</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://support.globalsign.com/customer/portal/articles/1290470-install-certificate---nginx</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Use the following procedure to install a certificate and its signing certificate chain onto your web server, load balancer, or proxy.</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Step 1:</xhtml:strong> Create the server's private key and a certificate signing request.</xhtml:p>
                     <xhtml:p>The following command will create your certificate's private key with 2048-bit key strength. Optionally, this parameter may be changed to 4096 for greater security. It will also output your certificate signing request to the nginx.csr file in your present working directory.</xhtml:p>
                     <xhtml:code class="code_block">openssl req -new -newkey rsa:2048 -keyout nginx.key -out nginx.csr
</xhtml:code>
                     <xhtml:p>Enter the below information about your private key:</xhtml:p>
                     <xhtml:code class="code_block">Country Name (2 letter code) [XX]: Your Country<br/>State or Province Name (full name) []: Your State<br/>Locality Name (eg, city) [Default City]: Your City<br/>Organization Name (eg, company) [Default Company Ltd]: Your City<br/>Organizational Unit Name (eg, section) []: Your Organizational Unit<br/>Common Name (eg, your name or your server's hostname) []: Your server's DNS name<br/>Email Address []: Your email address
</xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>Step 2:</xhtml:strong> Obtain a signed certificate from your certificate authority.</xhtml:p>
                     <xhtml:p>Provide your chosen certificate authority with your certificate signing request. Follow your certificate authority's signing procedures in order to obtain a certificate and the certificate's trust chain. A full trust chain is typically delivered in .pem format.</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Step 3:</xhtml:strong> Install certificate and signing certificate chain on your web server.</xhtml:p>
                     <xhtml:p>Place the .pem file from your certificate authority into the directory of your choice. Locate your created key file from the command you used to generate your certificate signing request. Open your website configuration file and edit your encrypted listener to leverage the ssl_certificate and ssl_certificate_key directives for a web server as shown below. You should also inspect include files inside your nginx.conf. This should be part of the server block.</xhtml:p>
                     <xhtml:code class="code_block">server {<br/>    listen 443 ssl http2;<br/>    listen [::]:443 ssl http2;<br/>    ssl_certificate /etc/nginx/cert.crt;<br/>    ssl_certificate_key /etc/nginx/nginx.key;<br/>    ...<br/>    }
</xhtml:code>
                     <xhtml:p>After editing this file, you must recycle nginx services for these changes to take effect. This can be done with the following command:</xhtml:p>
                     <xhtml:code class="code_block">sudo service nginx restart
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26467000" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.2.1_var"/>
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26467000"/>
            </xccdf:check>
            
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Ensure_private_key_permissions_are_restricted" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure private key permissions are restricted</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The server's private key should be protected from unauthorized access by limiting access based on the principle of least privilege.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>
                     <xhtml:strong>Important Note:</xhtml:strong> This recommendation should be applied to both the keys of your server certificate and the key of your client certificate if you are looking to mutually authenticate a proxy server.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>A server's private key file should be restricted to 400 permissions. This ensures only the owner of the private key file can access it. This is the minimum necessary permissions for the server to operate. If the private key file is not protected, an unauthorized user with access to the server may be able to find the private key file and use it to decrypt traffic sent to your server.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following command on your key file to ensure its permissions are set to 400. The file name /etc/nginx/nginx.key should be replaced with the location of your key file.</xhtml:p>
                     <xhtml:code class="code_block">sudo chmod 400 /etc/nginx/nginx.key
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26467100"/>
            </xccdf:check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Ensure_only_modern_TLS_protocols_are_used" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure only modern TLS protocols are used</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Only modern TLS protocols should be enabled in NGINX for all client connections and upstream connections. Removing legacy TLS and SSL protocols (SSL 3.0, TLS 1.0 and 1.1), and enabling emerging and stable TLS protocols (TLS 1.2), ensures users are able to take advantage of strong security capabilities and protects them from insecure legacy protocols.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>Note: TLS configuration should always be set to your organizational policy. This recommendation is designed to meet best practices.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>
                  <xhtml:strong>Why disable SSL 3.0:</xhtml:strong>
The <xhtml:a href="https://nvd.nist.gov/vuln/detail/CVE-2014-3566">POODLE Vulnerability</xhtml:a> allowed attackers to exploit SSL 3.0 to obtain cleartext information by exploiting weaknesses in CBC in 2014. SSL 3.0 is also no longer FIPS 140-2 compliant.</xhtml:p>
               <xhtml:p>
                  <xhtml:strong>Why disable TLS 1.0:</xhtml:strong>
TLS 1.0 was deprecated from use when PCI DSS Compliance mandated that it not be used for any applications processing credit card numbers in June 2018. TLS 1.0 does not make use of modern protections, and almost all user agents that do not support TLS 1.2 or higher are no longer supported by their vendor.</xhtml:p>
               <xhtml:p>
                  <xhtml:strong>Why disable TLS 1.1:</xhtml:strong>
Because of the increased security associated with higher versions of TLS, TLS 1.0 should be disabled. Modern browsers will begin to flag TLS 1.1 as deprecated in early 2019.</xhtml:p>
               <xhtml:p>
                  <xhtml:strong>Why enable TLS 1.2:</xhtml:strong>
TLS 1.2 takes advantage of several security features including modern cipher suites, perfect forward security, and authenticated encryption.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://webkit.org/blog/8462/deprecation-of-legacy-tls-1-0-and-1-1-versions/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.cloudflare.com/learning-resources/tls-1-3/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Run the following commands to change your ssl_protocols if they are already configured. This remediation advice assumes your nginx configuration file does not include server configuration outside of /etc/nginx/nginx.conf. You may have to also inspect the include files in your nginx.conf to ensure this is properly implemented.</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Web Server:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/ssl_protocols[^;]*;/ssl_protocols TLSv1.2;/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>Proxy:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/proxy_ssl_protocols[^;]*;/proxy_ssl_protocols TLSv1.2;/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>If your ssl_protocols are not already configured, this can be accomplished manually by opening your web server or proxy server configuration file and manually adding the directives.</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Web Server:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">server {<br/>    ssl_protocols TLSv1.2;<br/>}
</xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>Proxy:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">location / {<br/>      proxy_pass cisecurity.org;<br/>      proxy_ssl_protocols TLSv1.2;<br/>    }
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Disabling certain TLS may not allow legacy user agents to connect to your server. Disabling negotiation of specific protocols with your backend server may also limit your ability to connect with legacy servers. You should always consider if you need to support legacy user agents or servers when selecting your TLS protocols.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="AND">
               
                  
                     
                        <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26467200" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.4.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26467200"/>
               </xccdf:check>
                        <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26467300" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.4.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26467300"/>
               </xccdf:check>
                     
                     <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26467400" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.4.3_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26467400"/>
               </xccdf:check>
                  
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26467500" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.4.4_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26467500"/>
               </xccdf:check>
               
               <xccdf:complex-check operator="OR">
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26467600" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.4.5_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26467600"/>
                  </xccdf:check>
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26467700" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.4.6_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26467700"/>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Disable_weak_ciphers" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Disable weak ciphers</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The ssl_ciphers directive should be used to configure the available ciphers on your web server, and the proxy_ssl_ciphers directive should be used to configure the available ciphers for your proxy. Weak ciphers should be disabled based on your company's policy or an industry best practice compliance profile.</xhtml:p>
               <xhtml:p>The ssl_prefer_server_ciphers should be used to ensure the user agent respects the server's preferred cipher order and does not set its own. If you are using a proxy or load balancer, you should use the proxy_ssl_ciphers directive to ensure your upstream connections are negotiated using secure ciphers.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>Note: TLS configuration should always be set to your organizational policy. This recommendation is designed to meet best practices and offers several profiles your organization may align to.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The use of strong ciphers is critical to maintaining strong encryption on your web server, load balancer, or proxy. Weak ciphers may compromise the security of your site or your users by allowing legacy user agents to connect to your site in a vulnerable way. You may also meet compliance concerns by ensuring that your upstream connections meet the same level of security if using a proxy or load balancer. The server should enforce the cipher preference on the server side to protect users from malicious actors on the client side.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">CIS Apache HTTP Server Benchmark</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://ssllabs.com</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://mozilla.github.io/server-side-tls/ssl-config-generator/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_ssl_module.html</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>The following procedures may be used to implement industry standard cipher profiles if you have an existing profile defined. These profiles may be modified to meet the requirements defined in your company's policy. This procedure assumes that all server blocks will be in /etc/nginx/nginx.conf and not inside any included files in the configuration.</xhtml:p>
                     <xhtml:p>Set the ssl_cipher directive as part of your server block, and set the proxy_ssl_ciphers directive as part of the location block for your upstream server.</xhtml:p>
                     <xhtml:p>This should look similar to the below examples:</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Server block configuration for client connectivity to web server, proxy, or load balancer:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">server {<br/>  ssl_ciphers ALL:!EXP:!NULL:!ADH:!LOW:!SSLv2:!SSLv3:!MD5:!RC4;<br/>}
</xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>Proxy or load balancer configuration for defined upstream negotiation:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">location / {<br/>  proxy_pass https://cisecurity.org;<br/>  proxy_ssl_ciphers ALL:!EXP:!NULL:!ADH:!LOW:!SSLv2:!SSLv3:!MD5:!RC4;<br/>}<br/>
                     </xhtml:code>
                     <xhtml:p>The below procedure assumes the default configuration profile. If you do not have ssl_ciphers or proxy_ssl_ciphers defined, add the directives to your proxy or web server configuration profile, then run the below commands to configure them to your selected profile.</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>FIPS 140-2 compliant proxy:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/proxy_ssl_ciphers[^;]*;/proxy_ssl_ciphers ALL:!EXP:!NULL:!ADH:!LOW:!SSLv2:!SSLv3:!MD5:!RC4;/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>Or if ssl_prefer_server_ciphers is not already enabled:</xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/proxy_ssl_ciphers[^;]*;/proxy_ssl_ciphers ALL:!EXP:!NULL:!ADH:!LOW:!SSLv2:!SSLv3:!MD5:!RC4;\nssl_prefer_server_ciphers on;/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>FIPS 140-2 compliant web server:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/ssl_ciphers[^;]*;/ssl_ciphers ALL:!EXP:!NULL:!ADH:!LOW:!SSLv2:!SSLv3:!MD5:!RC4;/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>Or if ssl_prefer_server_ciphers is not already enabled:</xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/ssl_ciphers[^;]*;/ssl_ciphers ALL:!EXP:!NULL:!ADH:!LOW:!SSLv2:!SSLv3:!MD5:!RC4;\nssl_prefer_server_ciphers on;<br/>/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>No weak ciphers SSLLABS proxy configuration</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/proxy_ssl_ciphers[^;]*;/proxy_ssl_ciphers HIGH:!aNULL:!CAMELLIA:!SHA:!RSA;/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>Or if ssl_prefer_server_ciphers is not already enabled:</xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/proxy_ssl_ciphers[^;]*;/proxy_ssl_ciphers HIGH:!aNULL:!CAMELLIA:!SHA:!RSA;\nssl_prefer_server_ciphers on;/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>No weak ciphers SSLLABS web server configuration:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/ssl_ciphers[^;]*;/ssl_ciphers HIGH:!aNULL:!CAMELLIA:!SHA:!RSA;/" /etc/nginx/nginx.conf<br/>
                        <br/>Or if ssl_prefer_server_ciphers is not already enabled:<br/>
                        <br/>sed -i "s/ssl_ciphers[^;]*;/ssl_ciphers HIGH:!aNULL:!CAMELLIA:!SHA:!RSA;\nssl_prefer_server_ciphers on;/" /etc/nginx/nginx.conf<br/>
                     </xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>Mozilla modern profile proxy:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/proxy_ssl_ciphers[^;]*;/proxy_ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>Or if ssl_prefer_server_ciphers is not already enabled:</xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/proxy_ssl_ciphers[^;]*;/proxy_ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';\nssl_prefer_server_ciphers on;/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>
                        <xhtml:strong>Mozilla modern profile web server:</xhtml:strong>
                     </xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/ssl_ciphers[^;]*;/ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>Or if ssl_prefer_server_ciphers is not already enabled:</xhtml:p>
                     <xhtml:code class="code_block">sed -i "s/ssl_ciphers[^;]*;/ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';\nssl_prefer_server_ciphers on;/" /etc/nginx/nginx.conf
</xhtml:code>
                     <xhtml:p>For changes to take effect, you must recycle nginx:</xhtml:p>
                     <xhtml:code class="code_block">service nginx restart
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Strong cipher configurations may not allow legacy user agents or user agents with weak configurations to connect to your site. If your server must also pass to a legacy upstream server, this may prevent it from being able to negotiate a cipher upstream.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_custom_Diffie-Hellman_parameters_are_used" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure custom Diffie-Hellman parameters are used</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Custom Diffie-Hellman (DH) key exchange parameters should be used. DH Ephemeral (DHE) parameters with at least 2048 bits should be generated.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Backward-compatible Perfect Forward Secrecy (PFS) ciphers (e.g. DHE-RSA-AES128-SHA256) should use strong and unique parameters. By default, NGINX will generate 1024-bit RSA keys for PFS ciphers; stronger alternatives should be used instead to provide better protection for data protected by encryption.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://weakdh.org/sysadmin.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Generate strong DHE (Ephemeral Diffie-Hellman) parameters using the following commands:</xhtml:p>
                     <xhtml:code class="code_block">mkdir /etc/nginx/ssl<br/>openssl dhparam -out /etc/nginx/ssl/dhparam.pem 2048<br/>chmod 400 /etc/nginx/ssl/dhparam.pem
</xhtml:code>
                     <xhtml:p>Alter the server configuration to use the new parameters:</xhtml:p>
                     <xhtml:code class="code_block">http {<br/>    server {<br/>        ssl_dhparam /etc/nginx/ssl/dhparam.pem;<br/>    }<br/>}
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Ensure_Online_Certificate_Status_Protocol_OCSP_stapling_is_enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure Online Certificate Status Protocol (OCSP) stapling is enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>OCSP allows a user's browser or another user agent to verify the certificate it is seeing is not revoked. OCSP stapling ensures your server presents this information to the user's browser in a way that best meets the performance and security needs of your website. It polls the Certificate Authority's (CA) OCSP server at regular intervals to ensure it is continuously kept up to date. OCSP stapling helps improve performance and security, so it should be enabled.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>OCSP stapling protects your users from accessing a website where a private key is believed to be compromised. If a private key is compromised, an attacker may be able to obtain unauthorized access to the encrypted data transmitted by a user.</xhtml:p>
               <xhtml:p>Note: OCSP stapling, while a step forward from the older certificate revocation list model, does share similar risks. Between the time a certificate is revoked and the point where a new signed OCSP profile is requested, if a server's certificate has been revoked a user agent may not be informed.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.digicert.com/ssl-support/nginx-enable-ocsp-stapling-on-server.htm</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Follow this procedure to enable OCSP validation:</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Step 1:</xhtml:strong> Ensure your NGINX server has access to your CA's OCSP server.</xhtml:p>
                     <xhtml:p>Your CA's OCSP server may be found on your CA's website and will vary depending on your CA vendor. Issue the following command in order to check your connectivity to their site:</xhtml:p>
                     <xhtml:code class="code_block">curl -I "insert certificate authority ocsp server here"
</xhtml:code>
                     <xhtml:p>If you get a 200 code response, your server has access.</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Step 2:</xhtml:strong> Enable OCSP on nginx.</xhtml:p>
                     <xhtml:p>Implement the ssl_stapling and ssl_stapling_verify directives. The directive ssl_stapling enables OCSP stapling, and the directive ssl_stapling_verify enables verification of the OCSP responses on nginx.</xhtml:p>
                     <xhtml:code class="code_block">server {<br/>  ssl_stapling on;<br/>  ssl_stapling_verify on;<br/>}
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:complex-check operator="AND">
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26466300" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.7.1_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26466300"/>
                  </xccdf:check>
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26466400" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.7.2_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26466400"/>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="AND">
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26466500" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.7.3_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26466500"/>
                  </xccdf:check>
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26466600" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.7.4_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26466600"/>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Ensure_HTTP_Strict_Transport_Security_HSTS_is_enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure HTTP Strict Transport Security (HSTS) is enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>HTTP Strict Transport Security (HSTS) headers instruct a user agent on how to communicate with a web server. HSTS headers ensure the strict transport security policies built into browsers and other user agents are informed only to communicate over HTTPS. HSTS with long validity periods should be used to most effectively secure your user population.</xhtml:p>
               <xhtml:p>Strict-Transport-Security should have a long max-age, which is recommended to be at least six months in length. This ensures the browser remembers your website should only be accessible via HTTPS for this amount of time.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>HSTS headers help protect a server's users from accessing the server over unencrypted protocols. This header helps to prevent HTTP downgrade attacks.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.globalsign.com/en/blog/what-is-hsts-and-how-do-i-use-it/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://mozilla.github.io/server-side-tls/ssl-config-generator/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security#Preloading_Strict_Transport_Security</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://hstspreload.org</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://tools.ietf.org/html/rfc6797</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Ensure the below snippet of code can be found in your server configuration for your proxy or web server. This will ensure the HSTS header is set with a validity period of six months, or 15768000 seconds.</xhtml:p>
                     <xhtml:code class="code_block">server {<br/>  add_header Strict-Transport-Security "max-age=15768000;";<br/>}
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26466700" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.8.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26466700"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26466800" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.8.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26466800"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.9_Ensure_HTTP_Public_Key_Pinning_is_enabled" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure HTTP Public Key Pinning is enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>HTTP Public Key Pinning, also known as certificate pinning, allows a site to specify exactly which certificates the browser or another user agent should accept. HTTP Public Key Pinning allows for the certificate rotation to be scheduled using backup fingerprints to ensure that user agent has both certificates stored. HTTP Public Key Pinning should be enabled.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>HTTP Public Key Pinning assists in preventing a user agent from falling victim to a forged certificate, such as man in the middle attacks.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://developer.mozilla.org/en-US/docs/Web/HTTP/Public_Key_Pinning</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Find the fingerprint of your certificate by referencing the fingerprint section of your certificate details. Take down the SHA256 fingerprint in this section as well as that of a backup certificate or the next scheduled certificate for the website.</xhtml:p>
                     <xhtml:p>Insert your SHA256 fingerprint along with the below header to your server configuration:</xhtml:p>
                     <xhtml:code class="code_block">add_header Public-Key-Pins 'pin-sha256="base64+primary==InsertPrimaryCertificateSHA256FingerPrintHere"; pin-sha256="base64+backup==InsertBackupCertificateSHA256FingerPrintHere"; max-age=5184000;
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26467800" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.9.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26467800"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26467900" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.9.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26467900"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Ensure_upstream_server_traffic_is_authenticated_with_a_client_certificate" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure upstream server traffic is authenticated with a client certificate</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Client certificate validation allows the upstream server to authenticate the identity of the client connecting to it. This assists in the establishment of mutual authentication between the client and the server.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>Your upstream server must also be configured to verify the client certificate. If your upstream web server is an NGINX web server, you may accomplish this by adding the client certificate into a file referenced by the directive ssl_client_certificate. This should be part of your server block. An example is below.</xhtml:p>
                  <xhtml:code class="code_block">ssl_client_certificate      /etc/nginx/ssl/ca.cert;<br/>ssl_verify_client	    on;
</xhtml:code>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Using client certificate validation allows you to establish a trusted proxy server.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/1/subcontrol/6" system="http://cisecurity.org/20-cc/v6.1"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/1/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://docs.nginx.com/nginx/admin-guide/security-controls/securing-http-traffic-upstream/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://www.staticshin.com/programming/proxy-ssl-cert-in-nginx.html</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_ssl_certificate</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In order to implement this recommendation, you must create a client certificate to be authenticated against and have it signed. Once you have a signed certificate, place the certificate in a location of your choice. In the below example, we use /etc/nginx/ssl/cert.pem. Implement the configuration as part of the location block:</xhtml:p>
                     <xhtml:code class="code_block">proxy_ssl_certificate /etc/nginx/ssl/nginx.pem;  <br/>proxy_ssl_certificate_key /etc/nginx/ssl/nginx.key;
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:complex-check operator="AND">
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26468200" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.10.1_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26468200"/>
                  </xccdf:check>
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26468300" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.10.2_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26468300"/>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="AND">
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26468400" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.10.3_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26468400"/>
                  </xccdf:check>
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26468500" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.10.4_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26468500"/>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.11_Ensure_the_upstream_traffic_server_certificate_is_trusted" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure the upstream traffic server certificate is trusted</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The NGINX server should be configured to validate the identity of the upstream server it is sending information to.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Configuring NGINX to validate the identity of the upstream server helps mitigate the risk of a man in the middle attack occurring against your server.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://docs.nginx.com/nginx/admin-guide/security-controls/securing-http-traffic-upstream/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_ssl_trusted_certificate</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Obtain the full certificate chain of the upstream server in .pem format. Then reference that file in the location block as part of the proxy_ssl_trusted_certificate directive. Implement the proxy_ssl_trusted_certificate and proxy_ssl_verify directives as shown below as part of the location block you are using to send traffic to your upstream server.</xhtml:p>
                     <xhtml:code class="code_block">proxy_ssl_trusted_certificate /etc/nginx/trusted_ca_cert.crt;<br/>proxy_ssl_verify        on;
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:complex-check operator="AND">
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26468600" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.11.1_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26468600"/>
                  </xccdf:check>
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26468700" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.11.2_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26468700"/>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="AND">
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26468800" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.11.3_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26468800"/>
                  </xccdf:check>
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26468900" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.11.4_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26468900"/>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.12_Ensure_your_domain_is_preloaded" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure your domain is preloaded</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Preloading your domain hardcodes it as only being accessible through HTTPS by browsers.</xhtml:p>
               <xhtml:p>
                  <xhtml:strong>Note: Preloading should only be done with careful consideration!</xhtml:strong> Your website and all its subdomains will be forced over HTTPS. If your website or any of its subdomains are not able to support preloading, you should not preload your site. Preloading should be opt-in only, and if done, may impact more sites than the nginx instance you are working on. Removing preloading can be slow and painful, and should only be done with careful consideration according to https://hstspreload.org.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Preloading your domain helps prevent HTTP downgrade attacks and increases trust.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://hstspreload.org/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>In order to successfully preload your website, you must meet the below criteria:</xhtml:p>
                     <xhtml:ol>
                        <xhtml:li>Serve a valid certificate.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>This may be accomplished by following recommendation 4.1.2.</xhtml:p>
                     <xhtml:ol start="2">
                        <xhtml:li>Redirect from HTTP to HTTPS if using port 80.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>This may be accomplished by following recommendation 4.1.1.</xhtml:p>
                     <xhtml:ol start="3">
                        <xhtml:li>Configure all subdomains to support HTTPS only.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>This will require you to configure all subdomains for HTTPS only. For example, a subdomain of cissecurity.org is workbench.cissecurity.org and would need to be configured for HTTPS only.</xhtml:p>
                     <xhtml:ol start="4">
                        <xhtml:li>Configure an HSTS header on your base domain, as shown below for nginx.</xhtml:li>
                     </xhtml:ol>
                     <xhtml:p>If your base domain is nginx, you may accomplish this with several modifications from the HSTS recommendation. Change your header to include the preload directive and the includesubdomains directive, and make your max-length one year or longer. The header should be modified similar to the below snippet.</xhtml:p>
                     <xhtml:code class="code_block">add_header Strict-Transport-Security "Strict-Transport-Security: max-age=31536000; includeSubDomains; preload";
</xhtml:code>
                     <xhtml:p>After you have met these requirements, add your site to the list by following the instructions at https://hstspreload.org/.</xhtml:p>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.13_Ensure_session_resumption_is_disabled_to_enable_perfect_forward_security" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure session resumption is disabled to enable perfect forward security</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Session resumption for HTTPS sessions should be disabled so perfect forward secrecy can be achieved.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Perfect forward secrecy is an encryption mechanism that enables past session keys to not be compromised even if the server's private key is compromised. If an attacker recorded all traffic to a server and stored it and then obtained the private key without perfect forward secrecy, all communications would be compromised. With perfect forward secrecy, session keys are generated using Diffie-Hellman for every session a user initiates, which isolates session compromise to only that communication session. Allowing session resumption breaks perfect forward secrecy; this expands the surface area for an attacker to compromise past sessions and communications with a server if they are able to compromise the session.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.imperialviolet.org/2013/06/27/botchingpfs.html</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://scotthelme.co.uk/perfect-forward-secrecy/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Turn off the ssl_session_tickets directive as part of any server block in your nginx configuration:</xhtml:p>
                     <xhtml:code class="code_block">ssl_session_tickets off;
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26469000" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.13.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26469000"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26469100" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.13.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26469100"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.14_Ensure_HTTP2.0_is_used" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure HTTP/2.0 is used</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>HTTP/2.0 is an optimized and more secure version of the HTTP protocol. It should be enabled so users can take advantage of it.</xhtml:p>
               <xhtml:p>Note: Legacy user agents may not be able to connect to a server using HTTP/2.0.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>HTTP/2.0 is not supported for proxies at the time of the writing of this recommendation.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>HTTP/2.0 introduces both performance benefits through full multiplexing and several security benefits. HTTP/2.0 has improved cipher suite requirements and blacklists. It also disables session renegotiation and TLS compression. This helps protect against vulnerabilities like CRIME and ensures we have stronger encryption.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://mozilla.github.io/server-side-tls/ssl-config-generator/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://http2.github.io/http2-spec/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Open the nginx server configuration file and configure all listening ports with http2, similar to that of this example:</xhtml:p>
                     <xhtml:code class="code_block">server {<br/>    listen 443 ssl http2;<br/>}
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26468000" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.14.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26468000"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26468100" value-id="xccdf_org.cisecurity.benchmarks_value_4.1.14.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26468100"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Request_Filtering_and_Restrictions">
      <xccdf:title xml:lang="en">Request Filtering and Restrictions</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.1_Access_Control">
         <xccdf:title xml:lang="en">Access Control</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_allow_and_deny_filters_limit_access_to_specific_IP_addresses" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure allow and deny filters limit access to specific IP addresses</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>IP-based restrictions act as a defense in depth mechanism. They allow you to whitelist legitimate paths to your applications and explicitly deny IP addresses you believe to be malicious.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>Note: If you do not want to restrict this to a specific network range, this recommendation may not fit your use case.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>IP restrictions help you to only allow traffic based on the concept of least privilege. You may specify vlans, countries, or specific servers that may be allowed or denied on your site. It is recommended that you implicitly deny all traffic and only allow those with a legitimate use case to access your website if choosing to take this approach. This allows you to limit the surface area an attack may come from.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://help.dreamhost.com/hc/en-us/articles/222784068-The-most-important-steps-to-take-to-make-an-nginx-server-more-secure</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_access_module.html</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Compile a list of network ranges or IP addresses you would want to access your web server or proxy. Then add these ranges with the allow directive. The deny directive should be included with all IP addresses implicitly denied.</xhtml:p>
                     <xhtml:code class="code_block">location / {<br/>    allow 10.1.1.1;<br/>    deny all;<br/>} 
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_only_whitelisted_HTTP_methods_are_allowed" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure only whitelisted HTTP methods are allowed</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>HTTP methods (also known as verbs) allow different actions to be requested from the web server at a specified path. Only the necessary methods should be enabled.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Most websites only require the methods GET, POST and HEAD to function correctly. Web applications may also require other verbs (e.g. DELETE). In order to narrow vectors of attack, it is recommended to only enable the required verbs.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.acunetix.com/blog/articles/nginx-server-security-hardening-configuration-1/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>To remove unneeded methods and only allow required methods, add the following into a server or location block in your nginx.conf.  The below snippet assumes only the methods GET, HEAD and POST are required for an application. The reason for 444 as a response is because it contains no information and can help mitigate automated attacks.</xhtml:p>
                     <xhtml:code class="code_block">if ($request_method !~ ^(GET|HEAD|POST)$) {<br/>   return 444;<br/>}
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.2_Request_Limits">
         <xccdf:title xml:lang="en">Request Limits</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_timeout_values_for_reading_the_client_header_and_body_are_set_correctly" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure timeout values for reading the client header and body are set correctly</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The client_header_timeout and client_body_timeout directives define the time the server will wait for the header or body to be sent from the client. If the client does not send the entire header in this predefined timeframe, the server will send back a 408 request timeout error.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Setting the client header and body timeouts help your server mitigate possible denial of service attacks. By timing out a request, the server is able to free up resources that may be waiting for the body or header.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.owasp.org/index.php/SCG_WS_nginx</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://blog.qualys.com/securitylabs/2011/11/02/how-to-protect-against-slow-http-attacks</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Find the HTTP or server block of your nginx configuration and add the client_header_timeout and client_body_timeout directives set to the configuration. The below example sets the timeouts to 10 seconds.</xhtml:p>
                     <xhtml:code class="code_block">client_body_timeout   10;<br/>client_header_timeout 10;
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:complex-check operator="AND">
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26469200" value-id="xccdf_org.cisecurity.benchmarks_value_5.2.1.1_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26469200"/>
                  </xccdf:check>
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26469300" value-id="xccdf_org.cisecurity.benchmarks_value_5.2.1.2_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26469300"/>
                  </xccdf:check>
               </xccdf:complex-check>
               <xccdf:complex-check operator="AND">
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26469400" value-id="xccdf_org.cisecurity.benchmarks_value_5.2.1.3_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26469400"/>
                  </xccdf:check>
                  <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26469500" value-id="xccdf_org.cisecurity.benchmarks_value_5.2.1.4_var"/>
                     <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26469500"/>
                  </xccdf:check>
               </xccdf:complex-check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Ensure_the_maximum_request_body_size_is_set_correctly" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure the maximum request body size is set correctly</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The client_max_body_size directive sets the size of the request body that is allowed to read a client request. This defines the number of bytes allowed in a request and is equivalent to the Content-Length request header field.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Limiting the size of the request body helps prevent unexpectedly long or large client requests from being passed to an application to perform buffer overflow attacks. This value should be set low enough to protect the application but high enough not to interfere with functionality and block legitimate request bodies.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.cyberciti.biz/tips/linux-unix-bsd-nginx-webserver-security.html</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_core_module.html#client_body_temp_path</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.acunetix.com/blog/articles/nginx-server-security-hardening-configuration-1/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.tecmint.com/nginx-web-server-security-hardening-and-performance-tips/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Find the HTTP or server block of your nginx configuration and add the client_max_body_size set to 100K in this block. The appropriate value may be different based on your application's needs.</xhtml:p>
                     <xhtml:code class="code_block">client_max_body_size 100K
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26469600" value-id="xccdf_org.cisecurity.benchmarks_value_5.2.2.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26469600"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26469700" value-id="xccdf_org.cisecurity.benchmarks_value_5.2.2.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26469700"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Ensure_the_maximum_buffer_size_for_URIs_is_defined" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure the maximum buffer size for URIs is defined</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The large_client_header_buffers directive defines the number and size of buffers used within the URI. A request cannot exceed the size of this buffer when this directive is configured. The large_client_header_buffers directive should be set to restrict buffer usage. The number of buffers should generally set to two and the length be set to 1K; however, this may not be a good fit for your application and may need to be set differently.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>If this directive is not set correctly, users may receive a 414 Request-URI Too Large error.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The large_client_header_buffers directive may assist in preventing buffer overflow attacks that leverage long URI query parameters.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.cyberciti.biz/tips/linux-unix-bsd-nginx-webserver-security.html</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.owasp.org/index.php/Denial_of_Service_Cheat_Sheet</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_core_module.html#large_client_header_buffers</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Open your nginx.conf file and locate your server or HTTP blocks. This may be added to the HTTP block for all configurations or the server block for more specific configurations to meet your needs. Add the below line to implement this recommendation:</xhtml:p>
                     <xhtml:code class="code_block">large_client_header_buffers 2 1k
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26469800" value-id="xccdf_org.cisecurity.benchmarks_value_5.2.3.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26469800"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26469900" value-id="xccdf_org.cisecurity.benchmarks_value_5.2.3.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26469900"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Ensure_the_number_of_connections_per_IP_address_is_limited" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure the number of connections per IP address is limited</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The maximum number of simultaneous connections allowed from a single IP address to your server should be limited. It should be set to a value that meets your organizational policies.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Limiting the number of simultaneous connections is an effective way to prevent slow denial of service attacks that try to use as many server resources as possible. This can also help prevent brute force attacks on a login page.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.nginx.com/resources/library/complete-nginx-cookbook/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">http://nginx.org/en/docs/http/ngx_http_limit_conn_module.html</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://scotthelme.co.uk/mitigating-http-get-dos-attack/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Implement the below directives under the HTTP and server blocks of your nginx configuration or any include files. The below configuration creates a memory zone of 10 megabytes called limitperip. It will limit the number of connections per IP address to 10 simultaneous connections. The number of simultaneous connections to allow may be different depending on your organization's policies and use cases.</xhtml:p>
                     <xhtml:code class="code_block">http {<br/>  limit_conn_zone $binary_remote_addr zone=limitperip:10m; <br/>  server {<br/>    limit_conn limitperip 10;<br/>  }<br/>}
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Users of your system that are behind a corporate web proxy using network address translation or a proxy service such as tor may have an increased chance of being blocked due to this configuration. This is because multiple users in these scenarios come from the same IP address. You should always consider your user base when setting a connection limit.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Ensure_rate_limits_by_IP_address_are_set" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure rate limits by IP address are set</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Rate limiting should be enabled to limit the number of requests an IP address may make to a server in a given period of time. The configuration values should be set based on your application's needs and your organizational policy.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Rate limiting allows you to mitigate potential denial of service attacks as a defense in depth mechanism.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://scotthelme.co.uk/mitigating-http-get-dos-attack/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.nginx.com/blog/rate-limiting-nginx/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Implement the below directives under the HTTP and server blocks of your nginx configuration or any include files. The below configuration creates a memory zone of 10 megabytes called "ratelimit" and sets the number of requests per second that can be sent by any given IP address to 5. Further, this configuration sets a burst of 10 to ensure that requests may come more frequently and sets no delay to ensure that the bursting may be all at once and not queued.</xhtml:p>
                     <xhtml:code class="code_block">http {<br/>  limit_req_zone $binary_remote_addr zone=ratelimit:10m rate=5r/s;<br/>  server {<br/>    location / {<br/>      limit_req zone=ratelimit burst=10 nodelay;<br/>    }<br/>  }<br/>}
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>If you serve a high traffic API, this may prevent users from being able to call your website. You may also limit users behind a corporate web proxy or a proxy service such as tor if they use your website heavily.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.3_Browser_Security">
         <xccdf:title xml:lang="en">Browser Security</xccdf:title>
         <xccdf:description xml:lang="en"/>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_X-Frame-Options_header_is_configured_and_enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure X-Frame-Options header is configured and enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The X-Frame-Options header should be set to allow specific websites or no sites at all to embed your website as an object within their own, depending on your organizational policy and application needs.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>
                     <xhtml:strong>Important Note:</xhtml:strong> The configuration in this recommendation recommends that this header is set to the same origin; however, this does not mean that if it is not set so, that this is done incorrectly. This header may also be configured to allow from specific origins or deny from all origins.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>The X-Frame-Options header allows you to mitigate the risk of clickjacking attacks.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://scotthelme.co.uk/hardening-your-http-response-headers/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.veracode.com/blog/2014/03/guidelines-for-setting-security-headers</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.owasp.org/index.php/OWASP_Secure_Headers_Project</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Add the below to your server blocks in your nginx configuration. The policy should be configured to meet your organization's needs.</xhtml:p>
                     <xhtml:code class="code_block">add_header X-Frame-Options "SAMEORIGIN";
</xhtml:code>
                     <xhtml:p class="bold">Impact:</xhtml:p>
                     <xhtml:p>
                        <xhtml:p>Implementing this may block legitimate partner sites from embedding your website if this header is not configured properly.</xhtml:p>
                     </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26470000" value-id="xccdf_org.cisecurity.benchmarks_value_5.3.1.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26470000"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26470100" value-id="xccdf_org.cisecurity.benchmarks_value_5.3.1.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26470100"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3.2_Ensure_X-Content-Type-Options_header_is_configured_and_enabled" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure X-Content-Type-Options header is configured and enabled</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The X-Content-Type-Options header should be used to force supported user agents to check an HTTP response's content type header with what is expected from the destination of the request.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Implementing the X-Content-Type-Options header with the "nosniff" directive helps to prevent drive-by download attacks where a user agent is sniffing content types in responses.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/7" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://scotthelme.co.uk/hardening-your-http-response-headers/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.veracode.com/blog/2014/03/guidelines-for-setting-security-headers</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.owasp.org/index.php/OWASP_Secure_Headers_Project</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://fetch.spec.whatwg.org/#x-content-type-options-header</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.iana.org/assignments/message-headers/message-headers.xml#perm-headers</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Open the nginx configuration file that contains your server blocks. Add the below line into your server block to add X-Content-Type-Options header and direct your user agent to not sniff content types.</xhtml:p>
                     <xhtml:code class="code_block">add_header X-Content-Type-Options "nosniff";
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26470200" value-id="xccdf_org.cisecurity.benchmarks_value_5.3.2.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26470200"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26470300" value-id="xccdf_org.cisecurity.benchmarks_value_5.3.2.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26470300"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3.3_Ensure_the_X-XSS-Protection_Header_is_enabled_and_configured_properly" role="full" selected="false" weight="1.0">
            <xccdf:title xml:lang="en">Ensure the X-XSS-Protection Header is enabled and configured properly</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>The X-Xss-Protection Header allows you to leverage browser-based protections against cross-site scripting. This should be implemented on your web servers to protect your users and increase user trust in your site. Your policy should be set in blocking mode when possible to ensure the browser blocks a page if cross-site scripting is detected.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>X-Xss-Protection allows you to protect users whose browsers do not support Content Security Policy (generally older browsers), or protect users if you do not have a Content Security Policy.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://www.owasp.org/index.php/OWASP_Secure_Headers_Project</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://scotthelme.co.uk/hardening-your-http-response-headers/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Open your nginx configuration file that contains your server blocks. Add the below line into your server block to add Content-Security-Policy and direct your user agent to block reflected cross-site scripting.</xhtml:p>
                     <xhtml:code class="code_block">add_header X-Xss-Protection "1; mode=block";
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
            <xccdf:complex-check operator="OR">
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26470400" value-id="xccdf_org.cisecurity.benchmarks_value_5.3.3.1_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26470400"/>
               </xccdf:check>
               <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <xccdf:check-export xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" export-name="oval:org.cisecurity.benchmarks.a_nginx_nginx:var:26470500" value-id="xccdf_org.cisecurity.benchmarks_value_5.3.3.2_var"/>
                  <xccdf:check-content-ref xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:ecl="http://cisecurity.org/check" href="CIS_NGINX_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks.a_nginx_nginx:def:26470500"/>
               </xccdf:check>
            </xccdf:complex-check>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3.4_Ensure_that_Content_Security_Policy_CSP_is_enabled_and_configured_properly" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure that Content Security Policy (CSP) is enabled and configured properly</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>Content Security Policy allows administrators to specify the locations from which allowable scripts may be executed, or if scripts may be executed at all. Content Security Policy should be used to improve user trust of your website.</xhtml:p>
            </xccdf:description>
            <xccdf:metadata>
               <notes:notes xml:lang="en">
                  <xhtml:p>
                     <xhtml:strong>Important Note:</xhtml:strong> Content Security Policy may be customized for a significant number of use cases, including upgrading insecure requests, directing the origin of executables, and reporting violations of the policy. This is a simplistic version that does not go into the depth of what a CSP may do and is not representative of how the policy should look for your site. Organizations should ensure that their CSP will meet their specific use case and needs.</xhtml:p>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong> If your CSP is not continuously updated as your application adds resources that come from different origins or if the CSP is not correct the first time, you may block execution from legitimate origins.</xhtml:p>
               </notes:notes>
            </xccdf:metadata>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>Content Security Policies assist organizations in mitigating and reporting cross-site scripting (XSS) attacks.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://scotthelme.co.uk/hardening-your-http-response-headers/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.owasp.org/index.php/OWASP_Secure_Headers_Project</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.w3.org/TR/CSP3/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Open your nginx configuration file that contains your server blocks. Add the below line into your server block to add Content-Security-Policy and direct your user agent to accept documents from only specific origins.</xhtml:p>
                     <xhtml:code class="code_block">add_header Content-Security-Policy "default-src 'self'"; 
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
         <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3.5_Ensure_the_Referrer_Policy_is_enabled_and_configured_properly" role="unscored" selected="false" weight="0.0">
            <xccdf:title xml:lang="en">Ensure the Referrer Policy is enabled and configured properly</xccdf:title>
            <xccdf:description xml:lang="en">
               <xhtml:p>When an origin site directs a user to another site, a referrer is sent that identifies the URL the user came from. Depending on your site's specific use, this may present a privacy concern to your users. The Referrer Policy enables organizations to define what sites should see that a referral came from your site, which helps protect user privacy.</xhtml:p>
            </xccdf:description>
            <xccdf:rationale xml:lang="en">
               <xhtml:p>A Referrer header may expose sensitive data in another web server's log if you use sensitive data in your URL parameters, such as personal information, username, and password or persistent sessions. Ultimately, depending on your application design, not using a properly configured Referrer Policy may allow session hijacking, credential gathering, or sensitive data exposure in a third party's logs.</xhtml:p>
            </xccdf:rationale>
            <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
            <xccdf:ident system="http://cce.mitre.org">https://scotthelme.co.uk/a-new-security-header-referrer-policy/</xccdf:ident>
            <xccdf:ident system="http://cce.mitre.org">https://www.w3.org/TR/referrer-policy/</xccdf:ident>
            <xccdf:fixtext xml:lang="en">
               <xhtml:div>
                  <xhtml:p>
                     <xhtml:p>Add the below line to the server blocks within your nginx configuration. The policy should be customized for your specific organization's needs. The below policy will ensure your website is never allowed in a referrer.</xhtml:p>
                     <xhtml:code class="code_block">add_header Referrer-Policy "no-referrer";
</xhtml:code>
                     <xhtml:p> </xhtml:p>
                  </xhtml:p>
               </xhtml:div>
            </xccdf:fixtext>
         </xccdf:Rule>
      </xccdf:Group>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6_Mandatory_Access_Control">
      <xccdf:title xml:lang="en">Mandatory Access Control</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Mandatory Access Control (MAC) provides an additional layer of access restrictions to processes on top of the base Discretionary Access Controls. By restricting how processes can access files and resources on a system the potential impact from vulnerabilities in the processes can be reduced, reducing the attack surface of the system.</xhtml:p>
         <xhtml:p>Impact: Mandatory Access Control (MAC) limits the capabilities of applications and daemons on a system, while this can prevent unauthorized access the configuration of MAC can be complex and difficult to implement correctly preventing legitimate access from occurring.  If your MAC policy is not configured correctly this may block legitimate access by users. You should check your audit.d file for legitimate traffic that may have been blocked by your MAC policy, and correct your policy if needed.</xhtml:p>
      </xccdf:description>
   </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>3kts5+4Yqmcb7Q6yBEgGM7bok9c=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
gZDNGBSqQ7g3Ts75Qn83ke20NqRBdOr9RZEo26T/GjXwY+0AsY/yVeny/qMDeo4AxmHfyHhtYkZm
IP07pR1Y1N/irlMWQ1GYKTpJeAA0FM6OYVi99yk+tDOuM1EDpkzfQr8cvjaLvXFs/jl8SKDQzM9u
8RxOz0JNKy7Kga9ISwwhKiiUEeg4T1tjLm2KIQ3tnFmbg6/Fzr3Fhjs7ysngIebHpr9bdmFaKASy
RxvMefoe3WM8CVH6/TAfwrjEC177rNZXyL22/AE4WVeazt/k6uNHFeJEXuUmsWPb2J7Mvyk5zO3A
RvmnejLnUkT7S5j1L1otAz4v8UUJ2+tfpOMbrg==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFUjCCBDqgAwIBAgIIPx+qZKptEY4wDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNv
bSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMw
MQYDVQQDEypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMjAw
OTA4MTMzOTM5WhcNMjMxMDI4MDAzMjA1WjCBkzELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE5ldyBZ
b3JrMRcwFQYDVQQHEw5FYXN0IEdyZWVuYnVzaDErMCkGA1UEChMiQ2VudGVyIGZvciBJbnRlcm5l
dCBTZWN1cml0eSwgSW5jLjErMCkGA1UEAxMiQ2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwg
SW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDBp4+sl9kB5JRmnQH0wcbLLz/t
n2HoD6TRl3xJj12V61njBNgaiGzvoSl07sFLnESukb0CU44MzYDoUMdx3HJUcEAeMY/9eITqGUnk
N4WsP145eFqH7FoszOY/4NYlgYMYt8ZP2kRHyim9LpQTLT/1mBaUkY2f2e5uUCootH3iT8W3/sK2
flLzWfLgXTvkhJm4Uvw1RErBFs15+krW0KWtnZ6NmiDhmV0CnFGNnd1meGZPs2sBXEVGLJVSKzoT
G9Ht/oWyRLRcJuXpHoXTYpkqM2MsixmSaJy5b6/D35r0NXHru3p1gkX2a0VgJQxxWqLi3bVPzpl3
PlJu3C8M/FUCAwEAAaOCAYUwggGBMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwMw
DgYDVR0PAQH/BAQDAgeAMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwuZ29kYWRkeS5jb20v
Z2RpZzJzNS02LmNybDBdBgNVHSAEVjBUMEgGC2CGSAGG/W0BBxcCMDkwNwYIKwYBBQUHAgEWK2h0
dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQQBMHYGCCsG
AQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUF
BzAChjRodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0
MB8GA1UdIwQYMBaAFEDCvSeOzDSDMKIz1/tss/C0LIDOMB0GA1UdDgQWBBT7fOf4ISDprbE+qUFe
+friFTKgHjANBgkqhkiG9w0BAQsFAAOCAQEAT0XLw2vmuq6e58bkLDXdqKeGQjREDChLw2Mae9LI
JB93QgdA2OCLA1FwU2s7lawEDcma9wPiugxVGoaQNOfRw2/+cz0xmR3uaKQq6I24dWbHF20N2tSz
1RAAK1lRZKewA1fj+qqKWjzETA0LpqZlaFF+CKBpQcyfYyQRZxpHkB1vvKMf4kMIRKruvl4ixLjN
uAZrbQUWlXuq/MUkVP3FgdxWBPfmMGyngHs4hNMaSQGb1TEhBjj+PGoSunAyaOgO/P94XJPQQX3O
2oNDsPou6gKcNtbZrH+iYTJ8rcqQTontMwSP/HrYj8lgG3neG53vk05p0jCn2M5W0ukJ4LPEnA==
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>