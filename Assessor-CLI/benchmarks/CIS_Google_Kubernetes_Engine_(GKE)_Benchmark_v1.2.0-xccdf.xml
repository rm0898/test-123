<xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.2.0_CIS_Google_Kubernetes_Engine_GKE_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
  <xccdf:status date="2021-11-05">draft</xccdf:status>
  <xccdf:title xml:lang="en">CIS Google Kubernetes Engine (GKE) Benchmark</xccdf:title>
  <xccdf:description xml:lang="en">
    <xhtml:p>
This document provides prescriptive guidance for running Google Kubernetes Engine (GKE) v1.15 following recommended security controls. This benchmark only includes controls which can be modified by an end user of GKE. For information on GKE's performance against the Kubernetes CIS benchmarks, for items which cannot be audited or modified, see the GKE documentation at       <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks">https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks</xhtml:a>
.    </xhtml:p>
    <xhtml:p>
For the latest GKE hardening guide, see       <xhtml:a href="https://g.co/gke/hardening">g.co/gke/hardening</xhtml:a>
.    </xhtml:p>
    <xhtml:p>To obtain the latest version of this guide, please visit www.cisecurity.org. If you have questions, comments, or have identified ways to improve this guide, please write us at support@cisecurity.org.</xhtml:p>
  </xccdf:description>
  <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
  <xccdf:version>1.2.0</xccdf:version>
  <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1_-_Worker_Node">
    <xccdf:title xml:lang="en">Level 1 - Worker Node</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>Items in this profile intend to:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>be practical and prudent;</xhtml:li>
        <xhtml:li>provide a clear security benefit; and</xhtml:li>
        <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
      </xhtml:ul>
      <xhtml:p>These recommendations are widely applicable to almost all use cases for GKE Worker Nodes, and should generally be applied.</xhtml:p>
    </xccdf:description>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Ensure_that_the_proxy_kubeconfig_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2_Ensure_that_the_proxy_kubeconfig_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3_Ensure_that_the_kubelet_configuration_file_has_permissions_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4_Ensure_that_the_kubelet_configuration_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_that_the_--anonymous-auth_argument_is_set_to_false" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Ensure_that_the_--read-only-port_argument_is_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Ensure_that_the_--streaming-connection-idle-timeout_argument_is_not_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.6_Ensure_that_the_--protect-kernel-defaults_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.7_Ensure_that_the_--make-iptables-util-chains_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.8_Ensure_that_the_--hostname-override_argument_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.10_Ensure_that_the_--tls-cert-file_and_--tls-private-key-file_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.11_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.12_Ensure_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9.1_Enable_Customer-Managed_Encryption_Keys_CMEK_for_GKE_Persistent_Disks_PD" selected="true"/>
  </xccdf:Profile>
  <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2_-_Worker_Node">
    <xccdf:title xml:lang="en">Level 2 - Worker Node</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
        <xhtml:li>acts as defense in depth measure</xhtml:li>
        <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
      </xhtml:ul>
      <xhtml:p>These recommendations may only be recommended for some use cases in GKE Worker Nodes, such as multi-tenant clusters. They are not always practical recommendations and may adversely impact other aspects of your workload, such as performance or manageability.</xhtml:p>
    </xccdf:description>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Ensure_that_the_proxy_kubeconfig_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.2_Ensure_that_the_proxy_kubeconfig_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.3_Ensure_that_the_kubelet_configuration_file_has_permissions_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.4_Ensure_that_the_kubelet_configuration_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_that_the_--anonymous-auth_argument_is_set_to_false" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Ensure_that_the_--read-only-port_argument_is_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Ensure_that_the_--streaming-connection-idle-timeout_argument_is_not_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.6_Ensure_that_the_--protect-kernel-defaults_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.7_Ensure_that_the_--make-iptables-util-chains_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.8_Ensure_that_the_--hostname-override_argument_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.9_Ensure_that_the_--event-qps_argument_is_set_to_0_or_a_level_which_ensures_appropriate_event_capture" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.10_Ensure_that_the_--tls-cert-file_and_--tls-private-key-file_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.11_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.12_Ensure_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.9.1_Enable_Customer-Managed_Encryption_Keys_CMEK_for_GKE_Persistent_Disks_PD" selected="true"/>
  </xccdf:Profile>
  <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1_-_Master_Node">
    <xccdf:title xml:lang="en">Level 1 - Master Node</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>Items in this profile intend to:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>be practical and prudent;</xhtml:li>
        <xhtml:li>provide a clear security benefit; and</xhtml:li>
        <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
      </xhtml:ul>
      <xhtml:p>These recommendations are widely applicable to almost all use cases for the GKE Master Node, and should generally be applied.</xhtml:p>
    </xccdf:description>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Client_certificate_authentication_should_not_be_used_for_users" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_that_a_minimal_audit_policy_is_created" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Minimize_access_to_secrets" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Minimize_access_to_create_pods" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_default_service_accounts_are_not_actively_used." selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Minimize_the_admission_of_privileged_containers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Minimize_the_admission_of_containers_with_added_capabilities" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.1_Ensure_that_the_CNI_in_use_supports_Network_Policies" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.1_Create_administrative_boundaries_between_resources_using_namespaces" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Image_Vulnerability_Scanning_using_GCR_Container_Analysis_or_a_third_party_provider" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_user_access_to_GCR" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_cluster_access_to_read-only_for_GCR" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_GKE_clusters_are_not_running_using_the_Compute_Engine_default_service_account" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Prefer_using_dedicated_GCP_Service_Accounts_and_Workload_Identity" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_Kubernetes_Secrets_are_encrypted_using_keys_managed_in_Cloud_KMS" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Ensure_legacy_Compute_Engine_instance_metadata_APIs_are_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.2_Ensure_Node_Auto-Repair_is_enabled_for_GKE_nodes" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.3_Ensure_Node_Auto-Upgrade_is_enabled_for_GKE_nodes" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.4_When_creating_New_Clusters_-_Automate_GKE_version_management_using_Release_Channels" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.5_Ensure_Shielded_GKE_Nodes_are_Enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.6_Ensure_Integrity_Monitoring_for_Shielded_GKE_Nodes_is_Enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.2_Ensure_use_of_VPC-native_clusters" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.3_Ensure_Master_Authorized_Networks_is_Enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.5_Ensure_clusters_are_created_with_Private_Nodes" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.7_Ensure_Network_Policy_is_Enabled_and_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7.1_Ensure_Stackdriver_Kubernetes_Logging_and_Monitoring_is_Enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8.1_Ensure_Basic_Authentication_using_static_passwords_is_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8.2_Ensure_authentication_using_Client_Certificates_is_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8.4_Ensure_Legacy_Authorization_ABAC_is_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10.1_Ensure_Kubernetes_Web_UI_is_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10.2_Ensure_that_Alpha_clusters_are_not_used_for_production_workloads" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10.3_Ensure_Pod_Security_Policy_is_Enabled_and_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10.6_Enable_Cloud_Security_Command_Center_Cloud_SCC" selected="true"/>
  </xccdf:Profile>
  <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2_-_Master_Node">
    <xccdf:title xml:lang="en">Level 2 - Master Node</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
        <xhtml:li>acts as defense in depth measure</xhtml:li>
        <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
      </xhtml:ul>
      <xhtml:p>These recommendations may only be recommended for some use cases on the GKE Master Node, such as multi-tenant clusters. They are not always practical recommendations and may adversely impact other aspects of your workload, such as performance or manageability.</xhtml:p>
    </xccdf:description>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Client_certificate_authentication_should_not_be_used_for_users" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_that_a_minimal_audit_policy_is_created" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_that_the_audit_policy_covers_key_security_concerns" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Minimize_access_to_secrets" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Minimize_access_to_create_pods" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_default_service_accounts_are_not_actively_used." selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Minimize_the_admission_of_privileged_containers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Minimize_the_admission_of_root_containers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Minimize_the_admission_of_containers_with_added_capabilities" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.9_Minimize_the_admission_of_containers_with_capabilities_assigned" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.1_Ensure_that_the_CNI_in_use_supports_Network_Policies" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3.2_Ensure_that_all_Namespaces_have_Network_Policies_defined" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.1_Prefer_using_secrets_as_files_over_secrets_as_environment_variables" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4.2_Consider_external_secret_storage" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5.1_Configure_Image_Provenance_using_ImagePolicyWebhook_admission_controller" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.1_Create_administrative_boundaries_between_resources_using_namespaces" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.2_Ensure_that_the_seccomp_profile_is_set_to_dockerdefault_in_your_pod_definitions" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.3_Apply_Security_Context_to_Your_Pods_and_Containers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6.4_The_default_namespace_should_not_be_used" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Image_Vulnerability_Scanning_using_GCR_Container_Analysis_or_a_third_party_provider" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_user_access_to_GCR" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_cluster_access_to_read-only_for_GCR" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Minimize_Container_Registries_to_only_those_approved" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_GKE_clusters_are_not_running_using_the_Compute_Engine_default_service_account" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Prefer_using_dedicated_GCP_Service_Accounts_and_Workload_Identity" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_Kubernetes_Secrets_are_encrypted_using_keys_managed_in_Cloud_KMS" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Ensure_legacy_Compute_Engine_instance_metadata_APIs_are_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.2_Ensure_the_GKE_Metadata_Server_is_Enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.1_Ensure_Container-Optimized_OS_COS_is_used_for_GKE_node_images" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.2_Ensure_Node_Auto-Repair_is_enabled_for_GKE_nodes" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.3_Ensure_Node_Auto-Upgrade_is_enabled_for_GKE_nodes" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.4_When_creating_New_Clusters_-_Automate_GKE_version_management_using_Release_Channels" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.5_Ensure_Shielded_GKE_Nodes_are_Enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.6_Ensure_Integrity_Monitoring_for_Shielded_GKE_Nodes_is_Enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.7_Ensure_Secure_Boot_for_Shielded_GKE_Nodes_is_Enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.1_Enable_VPC_Flow_Logs_and_Intranode_Visibility" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.2_Ensure_use_of_VPC-native_clusters" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.3_Ensure_Master_Authorized_Networks_is_Enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.4_Ensure_clusters_are_created_with_Private_Endpoint_Enabled_and_Public_Access_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.5_Ensure_clusters_are_created_with_Private_Nodes" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.6_Consider_firewalling_GKE_worker_nodes" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.7_Ensure_Network_Policy_is_Enabled_and_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.6.8_Ensure_use_of_Google-managed_SSL_Certificates" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7.1_Ensure_Stackdriver_Kubernetes_Logging_and_Monitoring_is_Enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7.2_Enable_Linux_auditd_logging" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8.1_Ensure_Basic_Authentication_using_static_passwords_is_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8.2_Ensure_authentication_using_Client_Certificates_is_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8.3_Manage_Kubernetes_RBAC_users_with_Google_Groups_for_GKE" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.8.4_Ensure_Legacy_Authorization_ABAC_is_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10.1_Ensure_Kubernetes_Web_UI_is_Disabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10.2_Ensure_that_Alpha_clusters_are_not_used_for_production_workloads" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10.3_Ensure_Pod_Security_Policy_is_Enabled_and_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10.4_Consider_GKE_Sandbox_for_running_untrusted_workloads" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10.5_Ensure_use_of_Binary_Authorization" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.10.6_Enable_Cloud_Security_Command_Center_Cloud_SCC" selected="true"/>
  </xccdf:Profile>
  <Value id="xccdf_org.cisecurity.benchmarks_value_2049955_var" operator="equals" type="string">
    <title>Ensure that the --anonymous-auth argument is set to false</title>
    <description>This value is used in Rule: Ensure that the --anonymous-auth argument is set to false</description>
    <value>anonymous.*enabled.*false}</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_2051142_var" operator="equals" type="string">
    <title>Ensure that the --authorization-mode argument is not set to AlwaysAllow</title>
    <description>This value is used in Rule: Ensure that the --authorization-mode argument is not set to AlwaysAllow</description>
    <value>authorization.*mode.*Webhook</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_2051756_var" operator="equals" type="string">
    <title>Ensure that the --client-ca-file argument is set as appropriate</title>
    <description>This value is used in Rule: Ensure that the --client-ca-file argument is set as appropriate</description>
    <value>x509.*clientCAFile":"\/.</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_2051759_var" operator="equals" type="string">
    <title>Ensure that the --read-only-port argument is set to 0</title>
    <description>This value is used in Rule: Ensure that the --read-only-port argument is set to 0</description>
    <value>readOnlyPort.*:0</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_2051760_var" operator="equals" type="string">
    <title>Ensure that the --streaming-connection-idle-timeout argument is not set to 0</title>
    <description>This value is used in Rule: Ensure that the --streaming-connection-idle-timeout argument is not set to 0</description>
    <value>streamingConnectionIdleTimeout":"[1-9][0-9]*</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_2051761_var" operator="equals" type="string">
    <title>Ensure that the --make-iptables-util-chains argument is set to true</title>
    <description>This value is used in Rule: Ensure that the --make-iptables-util-chains argument is set to true</description>
    <value>makeIPTablesUtilChains":true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_2051766_var" operator="equals" type="string">
    <title>Ensure that the --hostname-override argument is not set</title>
    <description>This value is used in Rule: Ensure that the --hostname-override argument is not set</description>
    <value>^((?!hostnameOverride).)*$</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_2051763_var" operator="equals" type="string">
    <title>Ensure that the --event-qps argument is set to 0 or a level which ensures appropriate event capture</title>
    <description>This value is used in Rule: Ensure that the --event-qps argument is set to 0 or a level which ensures appropriate event capture</description>
    <value>eventRecordQPS":[1-9][0-9]*</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_2051765_var" operator="equals" type="string">
    <title>Ensure that the RotateKubeletServerCertificate argument is set to true</title>
    <description>This value is used in Rule: Ensure that the RotateKubeletServerCertificate argument is set to true</description>
    <value>RotateKubeletServerCertificate":true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745214_var" operator="pattern match" type="string">
    <title>Minimize the admission of privileged containers</title>
    <description>This value is used in Rule: Minimize the admission of privileged containers</description>
    <value>privileged..:false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745216_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers wishing to share the host process ID namespace</title>
    <description>This value is used in Rule: Minimize the admission of containers wishing to share the host process ID namespace</description>
    <value>hostPID..:false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745217_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers wishing to share the host process ID namespace</title>
    <description>This value is used in Rule: Minimize the admission of containers wishing to share the host process ID namespace</description>
    <value>hostPID</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745219_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers wishing to share the host IPC namespace</title>
    <description>This value is used in Rule: Minimize the admission of containers wishing to share the host IPC namespace</description>
    <value>hostIPC..:false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745221_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers wishing to share the host IPC namespace</title>
    <description>This value is used in Rule: Minimize the admission of containers wishing to share the host IPC namespace</description>
    <value>hostIPC</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745223_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers wishing to share the host network namespace</title>
    <description>This value is used in Rule: Minimize the admission of containers wishing to share the host network namespace</description>
    <value>hostNetwork..:false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745225_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers wishing to share the host network namespace</title>
    <description>This value is used in Rule: Minimize the admission of containers wishing to share the host network namespace</description>
    <value>hostNetwork</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745227_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers with allowPrivilegeEscalation</title>
    <description>This value is used in Rule: Minimize the admission of containers with allowPrivilegeEscalation</description>
    <value>allowPrivilegeEscalation...false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745229_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers with allowPrivilegeEscalation</title>
    <description>This value is used in Rule: Minimize the admission of containers with allowPrivilegeEscalation</description>
    <value>allowPrivilegeEscalation</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745231_var" operator="pattern match" type="string">
    <title>Minimize the admission of root containers</title>
    <description>This value is used in Rule: Minimize the admission of root containers</description>
    <value>runAsUser......rule.....MustRunAsNonRoot</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745234_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers with the NET_RAW capability</title>
    <description>This value is used in Rule: Minimize the admission of containers with the NET_RAW capability</description>
    <value>requiredDropCapabilities......NET_RAW</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745236_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers with the NET_RAW capability</title>
    <description>This value is used in Rule: Minimize the admission of containers with the NET_RAW capability</description>
    <value>requiredDropCapabilities......ALL</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745238_var" operator="pattern match" type="string">
    <title>Minimize the admission of containers with added capabilities</title>
    <description>This value is used in Rule: Minimize the admission of containers with added capabilities</description>
    <value>allowedCapabilities</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745244_var" operator="pattern match" type="string">
    <title>Ensure that the seccomp profile is set to docker/default in your pod definitions</title>
    <description>This value is used in Rule: Ensure that the seccomp profile is set to docker/default in your pod definitions</description>
    <value>seccomp.security.alpha.kubernetes.io/pod: docker/default</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745246_var" operator="pattern match" type="string">
    <title>Ensure Image Vulnerability Scanning using GCR Container Analysis or a third party provider</title>
    <description>This value is used in Rule: Ensure Image Vulnerability Scanning using GCR Container Analysis or a third party provider</description>
    <value>Container Scanning API</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745247_var" operator="pattern match" type="string">
    <title>Ensure GKE clusters are not running using the Compute Engine default service account</title>
    <description>This value is used in Rule: Ensure GKE clusters are not running using the Compute Engine default service account</description>
    <value>"default"</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745248_var" operator="pattern match" type="string">
    <title>Ensure Kubernetes Secrets are encrypted using keys managed in Cloud KMS</title>
    <description>This value is used in Rule: Ensure Kubernetes Secrets are encrypted using keys managed in Cloud KMS</description>
    <value>state.*ENCRYPTED</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745249_var" operator="pattern match" type="string">
    <title>Ensure legacy Compute Engine instance metadata APIs are Disabled</title>
    <description>This value is used in Rule: Ensure legacy Compute Engine instance metadata APIs are Disabled</description>
    <value>disable-legacy-endpoints....true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745251_var" operator="pattern match" type="string">
    <title>Ensure the GKE Metadata Server is Enabled</title>
    <description>This value is used in Rule: Ensure the GKE Metadata Server is Enabled</description>
    <value>GKE_METADATA</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745252_var" operator="pattern match" type="string">
    <title>Ensure Container-Optimized OS (COS) is used for GKE node images</title>
    <description>This value is used in Rule: Ensure Container-Optimized OS (COS) is used for GKE node images</description>
    <value>COS</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745253_var" operator="pattern match" type="string">
    <title>Ensure Node Auto-Repair is enabled for GKE nodes</title>
    <description>This value is used in Rule: Ensure Node Auto-Repair is enabled for GKE nodes</description>
    <value>autoRepair...true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745254_var" operator="pattern match" type="string">
    <title>Ensure Node Auto-Upgrade is enabled for GKE nodes</title>
    <description>This value is used in Rule: Ensure Node Auto-Upgrade is enabled for GKE nodes</description>
    <value>autoUpgrade...true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745255_var" operator="pattern match" type="string">
    <title>Ensure Shielded GKE Nodes are Enabled</title>
    <description>This value is used in Rule: Ensure Shielded GKE Nodes are Enabled</description>
    <value>enabled...true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745256_var" operator="pattern match" type="string">
    <title>Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled</title>
    <description>This value is used in Rule: Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled</description>
    <value>enableIntegrityMonitoring...true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745257_var" operator="pattern match" type="string">
    <title>Ensure Secure Boot for Shielded GKE Nodes is Enabled</title>
    <description>This value is used in Rule: Ensure Secure Boot for Shielded GKE Nodes is Enabled</description>
    <value>enableIntegrityMonitoring.*true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745258_var" operator="pattern match" type="string">
    <title>Enable VPC Flow Logs and Intranode Visibility</title>
    <description>This value is used in Rule: Enable VPC Flow Logs and Intranode Visibility</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745259_var" operator="pattern match" type="string">
    <title>Ensure use of VPC-native clusters</title>
    <description>This value is used in Rule: Ensure use of VPC-native clusters</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745260_var" operator="pattern match" type="string">
    <title>Ensure Master Authorized Networks is Enabled</title>
    <description>This value is used in Rule: Ensure Master Authorized Networks is Enabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745261_var" operator="pattern match" type="string">
    <title>Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled</title>
    <description>This value is used in Rule: Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745262_var" operator="pattern match" type="string">
    <title>Ensure clusters are created with Private Nodes</title>
    <description>This value is used in Rule: Ensure clusters are created with Private Nodes</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745263_var" operator="pattern match" type="string">
    <title>Ensure Network Policy is Enabled and set as appropriate</title>
    <description>This value is used in Rule: Ensure Network Policy is Enabled and set as appropriate</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745264_var" operator="pattern match" type="string">
    <title>Ensure Stackdriver Kubernetes Logging and Monitoring is Enabled</title>
    <description>This value is used in Rule: Ensure Stackdriver Kubernetes Logging and Monitoring is Enabled</description>
    <value>logging.googleapis.com/kubernetes</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745265_var" operator="pattern match" type="string">
    <title>Ensure Stackdriver Kubernetes Logging and Monitoring is Enabled</title>
    <description>This value is used in Rule: Ensure Stackdriver Kubernetes Logging and Monitoring is Enabled</description>
    <value>monitoring.googleapis.com/kubernetes</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745266_var" operator="pattern match" type="string">
    <title>Ensure Basic Authentication using static passwords is Disabled</title>
    <description>This value is used in Rule: Ensure Basic Authentication using static passwords is Disabled</description>
    <value>false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745267_var" operator="pattern match" type="string">
    <title>Ensure authentication using Client Certificates is Disabled</title>
    <description>This value is used in Rule: Ensure authentication using Client Certificates is Disabled</description>
    <value>null</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745268_var" operator="pattern match" type="string">
    <title>Ensure Legacy Authorization (ABAC) is Disabled</title>
    <description>This value is used in Rule: Ensure Legacy Authorization (ABAC) is Disabled</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745269_var" operator="pattern match" type="string">
    <title>Ensure Kubernetes Web UI is Disabled</title>
    <description>This value is used in Rule: Ensure Kubernetes Web UI is Disabled</description>
    <value>disabled...true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745270_var" operator="pattern match" type="string">
    <title>Ensure that Alpha clusters are not used for production workloads</title>
    <description>This value is used in Rule: Ensure that Alpha clusters are not used for production workloads</description>
    <value>null</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745271_var" operator="pattern match" type="string">
    <title>Ensure Pod Security Policy is Enabled and set as appropriate</title>
    <description>This value is used in Rule: Ensure Pod Security Policy is Enabled and set as appropriate</description>
    <value>true</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1745272_var" operator="pattern match" type="string">
    <title>Ensure use of Binary Authorization</title>
    <description>This value is used in Rule: Ensure use of Binary Authorization</description>
    <value>true</value>
  </Value>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Control_Plane_Components">
    <xccdf:title xml:lang="en">Control Plane Components</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>
Under the         <xhtml:a href="https://cloud.google.com/files/PCI_DSS_Shared_Responsibility_GCP_v32.pdf">GCP Shared Responsibility Model</xhtml:a>
, Google manages the GKE control plane components for you. The control plane includes the Kubernetes API server, etcd, and a number of controllers. Google is responsible for securing the control plane, though you might be able to configure certain options based on your requirements. Section 3 of this Benchmark addresses these configurations.      </xhtml:p>
      <xhtml:p>You as the end user are responsible for securing your nodes, containers, and Pods and that is what this Benchmark specifically addresses.</xhtml:p>
      <xhtml:p>
        <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/concepts/control-plane-security">This document describes how cluster control plane components are secured in Google Kubernetes</xhtml:a>
      </xhtml:p>
    </xccdf:description>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Control_Plane_Configuration">
    <xccdf:title xml:lang="en">Control Plane Configuration</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations for cluster-wide areas, such as authentication and logging. These recommendations apply to all deployments.</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.1_Authentication_and_Authorization">
      <xccdf:title xml:lang="en">Authentication and Authorization</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1.1_Client_certificate_authentication_should_not_be_used_for_users" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Client certificate authentication should not be used for users</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Kubernetes provides the option to use client certificates for user authentication.  However as there is no way to revoke these certificates when a user leaves an organization or loses their credential, they are not suitable for this purpose.</xhtml:p>
          <xhtml:p>It is not possible to fully disable client certificate use within a cluster as it is used for component to component authentication.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Establish an Access Revoking Process" urn="urn:cisecurity.org:controls:8.0:6:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Establish Process for Revoking Access" urn="urn:cisecurity.org:controls:7.0:16:7">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
          <notes:notes xml:lang="en">
            <xhtml:p>The lack of certificate revocation was flagged up as a high risk issue in the recent Kubernetes security audit. Without this feature, client certificate authentication is not suitable for end users.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>With any authentication mechanism the ability to revoke credentials if they are compromised or no longer required, is a key control.  Kubernetes client certificate authentication does not allow for this due to a lack of support for certificate revocation.</xhtml:p>
          <xhtml:p>See also Recommendation 6.8.2 for GKE specifically.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Alternative mechanisms provided by Kubernetes such as the use of OIDC should be implemented in place of client certificates.</xhtml:p>
              <xhtml:p>You can remediate the availability of client certificates in your GKE cluster. See Recommendation 6.8.2.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>External mechanisms for authentication generally require additional software to be deployed.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2.2_Logging">
      <xccdf:title xml:lang="en">Logging</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.1_Ensure_that_a_minimal_audit_policy_is_created" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that a minimal audit policy is created</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Kubernetes can audit the details of requests made to the API server.  The             <xhtml:span class="inline_block">--audit-policy-file</xhtml:span>
 flag must be set for this logging to be enabled.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Logging is an important detective control for all systems, to detect potential unauthorised access.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/debug-application-cluster/audit/</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>This control cannot be modified in GKE.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Audit logs will be created on the master nodes, which will consume disk space. Care should be taken to avoid generating too large volumes of log information as this could impact the available of the cluster nodes.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2.2_Ensure_that_the_audit_policy_covers_key_security_concerns" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the audit policy covers key security concerns</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Ensure that the audit policy created for the cluster covers key security concerns.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Enforce Detail Logging for Access or Changes to Sensitive Data" urn="urn:cisecurity.org:controls:7.0:14:9">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Security audit logs should cover access and modification of key resources in the cluster, to enable them to form an effective part of a security environment.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://github.com/k8scop/k8s-security-dashboard/blob/master/configs/kubernetes/adv-audit.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/debug-application-cluster/audit/#audit-policy</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/falcosecurity/falco/blob/master/examples/k8s_audit_config/audit-policy.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/blob/master/cluster/gce/gci/configure-helper.sh#L735</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>This control cannot be modified in GKE.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Increasing audit logging will consume resources on the nodes or other log destination.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Worker_Nodes">
    <xccdf:title xml:lang="en">Worker Nodes</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section consists of security recommendations for the components that run on GKE worker nodes.</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.1_Worker_Node_Configuration_Files">
      <xccdf:title xml:lang="en">Worker Node Configuration Files</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section covers recommendations for configuration files on the worker nodes.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Ensure_that_the_proxy_kubeconfig_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the proxy kubeconfig file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
If             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 is running, and if it is using a file-based kubeconfig file, ensure that the proxy kubeconfig file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 kubeconfig file controls various parameters of the             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.          </xhtml:p>
          <xhtml:p>
It is possible to run             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 with the kubeconfig parameters configured as a Kubernetes ConfigMap instead of a file. In this case, there is no proxy kubeconfig file.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kube-proxy/</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the below command (based on the file location on your system) on the each worker
node. For example,</xhtml:p>
              <xhtml:code class="code_block">chmod 644 &lt;proxy kubeconfig file&gt;
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745204"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.2_Ensure_that_the_proxy_kubeconfig_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the proxy kubeconfig file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
If             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 is running, ensure that the file ownership of its kubeconfig file is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The kubeconfig file for             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 controls various parameters for the             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kube-proxy/</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the below command (based on the file location on your system) on the each worker node. For example,</xhtml:p>
              <xhtml:code class="code_block">chown root:root &lt;proxy kubeconfig file&gt;
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745205"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.3_Ensure_that_the_kubelet_configuration_file_has_permissions_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the kubelet configuration file has permissions set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that if the kubelet refers to a configuration file with the             <xhtml:span class="inline_block">--config</xhtml:span>
 argument, that file has permissions of 644 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The kubelet reads various parameters, including security settings, from a config file specified by the             <xhtml:span class="inline_block">--config</xhtml:span>
 argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command (using the config file location identied in the Audit step)</xhtml:p>
              <xhtml:code class="code_block">chmod 644 /var/lib/kubelet/config.yaml
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745206"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.4_Ensure_that_the_kubelet_configuration_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the kubelet configuration file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that if the kubelet refers to a configuration file with the             <xhtml:span class="inline_block">--config</xhtml:span>
 argument, that file is owned by root:root.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The kubelet reads various parameters, including security settings, from a config file specified by the             <xhtml:span class="inline_block">--config</xhtml:span>
 argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be owned by root:root.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/cis-benchmarks</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Run the following command (using the config file location identied in the Audit step)</xhtml:p>
              <xhtml:code class="code_block">chown root:root /etc/kubernetes/kubelet.conf
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745207"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.2_Kubelet">
      <xccdf:title xml:lang="en">Kubelet</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations for kubelet configuration.</xhtml:p>
        <xhtml:p>Kubelet settings may be configured using arguments on the running kubelet executable, or they may be taken from a Kubelet config file. If both are specified, the executable argument takes precedence.</xhtml:p>
        <xhtml:p>To find the Kubelet config file, run the following command:</xhtml:p>
        <xhtml:code class="code_block">ps -ef | grep kubelet | grep config
</xhtml:code>
        <xhtml:p>
If the           <xhtml:span class="inline_block">--config</xhtml:span>
 argument is present, this gives the location of the Kubelet config file. This config file could be in JSON or YAML format depending on your distribution.        </xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_that_the_--anonymous-auth_argument_is_set_to_false" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --anonymous-auth argument is set to false</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable anonymous requests to the Kubelet server.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:control title="Controlled Access Based on the Need to Know" urn="urn:cisecurity.org:controls:7.0:14"/>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the Kubelet server. You should rely on authentication to authorize access and disallow anonymous requests.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet-authentication</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using a Kubelet config file, edit the file to set                 <xhtml:span class="inline_block">authentication: anonymous: enabled</xhtml:span>
 to                 <xhtml:span class="inline_block">false</xhtml:span>
.              </xhtml:p>
              <xhtml:p>
If using executable arguments, edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and set the below parameter in                 <xhtml:span class="inline_block">KUBELET_SYSTEM_PODS_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:code class="code_block">--anonymous-auth=false
</xhtml:code>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">authentication... anonymous.*enabled.*false}</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Anonymous requests will be rejected.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_2049955_var"/>
            <check-content-ref href="sce/kubelet_test.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --authorization-mode argument is not set to AlwaysAllow</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not allow all requests. Enable explicit authorization.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:control title="Controlled Access Based on the Need to Know" urn="urn:cisecurity.org:controls:7.0:14"/>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:6.0">
              <controls:control title="Controlled Access Based on the Need to Know" urn="urn:cisecurity.org:controls:6.0:14"/>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubelets, by default, allow all authenticated requests (even anonymous ones) without needing explicit authorization checks from the apiserver. You should restrict this behavior and only allow explicitly authorized requests.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet-authentication-authorization/#kubelet-authentication</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using a Kubelet config file, edit the file to set                 <xhtml:span class="inline_block">authorization: mode</xhtml:span>
 to                 <xhtml:span class="inline_block">Webhook</xhtml:span>
.              </xhtml:p>
              <xhtml:p>
If using executable arguments, edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and set the below parameter in                 <xhtml:span class="inline_block">KUBELET_AUTHZ_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:code class="code_block">--authorization-mode=Webhook
</xhtml:code>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">authorization mode "Webhook"</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Unauthorized requests will be denied.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_2051142_var"/>
            <check-content-ref href="sce/kubelet_test.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.3_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --client-ca-file argument is set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable Kubelet authentication using certificates.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet’s port-forwarding functionality. These connections terminate at the kubelet’s HTTPS endpoint. By default, the apiserver does not verify the kubelet’s serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks. Enabling Kubelet certificate authentication ensures that the apiserver could authenticate the Kubelet before submitting any requests.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using a Kubelet config file, edit the file to set                 <xhtml:span class="inline_block">authentication: x509: clientCAFile</xhtml:span>
 to the location of the client CA file.              </xhtml:p>
              <xhtml:p>
If using command line arguments, edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and set the below parameter in                 <xhtml:span class="inline_block">KUBELET_AUTHZ_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:code class="code_block">--client-ca-file=&lt;path/to/client-ca-file&gt;
</xhtml:code>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">clientCAFile</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You require TLS to be configured on apiserver as well as kubelets.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_2051756_var"/>
            <check-content-ref href="sce/kubelet_test.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.4_Ensure_that_the_--read-only-port_argument_is_set_to_0" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --read-only-port argument is set to 0</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable the read-only port.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The Kubelet process provides a read-only API in addition to the main Kubelet API. Unauthenticated access is provided to this read-only API which could possibly retrieve potentially sensitive information about the cluster.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using a Kubelet config file, edit the file to set                 <xhtml:span class="inline_block">readOnlyPort</xhtml:span>
 to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:p>
              <xhtml:p>
If using command line arguments, edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and set the below parameter in                 <xhtml:span class="inline_block">KUBELET_SYSTEM_PODS_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:code class="code_block">--read-only-port=0
</xhtml:code>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">readOnlyPort</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Removal of the read-only port will require that any service which made use of it will need to be re-configured to use the main Kubelet API.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_2051759_var"/>
            <check-content-ref href="sce/kubelet_test.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.5_Ensure_that_the_--streaming-connection-idle-timeout_argument_is_not_set_to_0" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --streaming-connection-idle-timeout argument is not set to 0</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not disable timeouts on streaming connections.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Enable Anti-Exploitation Features" urn="urn:cisecurity.org:controls:8.0:10:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:7.0:9"/>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Setting idle timeouts ensures that you are protected against Denial-of-Service attacks, inactive connections and running out of ephemeral ports.</xhtml:p>
          <xhtml:p>
            <xhtml:strong>Note:</xhtml:strong>
 By default,             <xhtml:span class="inline_block">--streaming-connection-idle-timeout</xhtml:span>
 is set to 4 hours which might be too high for your environment. Setting this as appropriate would additionally ensure that such streaming connections are timed out after serving legitimate use cases.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/18552</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using a Kubelet config file, edit the file to set                 <xhtml:span class="inline_block">streamingConnectionIdleTimeout</xhtml:span>
 to a value other than 0.              </xhtml:p>
              <xhtml:p>
If using command line arguments, edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and set the below parameter in                 <xhtml:span class="inline_block">KUBELET_SYSTEM_PODS_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:code class="code_block">--streaming-connection-idle-timeout=5m
</xhtml:code>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">streamingConnectionIdleTimeout</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Long-lived connections could be interrupted.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_2051760_var"/>
            <check-content-ref href="sce/kubelet_test.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.6_Ensure_that_the_--protect-kernel-defaults_argument_is_set_to_true" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --protect-kernel-defaults argument is set to true</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Protect tuned kernel parameters from overriding kubelet default kernel parameter values.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using a Kubelet config file, edit the file to set                 <xhtml:span class="inline_block">protectKernelDefaults: true</xhtml:span>
.              </xhtml:p>
              <xhtml:p>
If using command line arguments, edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and set the below parameter in                 <xhtml:span class="inline_block">KUBELET_SYSTEM_PODS_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:code class="code_block">--protect-kernel-defaults=true
</xhtml:code>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">protectKernelDefaults</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You would have to re-tune kernel parameters to match kubelet parameters.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="OR">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745224"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745226"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.7_Ensure_that_the_--make-iptables-util-chains_argument_is_set_to_true" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --make-iptables-util-chains argument is set to true</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Allow Kubelet to manage iptables.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Allowlist Authorized Software" urn="urn:cisecurity.org:controls:8.0:2:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:7.0:9"/>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubelets can automatically manage the required changes to iptables based on how you choose your networking options for the pods. It is recommended to let kubelets manage the changes to iptables. This ensures that the iptables configuration remains in sync with pods networking configuration. Manually configuring iptables with dynamic pod network configuration changes might hamper the communication between pods/containers and to the outside world. You might have iptables rules too restrictive or too open.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/2/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using a Kubelet config file, edit the file to set                 <xhtml:span class="inline_block">makeIPTablesUtilChains: true</xhtml:span>
.              </xhtml:p>
              <xhtml:p>
If using command line arguments, edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and remove the                 <xhtml:span class="inline_block">--make-iptables-util-chains</xhtml:span>
 argument from the                 <xhtml:span class="inline_block">KUBELET_SYSTEM_PODS_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">makeIPTablesUtilChains</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Kubelet would manage the iptables on the system and keep it in sync. If you are using any other iptables management solution, then there might be some conflicts.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_2051761_var"/>
            <check-content-ref href="sce/kubelet_test.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.8_Ensure_that_the_--hostname-override_argument_is_not_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --hostname-override argument is not set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not override node hostnames.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Securely Manage Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:12:3">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Manage Network Infrastructure Through a Dedicated Network" urn="urn:cisecurity.org:controls:7.0:11:7">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Overriding hostnames could potentially break TLS setup between the kubelet and the apiserver. Additionally, with overridden hostnames, it becomes increasingly difficult to associate logs with a particular node and process them for security analytics. Hence, you should setup your kubelet nodes with resolvable FQDNs and avoid overriding the hostnames with IPs.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/22063</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
Edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and remove the                 <xhtml:span class="inline_block">--hostname-override</xhtml:span>
 argument from the                 <xhtml:span class="inline_block">KUBELET_SYSTEM_PODS_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">hostnameOverride</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some cloud providers may require this flag to ensure that hostname matches names issued by the cloud provider.  In these environments, this recommendation should not apply.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_2051766_var"/>
            <check-content-ref href="sce/kubelet_test.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.9_Ensure_that_the_--event-qps_argument_is_set_to_0_or_a_level_which_ensures_appropriate_event_capture" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --event-qps argument is set to 0 or a level which ensures appropriate event capture</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Security relevant information should be captured.  The             <xhtml:span class="inline_block">--event-qps</xhtml:span>
 flag on the Kubelet can be used to limit the rate at which events are gathered.  Setting this too low could result in relevant events not being logged, however the unlimited setting of             <xhtml:span class="inline_block">0</xhtml:span>
 could result in a denial of service on the kubelet.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>It is important to capture all events and not restrict event creation. Events are an important source of security information and analytics that ensure that your environment is consistently monitored using the event data.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/apis/kubeletconfig/v1beta1/types.go</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using a Kubelet config file, edit the file to set                 <xhtml:span class="inline_block">eventRecordQPS:</xhtml:span>
 to an appropriate level.              </xhtml:p>
              <xhtml:p>
If using command line arguments, edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and set the below parameter in                 <xhtml:span class="inline_block">KUBELET_SYSTEM_PODS_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">eventRecordQPS</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Setting this parameter to                   <xhtml:span class="inline_block">0</xhtml:span>
 could result in a denial of service condition due to excessive events being created.  The cluster's event processing and storage systems should be scaled to handle expected event loads.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_2051763_var"/>
            <check-content-ref href="sce/kubelet_test.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.10_Ensure_that_the_--tls-cert-file_and_--tls-private-key-file_arguments_are_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Setup TLS connection on the Kubelets.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubelet communication contains sensitive parameters that should remain encrypted in transit. Configure the Kubelets to serve only HTTPS traffic.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">http://rootsquash.com/2016/05/10/securing-the-kubernetes-api/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kelseyhightower/docker-kubernetes-tls-guide</xccdf:ident>
        <xccdf:ident system="URL">https://jvns.ca/blog/2017/08/05/how-kubernetes-certificates-work/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using a Kubelet config file, edit the file to set                 <xhtml:span class="inline_block">tlsCertFile</xhtml:span>
 to the location of the certificate file to use to identify this Kubelet, and                 <xhtml:span class="inline_block">tlsPrivateKeyFile</xhtml:span>
 to the location of the corresponding private key file.              </xhtml:p>
              <xhtml:p>
If using command line arguments, edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and set the below parameters in                 <xhtml:span class="inline_block">KUBELET_CERTIFICATE_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:code class="code_block">--tls-cert-file=&lt;path/to/tls-certificate-file&gt;  --tls-private-key-file=&lt;path/to/tls-key-file&gt;
</xhtml:code>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">tlsCertFile and tlsPrivateKeyFile</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>TLS and client certificate authentication must be configured for your Kubernetes cluster deployment.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745239"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745240"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.11_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --rotate-certificates argument is not set to false</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable kubelet client certificate rotation.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">--rotate-certificates</xhtml:span>
 setting causes the kubelet to rotate its client certificates by creating new CSRs as its existing credentials expire. This automated periodic rotation ensures that the there is no downtime due to expired certificates and thus addressing availability in the CIA security triad.          </xhtml:p>
          <xhtml:p>
            <xhtml:strong>Note:</xhtml:strong>
 This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.          </xhtml:p>
          <xhtml:p>
            <xhtml:strong>Note:</xhtml:strong>
 This feature also require the             <xhtml:span class="inline_block">RotateKubeletClientCertificate</xhtml:span>
 feature gate to be enabled (which is the default since Kubernetes v1.7)          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/41912</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/#kubelet-configuration</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/imported/release/notes/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/feature-gates/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using a Kubelet config file, edit the file to add the line                 <xhtml:span class="inline_block">rotateCertificates: true</xhtml:span>
 or remove it altogether to use the default value.              </xhtml:p>
              <xhtml:p>
If using command line arguments, edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and remove                 <xhtml:span class="inline_block">--rotate-certificates=false</xhtml:span>
 argument from the                 <xhtml:span class="inline_block">KUBELET_CERTIFICATE_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">rotateCertificates</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.12_Ensure_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the RotateKubeletServerCertificate argument is set to true</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable kubelet server certificate rotation.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">RotateKubeletServerCertificate</xhtml:span>
 causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.          </xhtml:p>
          <xhtml:p>Note: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/45059</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kubelet-tls-bootstrapping/#kubelet-configuration</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
                <xhtml:strong>Remediation Method 1:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
Edit the kubelet service file                 <xhtml:span class="inline_block">/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</xhtml:span>
 on each worker node and set the below parameter in                 <xhtml:span class="inline_block">KUBELET_CERTIFICATE_ARGS</xhtml:span>
 variable.              </xhtml:p>
              <xhtml:code class="code_block">--feature-gates=rotateKubeletServerCertificate=true
</xhtml:code>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>Remediation Method 2:</xhtml:strong>
              </xhtml:p>
              <xhtml:p>
If using the api configz endpoint consider searching for the status of                 <xhtml:span class="inline_block">rotateKubeletServerCertificate</xhtml:span>
 by extracting the live configuration from the nodes running kubelet.              </xhtml:p>
              <xhtml:p>
**See detailed step-by-step configmap procedures in                 <xhtml:a href="https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node's Kubelet in a Live Cluster</xhtml:a>
, and then rerun the curl statement from audit process to check for kubelet configuration changes              </xhtml:p>
              <xhtml:code class="code_block">
kubectl proxy --port=8001 &amp;                <br/>
                <br/>
export HOSTNAME_PORT=localhost:8001 (example host and port number)                <br/>
export NODE_NAME=gke-cluster-1-default-pool-8f187292-f0dm (example node name from "kubectl get nodes")                <br/>
                <br/>
curl -sSL "http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz"
              </xhtml:code>
              <xhtml:p>
                <xhtml:strong>For all three remediations:</xhtml:strong>

Based on your system, restart the                 <xhtml:span class="inline_block">kubelet</xhtml:span>
 service and check status              </xhtml:p>
              <xhtml:code class="code_block">
systemctl daemon-reload                <br/>
systemctl restart kubelet.service
systemctl status kubelet -l
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://open-scap.org/page/SCE">
            <check-import import-name="stdout"/>
            <check-export export-name="XCCDF_VALUE_REGEX" value-id="xccdf_org.cisecurity.benchmarks_value_2051765_var"/>
            <check-content-ref href="sce/kubelet_test.sh"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Policies">
    <xccdf:title xml:lang="en">Policies</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations for various Kubernetes policies which are important to the security of the environment.</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.1_RBAC_and_Service_Accounts">
      <xccdf:title xml:lang="en">RBAC and Service Accounts</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the cluster-admin role is only used where required</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
The RBAC role             <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 provides wide-ranging powers over the environment and should be used only where and when needed.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Kubernetes provides a set of default roles where RBAC is used. Some of these roles such as             <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 provide wide-ranging privileges which should only be applied where absolutely necessary. Roles such as             <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 allow super-user access to perform any action on any resource. When used in a             <xhtml:span class="inline_block">ClusterRoleBinding</xhtml:span>
, it gives full control over every resource in the cluster and in all namespaces. When used in a             <xhtml:span class="inline_block">RoleBinding</xhtml:span>
, it gives full control over every resource in the rolebinding's namespace, including the namespace itself.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/authorization/rbac/#user-facing-roles</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Identify all clusterrolebindings to the cluster-admin role. Check if they are used and if they need this role or if they could use a role with fewer privileges.</xhtml:p>
              <xhtml:p>Where possible, first bind users to a lower privileged role and then remove the clusterrolebinding to the cluster-admin role :</xhtml:p>
              <xhtml:code class="code_block">kubectl delete clusterrolebinding [name]
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Care should be taken before removing any                   <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 from the environment to ensure they were not required for operation of the cluster. Specifically, modifications should not be made to                   <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 with the                   <xhtml:span class="inline_block">system:</xhtml:span>
 prefix as they are required for the operation of system components.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Minimize_access_to_secrets" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize access to secrets</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster.  Access to these secrets should be restricted to the smallest possible group of users to reduce the risk of privilege escalation.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Centralize Access Control" urn="urn:cisecurity.org:controls:8.0:6:7">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:control title="Controlled Access Based on the Need to Know" urn="urn:cisecurity.org:controls:7.0:14"/>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Inappropriate access to secrets stored within the Kubernetes cluster can allow for an attacker to gain additional access to the Kubernetes cluster or external resources whose credentials are stored as secrets.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Where possible, remove                 <xhtml:span class="inline_block">get</xhtml:span>
,                 <xhtml:span class="inline_block">list</xhtml:span>
 and                 <xhtml:span class="inline_block">watch</xhtml:span>
 access to                 <xhtml:span class="inline_block">secret</xhtml:span>
 objects in the cluster.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Care should be taken not to remove access to secrets to system components which require this for their operation</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize wildcard use in Roles and ClusterRoles</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Kubernetes Roles and ClusterRoles provide access to resources based on sets of objects and actions that can be taken on those objects.  It is possible to set either of these to be the wildcard "*" which matches all items.</xhtml:p>
          <xhtml:p>Use of wildcards is not optimal from a security perspective as it may allow for inadvertent access to be granted when new resources are added to the Kubernetes API either as CRDs or in later versions of the product.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The principle of least privilege recommends that users are provided only the access required for their role and nothing more.  The use of wildcard rights grants is likely to provide excessive rights to the Kubernetes API.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Where possible replace any use of wildcards in clusterroles and roles with specific objects or actions.</xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.4_Minimize_access_to_create_pods" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize access to create pods</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The ability to create pods in a namespace can provide a number of opportunities for privilege escalation, such as assigning privileged service accounts to these pods or mounting hostPaths with access to sensitive data (unless Pod Security Policies are implemented to restrict this access)</xhtml:p>
          <xhtml:p>As such, access to create new pods should be restricted to the smallest possible group of users.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The ability to create pods in a cluster opens up possibilities for privilege escalation and should be restricted, where possible.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Where possible, remove                 <xhtml:span class="inline_block">create</xhtml:span>
 access to                 <xhtml:span class="inline_block">pod</xhtml:span>
 objects in the cluster.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Care should be taken not to remove access to pods to system components which require this for their operation</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_default_service_accounts_are_not_actively_used." role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that default service accounts are not actively used.</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">default</xhtml:span>
 service account should not be used to ensure that rights granted to applications can be more easily audited and reviewed.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:8.0:5:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Respond</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Disable Dormant Accounts" urn="urn:cisecurity.org:controls:7.0:16:9">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Respond</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Kubernetes provides a             <xhtml:span class="inline_block">default</xhtml:span>
 service account which is used by cluster workloads where no specific service account is assigned to the pod.          </xhtml:p>
          <xhtml:p>Where access to the Kubernetes API from a pod is required, a specific service account should be created for that pod, and rights granted to that service account.</xhtml:p>
          <xhtml:p>The default service account should be configured such that it does not provide a service account token and does not have any explicit rights assignments.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Create explicit service accounts wherever a Kubernetes workload requires specific access to the Kubernetes API server.</xhtml:p>
              <xhtml:p>Modify the configuration of each default service account to include this value</xhtml:p>
              <xhtml:code class="code_block">automountServiceAccountToken: false
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>All workloads which require access to the Kubernetes API will require an explicit service account to be created.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that Service Account Tokens are only mounted where necessary</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Service accounts tokens should not be mounted in pods except where the workload running in the pod explicitly needs to communicate with the API server</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Mounting service account tokens inside pods can provide an avenue for privilege escalation attacks where an attacker is able to compromise a single pod in the cluster.</xhtml:p>
          <xhtml:p>Avoiding mounting these tokens removes this attack avenue.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Modify the definition of pods and service accounts which do not need to mount service account tokens to disable it.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Pods mounted without service account tokens will not be able to communicate with the API server, except where the resource is available to unauthenticated principals.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.2_Pod_Security_Policies">
      <xccdf:title xml:lang="en">Pod Security Policies</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>A Pod Security Policy (PSP) is a cluster-level resource that controls security settings for pods. Your cluster may have multiple PSPs. You can query PSPs with the following command:</xhtml:p>
        <xhtml:code class="code_block">kubectl get psp
</xhtml:code>
        <xhtml:p>PodSecurityPolicies are used in conjunction with the PodSecurityPolicy admission controller plugin.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Minimize_the_admission_of_privileged_containers" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Minimize the admission of privileged containers</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Do not generally permit containers to be run with the             <xhtml:span class="inline_block">securityContext.privileged</xhtml:span>
 flag set to             <xhtml:span class="inline_block">true</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:6.0">
              <controls:safeguard title="Minimize And Sparingly Use Administrative Privileges" urn="urn:cisecurity.org:controls:6.0:5:1">
                <controls:implementation_groups/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Privileged containers have access to all Linux Kernel capabilities and devices. A container running with full privileges can do almost everything that the host can do. This flag exists to allow special use-cases, like manipulating the network stack and accessing devices.</xhtml:p>
          <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit privileged containers.</xhtml:p>
          <xhtml:p>If you need to run privileged containers, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a PSP as described in the Kubernetes documentation, ensuring that the                 <xhtml:span class="inline_block">.spec.privileged</xhtml:span>
 field is omitted or set to                 <xhtml:span class="inline_block">false</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Pods defined with                   <xhtml:span class="inline_block">spec.containers[].securityContext.privileged: true</xhtml:span>
 will not be permitted.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745214" value-id="xccdf_org.cisecurity.benchmarks_value_1745214_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745214"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers wishing to share the host process ID namespace</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Do not generally permit containers to be run with the             <xhtml:span class="inline_block">hostPID</xhtml:span>
 flag set to true.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Perform Application Layer Filtering" urn="urn:cisecurity.org:controls:8.0:13:10">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A container running in the host's PID namespace can inspect processes running outside the container. If the container also has access to ptrace capabilities this can be used to escalate privileges outside of the container.</xhtml:p>
          <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host PID namespace.</xhtml:p>
          <xhtml:p>If you need to run containers which require hostPID, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a PSP as described in the Kubernetes documentation, ensuring that the                 <xhtml:span class="inline_block">.spec.hostPID</xhtml:span>
 field is omitted or set to false.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Pods defined with                   <xhtml:span class="inline_block">spec.hostPID: true</xhtml:span>
 will not be permitted unless they are run under a specific PSP.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="OR">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745216" value-id="xccdf_org.cisecurity.benchmarks_value_1745216_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745216"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745217" value-id="xccdf_org.cisecurity.benchmarks_value_1745217_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745217"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers wishing to share the host IPC namespace</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Do not generally permit containers to be run with the             <xhtml:span class="inline_block">hostIPC</xhtml:span>
 flag set to true.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Segment Data Processing and Storage Based on Sensitivity" urn="urn:cisecurity.org:controls:8.0:3:12">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Segment the Network Based on Sensitivity" urn="urn:cisecurity.org:controls:7.0:14:1">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A container running in the host's IPC namespace can use IPC to interact with processes outside the container.</xhtml:p>
          <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host IPC namespace.</xhtml:p>
          <xhtml:p>If you have a requirement to containers which require hostIPC, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/12" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a PSP as described in the Kubernetes documentation, ensuring that the                 <xhtml:span class="inline_block">.spec.hostIPC</xhtml:span>
 field is omitted or set to false.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Pods defined with                   <xhtml:span class="inline_block">spec.hostIPC: true</xhtml:span>
 will not be permitted unless they are run under a specific PSP.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="OR">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745219" value-id="xccdf_org.cisecurity.benchmarks_value_1745219_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745219"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745221" value-id="xccdf_org.cisecurity.benchmarks_value_1745221_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745221"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers wishing to share the host network namespace</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Do not generally permit containers to be run with the             <xhtml:span class="inline_block">hostNetwork</xhtml:span>
 flag set to true.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Segment Data Processing and Storage Based on Sensitivity" urn="urn:cisecurity.org:controls:8.0:3:12">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Segment the Network Based on Sensitivity" urn="urn:cisecurity.org:controls:7.0:14:1">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A container running in the host's network namespace could access the local loopback device, and could access network traffic to and from other pods.</xhtml:p>
          <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host network namespace.</xhtml:p>
          <xhtml:p>If you have need to run containers which require hostNetwork, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/12" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a PSP as described in the Kubernetes documentation, ensuring that the                 <xhtml:span class="inline_block">.spec.hostNetwork</xhtml:span>
 field is omitted or set to false.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Pods defined with                   <xhtml:span class="inline_block">spec.hostNetwork: true</xhtml:span>
 will not be permitted unless they are run under a specific PSP.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="OR">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745223" value-id="xccdf_org.cisecurity.benchmarks_value_1745223_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745223"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745225" value-id="xccdf_org.cisecurity.benchmarks_value_1745225_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745225"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers with allowPrivilegeEscalation</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Do not generally permit containers to be run with the             <xhtml:span class="inline_block">allowPrivilegeEscalation</xhtml:span>
 flag set to true.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:6.0">
              <controls:safeguard title="Minimize And Sparingly Use Administrative Privileges" urn="urn:cisecurity.org:controls:6.0:5:1">
                <controls:implementation_groups/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
A container running with the             <xhtml:span class="inline_block">allowPrivilegeEscalation</xhtml:span>
 flag set to             <xhtml:span class="inline_block">true</xhtml:span>
 may have processes that can gain more privileges than their parent.          </xhtml:p>
          <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to allow privilege escalation. The option exists (and is defaulted to true) to permit setuid binaries to run.</xhtml:p>
          <xhtml:p>If you have need to run containers which use setuid binaries or require privilege escalation, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a PSP as described in the Kubernetes documentation, ensuring that the                 <xhtml:span class="inline_block">.spec.allowPrivilegeEscalation</xhtml:span>
 field is omitted or set to false.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Pods defined with                   <xhtml:span class="inline_block">spec.allowPrivilegeEscalation: true</xhtml:span>
 will not be permitted unless they are run under a specific PSP.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="OR">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745227" value-id="xccdf_org.cisecurity.benchmarks_value_1745227_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745227"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745229" value-id="xccdf_org.cisecurity.benchmarks_value_1745229_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745229"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Minimize_the_admission_of_root_containers" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Minimize the admission of root containers</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not generally permit containers to be run as the root user.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:6.0">
              <controls:safeguard title="Minimize And Sparingly Use Administrative Privileges" urn="urn:cisecurity.org:controls:6.0:5:1">
                <controls:implementation_groups/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Containers may run as any Linux user.  Containers which run as the root user, whilst constrained by Container Runtime security features still have a escalated likelihood of container breakout.</xhtml:p>
          <xhtml:p>Ideally, all containers should run as a defined non-UID 0 user.</xhtml:p>
          <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which does not permit root users in a container.</xhtml:p>
          <xhtml:p>If you need to run root containers, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a PSP as described in the Kubernetes documentation, ensuring that the                 <xhtml:span class="inline_block">.spec.runAsUser.rule</xhtml:span>
 is set to either                 <xhtml:span class="inline_block">MustRunAsNonRoot</xhtml:span>
 or                 <xhtml:span class="inline_block">MustRunAs</xhtml:span>
 with the range of UIDs not including 0.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Pods with containers which run as the root user will not be permitted.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745231" value-id="xccdf_org.cisecurity.benchmarks_value_1745231_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745231"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers with the NET_RAW capability</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not generally permit containers with the potentially dangerous NET_RAW capability.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:6.0">
              <controls:safeguard title="Minimize And Sparingly Use Administrative Privileges" urn="urn:cisecurity.org:controls:6.0:5:1">
                <controls:implementation_groups/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Containers run with a default set of capabilities as assigned by the Container Runtime.  By default this can include potentially dangerous capabilities.  With Docker as the container runtime the NET_RAW capability is enabled which may be misused by malicious containers.</xhtml:p>
          <xhtml:p>Ideally, all containers should drop this capability.</xhtml:p>
          <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which prevents containers with the NET_RAW capability from launching.</xhtml:p>
          <xhtml:p>If you need to run containers with this capability, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
        <xccdf:ident system="URL">https://www.nccgroup.trust/uk/our-research/abusing-privileged-and-unprivileged-linux-containers/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a PSP as described in the Kubernetes documentation, ensuring that the                 <xhtml:span class="inline_block">.spec.requiredDropCapabilities</xhtml:span>
 is set to include either                 <xhtml:span class="inline_block">NET_RAW</xhtml:span>
 or                 <xhtml:span class="inline_block">ALL</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Pods with containers which run with the NET_RAW capability will not be permitted.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="OR">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745234" value-id="xccdf_org.cisecurity.benchmarks_value_1745234_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745234"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745236" value-id="xccdf_org.cisecurity.benchmarks_value_1745236_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745236"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Minimize_the_admission_of_containers_with_added_capabilities" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers with added capabilities</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not generally permit containers with capabilities assigned beyond the default set.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Containers run with a default set of capabilities as assigned by the Container Runtime. Capabilities outside this set can be added to containers which could expose them to risks of container breakout attacks.</xhtml:p>
          <xhtml:p>There should be at least one PodSecurityPolicy (PSP) defined which prevents containers with capabilities beyond the default set from launching.</xhtml:p>
          <xhtml:p>If you need to run containers with additional capabilities, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
        <xccdf:ident system="URL">https://www.nccgroup.trust/uk/our-research/abusing-privileged-and-unprivileged-linux-containers/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Ensure that                 <xhtml:span class="inline_block">allowedCapabilities</xhtml:span>
 is not present in PSPs for the cluster unless it is set to an empty array.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Pods with containers which require capabilities outwith the default set will not be permitted.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745238" value-id="xccdf_org.cisecurity.benchmarks_value_1745238_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745238"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.9_Minimize_the_admission_of_containers_with_capabilities_assigned" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers with capabilities assigned</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not generally permit containers with capabilities</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Containers run with a default set of capabilities as assigned by the Container Runtime. Capabilities are parts of the rights generally granted on a Linux system to the root user.</xhtml:p>
          <xhtml:p>In many cases applications running in containers do not require any capabilities to operate, so from the perspective of the principal of least privilege use of capabilities should be minimized.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
        <xccdf:ident system="URL">https://www.nccgroup.trust/uk/our-research/abusing-privileged-and-unprivileged-linux-containers/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Review the use of capabilites in applications runnning on your cluster.  Where a namespace contains applicaions which do not require any Linux capabities to operate consider adding a PSP which forbids the admission of containers which do not drop all capabilities.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Pods with containers require capabilities to operate will not be permitted.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.3_Network_Policies_and_CNI">
      <xccdf:title xml:lang="en">Network Policies and CNI</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3.1_Ensure_that_the_CNI_in_use_supports_Network_Policies" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the CNI in use supports Network Policies</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>There are a variety of CNI plugins available for Kubernetes. If the CNI in use does not support Network Policies it may not be possible to effectively restrict traffic in the cluster.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Implement Application Firewalls" urn="urn:cisecurity.org:controls:7.0:9:5">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Only Use Up-to-date And Trusted Third-Party Components" urn="urn:cisecurity.org:controls:7.0:18:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
          <notes:notes xml:lang="en">
            <xhtml:p>One example here is Flannel (https://github.com/coreos/flannel) which does not support Network policy unless Calico is also in use.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubernetes network policies are enforced by the CNI plugin in use.  As such it is important to ensure that the CNI plugin supports both Ingress and Egress network policies.</xhtml:p>
          <xhtml:p>See also Recommendation 6.6.7 for GKE specifically.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To use a CNI plugin with Network Policy, enable Network Policy in GKE, and the CNI plugin will be updated. See Recommendation 6.6.7.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3.2_Ensure_that_all_Namespaces_have_Network_Policies_defined" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that all Namespaces have Network Policies defined</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use network policies to isolate traffic in your cluster network.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Segment the Network Based on Sensitivity" urn="urn:cisecurity.org:controls:7.0:14:1">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Enable Firewall Filtering Between VLANs" urn="urn:cisecurity.org:controls:7.0:14:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. A network policy is a specification of how selections of pods are allowed to communicate with each other and other network endpoints.</xhtml:p>
          <xhtml:p>Network Policies are namespace scoped.  When a network policy is introduced to a given namespace, all traffic not allowed by the policy is denied. However, if there are no network policies in a namespace all traffic will be allowed into and out of the pods in that namespace.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/services-networking/networkpolicies/</xccdf:ident>
        <xccdf:ident system="URL">https://octetz.com/posts/k8s-network-policy-apis</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/declare-network-policy/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Follow the documentation and create                 <xhtml:span class="inline_block">NetworkPolicy</xhtml:span>
 objects as you need them.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Once network policies are in use within a given namespace, traffic not explicitly allowed by a network policy will be denied.  As such it is important to ensure that, when introducing network policies, legitimate traffic is not blocked.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.4_Secrets_Management">
      <xccdf:title xml:lang="en">Secrets Management</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.1_Prefer_using_secrets_as_files_over_secrets_as_environment_variables" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Prefer using secrets as files over secrets as environment variables</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Kubernetes supports mounting secrets as data volumes or as environment variables. Minimize the use of environment variable secrets.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
          <notes:notes xml:lang="en">
            <xhtml:p>Mounting secrets as volumes has the additional benefit that secret values can be updated without restarting the pod</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>It is reasonably common for application code to log out its environment (particularly in the event of an error). This will include any secret values passed in as environment variables, so secrets can easily be exposed to any user or entity who has access to the logs.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>If possible, rewrite application code to read secrets from mounted secret files, rather than from environment variables.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Application code which expects to read secrets in the form of environment variables would need modification</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4.2_Consider_external_secret_storage" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Consider external secret storage</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Consider the use of an external secrets storage and management system, instead of using Kubernetes Secrets directly, if you have more complex secret management needs. Ensure the solution requires authentication to access secrets, has auditing of access to and use of secrets, and encrypts secrets. Some solutions also make it easier to rotate secrets.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubernetes supports secrets as first-class objects, but care needs to be taken to ensure that access to secrets is carefully limited. Using an external secrets provider can ease the management of access to secrets, especially where secrests are used across both Kubernetes and non-Kubernetes environments.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Refer to the secrets management options offered by your cloud provider or a third-party secrets management solution.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.5_Extensible_Admission_Control">
      <xccdf:title xml:lang="en">Extensible Admission Control</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5.1_Configure_Image_Provenance_using_ImagePolicyWebhook_admission_controller" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Configure Image Provenance using ImagePolicyWebhook admission controller</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Configure Image Provenance for your deployment.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubernetes supports plugging in provenance rules to accept or reject the images in your deployments. You could configure such rules to ensure that only approved images are deployed in the cluster.</xhtml:p>
          <xhtml:p>See also Recommendation 6.10.5 for GKE specifically.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/admission-controllers/#imagepolicywebhook</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/community/blob/master/contributors/design-proposals/image-provenance.md</xccdf:ident>
        <xccdf:ident system="URL">https://hub.docker.com/r/dnurmi/anchore-toolbox/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/22888</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Follow the Kubernetes documentation and setup image provenance.</xhtml:p>
              <xhtml:p>See also Recommendation 6.10.5 for GKE specifically.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You need to regularly maintain your provenance configuration based on container image updates.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.6_General_Policies">
      <xccdf:title xml:lang="en">General Policies</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>These policies relate to general cluster management topics, like namespace best practices and policies applied to pod objects in the cluster.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.1_Create_administrative_boundaries_between_resources_using_namespaces" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Create administrative boundaries between resources using namespaces</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use namespaces to isolate your Kubernetes objects.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain an Inventory of Network Boundaries" urn="urn:cisecurity.org:controls:7.0:12:1">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Identify</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Limiting the scope of user permissions can reduce the impact of mistakes or malicious activities. A Kubernetes namespace allows you to partition created resources into logically named groups. Resources created in one namespace can be hidden from other namespaces. By default, each resource created by a user in Kubernetes cluster runs in a default namespace, called             <xhtml:span class="inline_block">default</xhtml:span>
. You can create additional namespaces and attach resources and users to them. You can use Kubernetes Authorization plugins to create policies that segregate access to namespace resources between different users.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/</xccdf:ident>
        <xccdf:ident system="URL">http://blog.kubernetes.io/2016/08/security-best-practices-kubernetes-deployment.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Follow the documentation and create namespaces for objects in your deployment as you need them.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You need to switch between namespaces for administration.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.2_Ensure_that_the_seccomp_profile_is_set_to_dockerdefault_in_your_pod_definitions" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the seccomp profile is set to docker/default in your pod definitions</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Enable             <xhtml:span class="inline_block">docker/default</xhtml:span>
 seccomp profile in your pod definitions.          </xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/39845</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/21790</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/community/blob/master/contributors/design-proposals/seccomp.md#examples</xccdf:ident>
        <xccdf:ident system="URL">https://docs.docker.com/engine/security/seccomp/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Seccomp is an alpha feature currently. By default, all alpha features are disabled. So, you would need to enable alpha features in the apiserver by passing                 <xhtml:span class="inline_block">"--feature-gates=AllAlpha=true"</xhtml:span>
 argument.              </xhtml:p>
              <xhtml:p>
Edit the                 <xhtml:span class="inline_block">/etc/kubernetes/apiserver</xhtml:span>
 file on the master node and set the                 <xhtml:span class="inline_block">KUBE_API_ARGS</xhtml:span>
 parameter to                 <xhtml:span class="inline_block">"--feature-gates=AllAlpha=true"</xhtml:span>
              </xhtml:p>
              <xhtml:code class="code_block">KUBE_API_ARGS="--feature-gates=AllAlpha=true"
</xhtml:code>
              <xhtml:p>
Based on your system, restart the                 <xhtml:span class="inline_block">kube-apiserver</xhtml:span>
 service. For example:              </xhtml:p>
              <xhtml:code class="code_block">systemctl restart kube-apiserver.service
</xhtml:code>
              <xhtml:p>
Use                 <xhtml:span class="inline_block">annotations</xhtml:span>
 to enable the                 <xhtml:span class="inline_block">docker/default</xhtml:span>
 seccomp profile in your pod definitions. An example is as below:              </xhtml:p>
              <xhtml:code class="code_block">
apiVersion: v1                <br/>
kind: Pod                <br/>
metadata:                <br/>
  name: trustworthy-pod                <br/>
  annotations:                <br/>
    seccomp.security.alpha.kubernetes.io/pod: docker/default                <br/>
spec:                <br/>
  containers:                <br/>
    - name: trustworthy-container                <br/>
      image: sotrustworthy:latest
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
If the                   <xhtml:span class="inline_block">docker/default</xhtml:span>
 seccomp profile is too restrictive for you, you would have to create/manage your own seccomp profiles. Also, you need to enable all alpha features for this to work. There is no individual switch to turn on this feature.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745244" value-id="xccdf_org.cisecurity.benchmarks_value_1745244_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745244"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.3_Apply_Security_Context_to_Your_Pods_and_Containers" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Apply Security Context to Your Pods and Containers</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Apply Security Context to Your Pods and Containers</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:control title="Secure Configuration of Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4"/>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume. There are two levels of security context: pod level security context, and container level security context.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/security-context/</xccdf:ident>
        <xccdf:ident system="URL">https://learn.cisecurity.org/benchmarks</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Follow the Kubernetes documentation and apply security contexts to your pods. For a suggested list of security contexts, you may refer to the CIS Security Benchmark for Docker Containers.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>If you incorrectly apply security contexts, you may have trouble running the pods.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6.4_The_default_namespace_should_not_be_used" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">The default namespace should not be used</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Kubernetes provides a default namespace, where objects are placed if no namespace is specified for them.  Placing objects in this namespace makes application of RBAC and other controls more difficult.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Establish and Maintain a Secure Network Architecture" urn="urn:cisecurity.org:controls:8.0:12:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Physically or Logically Segregate High Risk Applications" urn="urn:cisecurity.org:controls:7.0:2:10">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Resources in a Kubernetes cluster should be segregated by namespace, to allow for security controls to be applied at that level and to make it easier to manage resources.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/10" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Ensure that namespaces are created to allow for appropriate segregation of Kubernetes resources and that all new resources are created in a specific namespace.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Managed_services">
    <xccdf:title xml:lang="en">Managed services</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section consists of security recommendations for the direct configuration of Kubernetes managed service components, namely, Google Kubernetes Engine (GKE). These recommendations are directly applicable for features which exist only as part of a managed service.</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.1_Image_Registry_and_Image_Scanning">
      <xccdf:title xml:lang="en">Image Registry and Image Scanning</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to container image registries and securing images in those registries, such as Google Container Registry (GCR).</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_Image_Vulnerability_Scanning_using_GCR_Container_Analysis_or_a_third_party_provider" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure Image Vulnerability Scanning using GCR Container Analysis or a third party provider</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Scan images stored in Google Container Registry (GCR) for vulnerabilities.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Configure Automatic Anti-Malware Scanning of Removable Media" urn="urn:cisecurity.org:controls:8.0:10:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:control title="Continuous Vulnerability Management" urn="urn:cisecurity.org:controls:7.0:3"/>
              <controls:safeguard title="Run Automated Vulnerability Scanning Tools" urn="urn:cisecurity.org:controls:7.0:3:1">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Perform Authenticated Vulnerability Scanning" urn="urn:cisecurity.org:controls:7.0:3:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Vulnerabilities in software packages can be exploited by hackers or malicious users to obtain unauthorized access to local cloud resources. GCR Container Analysis and other third party products allow images stored in GCR to be scanned for known vulnerabilities.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/container-registry/docs/container-analysis</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to GCR by visiting                   <xhtml:a href="https://console.cloud.google.com/gcr">https://console.cloud.google.com/gcr</xhtml:a>
                </xhtml:li>
                <xhtml:li>
Select Settings and Click                   <xhtml:span class="inline_block">Enable Vulnerability Scanning</xhtml:span>
.                </xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:code class="code_block">gcloud services enable containerscanning.googleapis.com
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745246" value-id="xccdf_org.cisecurity.benchmarks_value_1745246_var"/>
          <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745246"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_user_access_to_GCR" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize user access to GCR</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Restrict user access to GCR, limiting interaction with build images to only authorized personnel and service accounts.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Manage Access Control for Remote Assets" urn="urn:cisecurity.org:controls:8.0:13:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Weak access control to GCR may allow malicious users to replace built images with vulnerable or backdoored containers.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/container-registry/docs/access-control</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console:</xhtml:p>
              <xhtml:p>To modify roles granted at the GCR bucket level</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Storage Browser by visiting                   <xhtml:a href="https://console.cloud.google.com/storage/browser">https://console.cloud.google.com/storage/browser</xhtml:a>
                </xhtml:li>
                <xhtml:li>
From the list of storage buckets, select                   <xhtml:span class="inline_block">artifacts.[PROJECT_ID].appspot.com</xhtml:span>
 for the GCR bucket                </xhtml:li>
                <xhtml:li>Under the Permissions tab, modify permissions of the identified member via the drop down role menu and change the Role to Storage Object Viewer for read-only access.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>For a User or Service account with Project level permissions inherited by the GCR bucket, or the Service Account User Role:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to IAM by visiting                   <xhtml:a href="https://console.cloud.google.com/iam-admin/iam">https://console.cloud.google.com/iam-admin/iam</xhtml:a>
                </xhtml:li>
                <xhtml:li>Find the User or Service account to be modified and click on the corresponding pencil icon</xhtml:li>
                <xhtml:li>Remove the create/modify role (Storage Admin / Storage Object Admin / Storage Object Creator / Service Account User) on the user or service account</xhtml:li>
                <xhtml:li>If required add the Storage Object Viewer role - note with caution that this permits the account to view all objects stored in GCS for the project.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line:</xhtml:p>
              <xhtml:p>To change roles at the GCR bucket level:</xhtml:p>
              <xhtml:p>Firstly, run the following if read permissions are required:</xhtml:p>
              <xhtml:code class="code_block">gsutil iam ch [TYPE]:[EMAIL-ADDRESS]:objectViewer gs://artifacts.[PROJECT_ID].appspot.com
</xhtml:code>
              <xhtml:p>Then remove the excessively privileged role (Storage Admin / Storage Object Admin / Storage Object Creator) using:</xhtml:p>
              <xhtml:code class="code_block">gsutil iam ch -d [TYPE]:[EMAIL-ADDRESS]:[ROLE] gs://artifacts.[PROJECT_ID].appspot.com
</xhtml:code>
              <xhtml:p>
where:-                 <xhtml:span class="inline_block">[TYPE]</xhtml:span>
 can be one of the following:  - user, if the                 <xhtml:span class="inline_block">[EMAIL-ADDRESS]</xhtml:span>
 is a Google account  - serviceAccount, if                 <xhtml:span class="inline_block">[EMAIL-ADDRESS]</xhtml:span>
 specifies a Service account-                 <xhtml:span class="inline_block">[EMAIL-ADDRESS]</xhtml:span>
 can be one of the following:  - a Google account (for example, someone@example.com)  - a Cloud IAM service accountTo modify roles defined at the project level and subsequently inherited within the GCR bucket, or the Service Account User role, extract the IAM policy file, modify it accordingly and apply it using:              </xhtml:p>
              <xhtml:code class="code_block">gcloud projects set-iam-policy [PROJECT_ID] [POLICY_FILE]
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Care should be taken not to remove access to GCR for accounts that require this for their operation.
Any account granted the Storage Object Viewer role at the project level can view all objects stored in GCS for the project.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_cluster_access_to_read-only_for_GCR" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize cluster access to read-only for GCR</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Configure the Cluster Service Account with Storage Object Viewer Role to only allow read-only access to GCR.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The Cluster Service Account does not require administrative access to GCR, only requiring pull access to containers to deploy onto GKE. Restricting permissions follows the principles of least privilege and prevents credentials from being abused beyond the required role.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/container-registry/docs/access-control</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:p>For an account explicitly granted access to the bucket:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Storage Browser by visiting                   <xhtml:a href="https://console.cloud.google.com/storage/browser">https://console.cloud.google.com/storage/browser</xhtml:a>
                </xhtml:li>
                <xhtml:li>
From the list of storage buckets, select                   <xhtml:span class="inline_block">artifacts.[PROJECT_ID].appspot.com</xhtml:span>
 for the GCR bucket                </xhtml:li>
                <xhtml:li>Under the Permissions tab, modify permissions of the identified GKE Service Account via the drop-down role menu and change to the Role to Storage Object Viewer for read-only access.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>For an account that inherits access to the bucket through Project level permissions:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to IAM console by visiting                   <xhtml:a href="https://console.cloud.google.com/iam-admin">https://console.cloud.google.com/iam-admin</xhtml:a>
                </xhtml:li>
                <xhtml:li>From the list of accounts, identify the required service account and select the corresponding pencil icon</xhtml:li>
                <xhtml:li>Remove the Storage Admin / Storage Object Admin / Storage Object Creator roles.</xhtml:li>
                <xhtml:li>Add the Storage Object Viewer role- note with caution that this permits the account to view all objects stored in GCS for the project.</xhtml:li>
                <xhtml:li>
Click                   <xhtml:span class="inline_block">SAVE</xhtml:span>
                </xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>For an account explicitly granted to the bucket. Firstly add read access to the Kubernetes Service Account</xhtml:p>
              <xhtml:code class="code_block">gsutil iam ch [TYPE]:[EMAIL-ADDRESS]:objectViewer gs://artifacts.[PROJECT_ID].appspot.com
</xhtml:code>
              <xhtml:p>where:</xhtml:p>
              <xhtml:ul>
                <xhtml:li>
                  <xhtml:span class="inline_block">[TYPE]</xhtml:span>
 can be one of the following:
                  <xhtml:ul>
                    <xhtml:li>
user, if the                       <xhtml:span class="inline_block">[EMAIL-ADDRESS]</xhtml:span>
 is a Google account                    </xhtml:li>
                    <xhtml:li>
serviceAccount, if                       <xhtml:span class="inline_block">[EMAIL-ADDRESS]</xhtml:span>
 specifies a Service account                    </xhtml:li>
                  </xhtml:ul>
                </xhtml:li>
                <xhtml:li>
                  <xhtml:span class="inline_block">[EMAIL-ADDRESS]</xhtml:span>
 can be one of the following:
                  <xhtml:ul>
                    <xhtml:li>a Google account (for example, someone@example.com)</xhtml:li>
                    <xhtml:li>a Cloud IAM service account</xhtml:li>
                  </xhtml:ul>
                </xhtml:li>
              </xhtml:ul>
              <xhtml:p>Then remove the excessively privileged role (Storage Admin / Storage Object Admin / Storage Object Creator) using:</xhtml:p>
              <xhtml:code class="code_block">gsutil iam ch -d [TYPE]:[EMAIL-ADDRESS]:[ROLE] gs://artifacts.[PROJECT_ID].appspot.com
</xhtml:code>
              <xhtml:p>For an account that inherits access to the GCR Bucket through Project level permissions, modify the Projects IAM policy file accordingly, then upload it using:</xhtml:p>
              <xhtml:code class="code_block">gcloud projects set-iam-policy [PROJECT_ID] [POLICY_FILE]
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>A separate dedicated service account may be required for use by build servers and other robot users pushing or managing container images.</xhtml:p>
                <xhtml:p>Any account granted the Storage Object Viewer role at the project level can view all objects stored in GCS for the project.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Minimize_Container_Registries_to_only_those_approved" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize Container Registries to only those approved</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use Binary Authorization to allowlist (whitelist) only approved container registries.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Manage Access Control for Remote Assets" urn="urn:cisecurity.org:controls:8.0:13:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Securely Store Master Images" urn="urn:cisecurity.org:controls:7.0:5:3">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Allowing unrestricted access to external container registries provides the opportunity for malicious or unapproved containers to be deployed into the cluster. Allowlisting only approved container registries reduces this risk.</xhtml:p>
          <xhtml:p>See also Recommendation 6.10.5.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/binary-authorization/docs/policy-yaml-reference</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:h4>Using Google Cloud Console:</xhtml:h4>
              <xhtml:ol>
                <xhtml:li>
Go to Binary Authorization by visiting                   <xhtml:a href="https://console.cloud.google.com/security/binary-authorization">https://console.cloud.google.com/security/binary-authorization</xhtml:a>
                </xhtml:li>
                <xhtml:li>Enable Binary Authorization API (if disabled)</xhtml:li>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select Kubernetes cluster for which Binary Authorization is disabled</xhtml:li>
                <xhtml:li>Click EDIT</xhtml:li>
                <xhtml:li>Set Binary Authorization to 'Enabled'</xhtml:li>
                <xhtml:li>Click SAVE</xhtml:li>
                <xhtml:li>
Return to the Binary Authorization by visiting                   <xhtml:a href="https://console.cloud.google.com/security/binary-authorization">https://console.cloud.google.com/security/binary-authorization</xhtml:a>
                </xhtml:li>
                <xhtml:li>Set an appropriate policy for your cluster and enter the approved container registries under 'Image paths'.</xhtml:li>
              </xhtml:ol>
              <xhtml:h4>Using Command Line:</xhtml:h4>
              <xhtml:p>Update the cluster to enable Binary Authorization</xhtml:p>
              <xhtml:code class="code_block">
gcloud container cluster update [CLUSTER_NAME] \                <br/>
  --enable-binauthz
              </xhtml:code>
              <xhtml:p>
Create a Binary Authorization Policy using the Binary Authorization Policy Reference (                <xhtml:a href="https://cloud.google.com/binary-authorization/docs/policy-yaml-reference">https://cloud.google.com/binary-authorization/docs/policy-yaml-reference</xhtml:a>
) for guidance.              </xhtml:p>
              <xhtml:p>Import the policy file into Binary Authorization:</xhtml:p>
              <xhtml:code class="code_block">gcloud container binauthz policy import [YAML_POLICY]
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>All container images to be deployed to the cluster must be hosted within an approved container image registry. If public registries are not on the allowlist, a process for bringing commonly used container images into an approved private registry and keeping them up to date will be required.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.2_Identity_and_Access_Management_IAM">
      <xccdf:title xml:lang="en">Identity and Access Management (IAM)</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to using Cloud IAM with GKE.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Ensure_GKE_clusters_are_not_running_using_the_Compute_Engine_default_service_account" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure GKE clusters are not running using the Compute Engine default service account</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Create and use minimally privileged Service accounts to run GKE cluster nodes instead of using the Compute Engine default Service account. Unnecessary permissions could be abused in the case of a node compromise.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Establish and Maintain an Inventory of Service Accounts" urn="urn:cisecurity.org:controls:8.0:5:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Identify</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A GCP service account (as distinct from a Kubernetes ServiceAccount) is an identity that an instance or an application can use to run GCP API requests on your behalf. This identity is used to identify virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes use the Compute Engine default service account. This account has broad access by default, as defined by access scopes, making it useful to a wide variety of applications on the VM, but it has more permissions than are required to run your Kubernetes Engine cluster.</xhtml:p>
          <xhtml:p>You should create and use a minimally privileged service account to run your Kubernetes Engine cluster instead of using the Compute Engine default service account, and create separate service accounts for each Kubernetes Workload (See Recommendation 6.2.2).</xhtml:p>
          <xhtml:p>Kubernetes Engine requires, at a minimum, the node service account to have the monitoring.viewer, monitoring.metricWriter, and logging.logWriter roles. Additional roles may need to be added for the nodes to pull images from GCR.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/compute/docs/access/service-accounts#compute_engine_default_service_account</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console:</xhtml:p>
              <xhtml:p>To create a minimally privileged service account.</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Service Accounts by visiting                   <xhtml:a href="https://console.cloud.google.com/iam-admin/serviceaccounts">https://console.cloud.google.com/iam-admin/serviceaccounts</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click on CREATE SERVICE ACCOUNT</xhtml:li>
                <xhtml:li>Enter Service Account Details</xhtml:li>
                <xhtml:li>Click CREATE</xhtml:li>
                <xhtml:li>Within Service Account permissions add the following roles:</xhtml:li>
              </xhtml:ol>
              <xhtml:ul>
                <xhtml:li>Logs Writer</xhtml:li>
                <xhtml:li>Monitoring Metric Writer</xhtml:li>
                <xhtml:li>Monitoring Viewer</xhtml:li>
              </xhtml:ul>
              <xhtml:ol start="6">
                <xhtml:li>Click CONTINUE</xhtml:li>
                <xhtml:li>Grant users access to this service account and create keys as required</xhtml:li>
                <xhtml:li>Click DONE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>To create a Node pool to use the Service account:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click on the cluster name within which the Node pool will be launched</xhtml:li>
                <xhtml:li>Click on ADD NODE POOL</xhtml:li>
                <xhtml:li>Within the Node Pool options select the minimally privileged service account from the Service Account drop down under the 'Security' heading</xhtml:li>
                <xhtml:li>Click SAVE to launch the Node pool.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>You will need to migrate your workloads to the new Node pool, and delete Node pools that use the default service account to complete the remediation.</xhtml:p>
              <xhtml:p>Using Command Line:</xhtml:p>
              <xhtml:p>To create a minimally privileged service account:</xhtml:p>
              <xhtml:code class="code_block">
gcloud iam service-accounts create [SA_NAME] \                <br/>
  --display-name "GKE Node Service Account"                <br/>
export NODE_SA_EMAIL=`gcloud iam service-accounts list \                <br/>
  --format='value(email)' \                <br/>
  --filter='displayName:GKE Node Service Account'`
              </xhtml:code>
              <xhtml:p>Grant the following roles to the service account:</xhtml:p>
              <xhtml:code class="code_block">
export PROJECT_ID=`gcloud config get-value project`                <br/>
gcloud projects add-iam-policy-binding $PROJECT_ID \                <br/>
  --member serviceAccount:$NODE_SA_EMAIL \                <br/>
  --role roles/monitoring.metricWriter                <br/>
gcloud projects add-iam-policy-binding $PROJECT_ID \                <br/>
  --member serviceAccount:$NODE_SA_EMAIL \                <br/>
  --role roles/monitoring.viewer                <br/>
gcloud projects add-iam-policy-binding $PROJECT_ID \                <br/>
  --member serviceAccount:$NODE_SA_EMAIL \                <br/>
  --role roles/logging.logWriter
              </xhtml:code>
              <xhtml:p>To create a new Node pool using the Service account, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container node-pools create [NODE_POOL] \                <br/>
  --service-account=[SA_NAME]@[PROJECT_ID].iam.gserviceaccount.com \                <br/>
  --cluster=[CLUSTER_NAME] --zone [COMPUTE_ZONE]
              </xhtml:code>
              <xhtml:p>You will need to migrate your workloads to the new Node pool, and delete Node pools that use the default service account to complete the remediation.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Instances are automatically granted the                   <xhtml:a href="https://www.googleapis.com/auth/cloud-platform">https://www.googleapis.com/auth/cloud-platform</xhtml:a>
 scope to allow full access to all Google Cloud APIs. This is so that the IAM permissions of the instance are completely determined by the IAM roles of the Service account. Thus if Kubernetes workloads were using cluster access scopes to perform actions using Google APIs, they may no longer be able to, if not permitted by the permissions of the Service account. To remediate, follow Recommendation 6.2.2.                </xhtml:p>
                <xhtml:p>The Service account roles listed here are the minimum required to run the cluster. Additional roles may be required to pull from a private instance of Google Container Registry (GCR).</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745247" value-id="xccdf_org.cisecurity.benchmarks_value_1745247_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745247"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Prefer_using_dedicated_GCP_Service_Accounts_and_Workload_Identity" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Prefer using dedicated GCP Service Accounts and Workload Identity</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Kubernetes workloads should not use cluster node service accounts to authenticate to Google Cloud APIs. Each Kubernetes Workload that needs to authenticate to other Google services using Cloud IAM should be provisioned a dedicated Service account. Enabling Workload Identity manages the distribution and rotation of Service account keys for the workloads to use.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Restrict Administrator Privileges to Dedicated Administrator Accounts" urn="urn:cisecurity.org:controls:8.0:5:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Establish and Maintain Dedicated Computing Resources for All Administrative Work" urn="urn:cisecurity.org:controls:8.0:12:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Manual approaches for authenticating Kubernetes workloads running on GKE against Google Cloud APIs are: storing service account keys as a Kubernetes secret (which introduces manual key rotation and potential for key compromise); or use of the underlying nodes' IAM Service account, which violates the principle of least privilege on a multitenanted node,  when one pod needs to have access to a service, but every other pod on the node that uses the Service account does not.</xhtml:p>
          <xhtml:p>Once a relationship between a Kubernetes Service account and a GCP Service account has been configured, any workload running as the Kubernetes Service account automatically authenticates as the mapped GCP Service account when accessing Google Cloud APIs on a cluster with Workload Identity enabled.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/12/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>From the list of clusters, select your cluster for which Workload Identity is disabled.</xhtml:li>
                <xhtml:li>Click on EDIT</xhtml:li>
                <xhtml:li>
Set Workload Identity to 'Enabled' and set the Workload Identity Namespace to the namespace of the Cloud project containing the cluster, e.g:                   <xhtml:span class="inline_block">[PROJECT_ID].svc.id.goog</xhtml:span>
                </xhtml:li>
                <xhtml:li>Click SAVE and wait for the cluster to update</xhtml:li>
                <xhtml:li>Once the cluster has updated, select each Node pool within the cluster Details page</xhtml:li>
                <xhtml:li>For each Node pool, select EDIT within the Node pool Details page</xhtml:li>
                <xhtml:li>Within the Edit node pool pane, check the 'Enable GKE Metadata Server' checkbox and click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line:</xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container clusters update [CLUSTER_NAME] --zone [CLUSTER_ZONE] \                <br/>
  --identity-namespace=[PROJECT_ID].svc.id.goog
              </xhtml:code>
              <xhtml:p>
Note that existing Node pools are unaffected. New Node pools default to                 <xhtml:span class="inline_block">--workload-metadata-from-node=GKE_METADATA_SERVER</xhtml:span>
.              </xhtml:p>
              <xhtml:p>
Then, modify existing Node pools to enable                 <xhtml:span class="inline_block">GKE_METADATA_SERVER</xhtml:span>
:              </xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container node-pools update [NODEPOOL_NAME] \                <br/>
  --cluster=[CLUSTER_NAME] --zone [CLUSTER_ZONE] \                <br/>
  --workload-metadata-from-node=GKE_METADATA_SERVER
              </xhtml:code>
              <xhtml:p>
You may also need to modify workloads in order for them to use Workload Identity as described within                  <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity">https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity</xhtml:a>
. Also consider the effects on the availability of your hosted workloads as Node pools are updated, it may be more appropriate to create new Node Pools.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>During the Workload Identity beta, a GCP project can have a maximum of 20 clusters with Workload Identity enabled.</xhtml:p>
                <xhtml:p>Workload Identity replaces the need to use Metadata Concealment and as such, the two approaches are incompatible. The sensitive metadata protected by Metadata Concealment is also protected by Workload Identity.</xhtml:p>
                <xhtml:p>When Workload Identity is enabled, you can no longer use the Compute Engine default Service account. Correspondingly, Workload Identity can't be used with Pods running in the host network. You may also need to modify workloads in order for them to use Workoad Identity as described within  https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity</xhtml:p>
                <xhtml:p>GKE infrastructure pods such as Stackdriver will continue to use the Node's Service account.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.3_Cloud_Key_Management_Service_Cloud_KMS">
      <xccdf:title xml:lang="en">Cloud Key Management Service (Cloud KMS)</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to using Cloud KMS with GKE.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_Kubernetes_Secrets_are_encrypted_using_keys_managed_in_Cloud_KMS" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure Kubernetes Secrets are encrypted using keys managed in Cloud KMS</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Encrypt Kubernetes secrets, stored in etcd, at the application-layer using a customer-managed key in Cloud KMS.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>By default, GKE encrypts customer content stored at rest, including Secrets. GKE handles and manages this default encryption for you without any additional action on your part.</xhtml:p>
          <xhtml:p>Application-layer Secrets Encryption provides an additional layer of security for sensitive data, such as user defined Secrets and Secrets required for the operation of the cluster, such as service account keys, which are all stored in etcd.</xhtml:p>
          <xhtml:p>Using this functionality, you can use a key, that you manage in Cloud KMS, to encrypt data at the application layer. This protects against attackers in the event that they manage to gain access to etcd.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/encrypting-secrets</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>To enable Application-layer Secrets Encryption, several configuration items are required. These include:</xhtml:p>
              <xhtml:ul>
                <xhtml:li>A key ring</xhtml:li>
                <xhtml:li>A key</xhtml:li>
                <xhtml:li>A GKE service account with Cloud KMS CryptoKey Encrypter/Decrypter role</xhtml:li>
              </xhtml:ul>
              <xhtml:p>Once these are created, Application-layer Secrets Encryption can be enabled on an existing or new cluster.</xhtml:p>
              <xhtml:p>Using Google Cloud Console:</xhtml:p>
              <xhtml:p>To create a key</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Cloud KMS by visiting                   <xhtml:a href="https://console.cloud.google.com/security/kms">https://console.cloud.google.com/security/kms</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select CREATE KEY RING</xhtml:li>
                <xhtml:li>Enter a Key ring name and the region where the keys will be stored</xhtml:li>
                <xhtml:li>Click CREATE</xhtml:li>
                <xhtml:li>Enter a Key name and appropriate rotation period within the Create key pane</xhtml:li>
                <xhtml:li>Click CREATE</xhtml:li>
              </xhtml:ol>
              <xhtml:p>To enable on a new cluster</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click CREATE CLUSTER</xhtml:li>
                <xhtml:li>Expand the template by clicking 'Availability, networking, security, and additional features' and check the 'Enable Application-layer Secrets Encryption' checkbox.</xhtml:li>
                <xhtml:li>Select the desired Key as the customer-managed key and if prompted grant permissions to the GKE Service account</xhtml:li>
                <xhtml:li>Click CREATE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>To enable on an existing cluster</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click to edit cluster you want to modify.</xhtml:li>
                <xhtml:li>Enable Application-layer Secrets Encryption and choose the desired Key</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line:</xhtml:p>
              <xhtml:p>To create a key:
Create a key ring:</xhtml:p>
              <xhtml:code class="code_block">
gcloud kms keyrings create [RING_NAME] \                <br/>
    --location [LOCATION] \                <br/>
    --project [KEY_PROJECT_ID]
              </xhtml:code>
              <xhtml:p>Create a key:</xhtml:p>
              <xhtml:code class="code_block">
gcloud kms keys create [KEY_NAME] \                <br/>
    --location [LOCATION] \                <br/>
    --keyring [RING_NAME] \                <br/>
    --purpose encryption \                <br/>
    --project [KEY_PROJECT_ID]
              </xhtml:code>
              <xhtml:p>Grant the Kubernetes Engine Service Agent service account the Cloud KMS CryptoKey Encrypter/Decrypter role:</xhtml:p>
              <xhtml:code class="code_block">
gcloud kms keys add-iam-policy-binding [KEY_NAME] \                <br/>
  --location [LOCATION] \                <br/>
  --keyring [RING_NAME] \                <br/>
  --member serviceAccount:[SERVICE_ACCOUNT_NAME] \                <br/>
  --role roles/cloudkms.cryptoKeyEncrypterDecrypter \                <br/>
  --project [KEY_PROJECT_ID]
              </xhtml:code>
              <xhtml:p>To create a new cluster with Application-layer Secrets Encryption:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters create [CLUSTER_NAME] \                <br/>
  --cluster-version=latest \                <br/>
  --zone [ZONE] \                <br/>
  --database-encryption-key projects/[KEY_PROJECT_ID]/locations/[LOCATION]/keyRings/[RING_NAME]/cryptoKeys/[KEY_NAME] \                <br/>
  --project [CLUSTER_PROJECT_ID]
              </xhtml:code>
              <xhtml:p>To enable on an existing cluster</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters update [CLUSTER_NAME] \                <br/>
  --zone [ZONE] \                <br/>
  --database-encryption-key projects/[KEY_PROJECT_ID]/locations/[LOCATION]/keyRings/[RING_NAME]/cryptoKeys/[KEY_NAME] \                <br/>
  --project [CLUSTER_PROJECT_ID]
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>To use the Cloud KMS CryptoKey to protect etcd in the cluster, the 'Kubernetes Engine Service Agent' Service account must hold the 'Cloud KMS CryptoKey Encrypter/Decrypter' role.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745248" value-id="xccdf_org.cisecurity.benchmarks_value_1745248_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745248"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.4_Node_Metadata">
      <xccdf:title xml:lang="en">Node Metadata</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to node metadata in GKE.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Ensure_legacy_Compute_Engine_instance_metadata_APIs_are_Disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure legacy Compute Engine instance metadata APIs are Disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable the legacy GCE instance metadata APIs for GKE nodes. Under some circumstances, these can be used from within a pod to extract the node's credentials.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Only Use Up-to-date And Trusted Third-Party Components" urn="urn:cisecurity.org:controls:7.0:18:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The legacy GCE metadata endpoint allows simple HTTP requests to be made returning sensitive information. To prevent the enumeration of metadata endpoints and data exfiltration, the legacy metadata endpoint must be disabled.</xhtml:p>
          <xhtml:p>Without requiring a custom HTTP header when accessing the legacy GCE metadata endpoint, a flaw in an application that allows an attacker to trick the code into retrieving the contents of an attacker-specified web URL could provide a simple method for enumeration and potential credential exfiltration. By requiring a custom HTTP header, the attacker needs to exploit an application flaw that allows them to control the URL and also add custom headers in order to carry out this attack successfully.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#disable-legacy-apis</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>The legacy GCE metadata endpoint must be disabled upon the cluster or node-pool creation. For GKE versions 1.12 and newer, the legacy GCE metadata endpoint is disabled by default.</xhtml:p>
              <xhtml:p>Using Google Cloud Console:</xhtml:p>
              <xhtml:p>To update an existing cluster,  create a new Node pool with the legacy GCE metadata endpoint disabled:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click on the name of cluster to be upgraded and click ADD NODE POOL.</xhtml:li>
                <xhtml:li>
Ensure that GCE instance metadata is set to the key:value pair of                   <xhtml:span class="inline_block">disable-legacy-endpoints: true</xhtml:span>
                </xhtml:li>
                <xhtml:li>Click SAVE</xhtml:li>
              </xhtml:ol>
              <xhtml:p>You will need to migrate workloads from any existing non-conforming Node pools, to the new Node pool, then delete non-conforming Node pools to complete the remediation.</xhtml:p>
              <xhtml:p>Using Command Line:</xhtml:p>
              <xhtml:p>To update an existing cluster, create a new Node pool with the legacy GCE metadata endpoint disabled:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container node-pools create [POOL_NAME] \                <br/>
 --metadata disable-legacy-endpoints=true \                <br/>
 --cluster [CLUSTER_NAME] \                <br/>
 --zone [COMPUTE_ZONE]
              </xhtml:code>
              <xhtml:p>You will need to migrate workloads from any existing non-conforming Node pools, to the new Node pool, then delete non-conforming Node pools to complete the remediation.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Any workloads using the legacy GCE metadata endpoint will no longer be able to retrieve metadata from the endpoint. Use Workload Identity instead.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745249" value-id="xccdf_org.cisecurity.benchmarks_value_1745249_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745249"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.2_Ensure_the_GKE_Metadata_Server_is_Enabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure the GKE Metadata Server is Enabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Running the GKE Metadata Server prevents workloads from accessing sensitive instance metadata and facilitates Workload Identity</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Ensure the Use of Dedicated Administrative Accounts" urn="urn:cisecurity.org:controls:7.0:4:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Every node stores its metadata on a metadata server. Some of this metadata, such as kubelet credentials and the VM instance identity token, is sensitive and should not be exposed to a Kubernetes workload. Enabling the GKE Metadata server prevents pods (that are not running on the host network) from accessing this metadata and facilitates Workload Identity.</xhtml:p>
          <xhtml:p>When unspecified, the default setting allows running pods to have full access to the node's underlying metadata server.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#concealment</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>The GKE Metadata Server requires Workload Identity to be enabled on a cluster. Modify the cluster to enable Workload Identity and enable the GKE Metadata Server.</xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>From the list of clusters, select the cluster for which Workload Identity is disabled.</xhtml:li>
                <xhtml:li>Click on EDIT</xhtml:li>
                <xhtml:li>
Set Workload Identity to 'Enabled' and set the Workload Identity Namespace to the namespace of the Cloud project containing the cluster, e.g:                   <xhtml:span class="inline_block">[PROJECT_ID].svc.id.goog</xhtml:span>
                </xhtml:li>
                <xhtml:li>Click SAVE and wait for the cluster to update</xhtml:li>
                <xhtml:li>Once the cluster has updated, select each Node pool within the cluster Details page</xhtml:li>
                <xhtml:li>For each Node pool, select EDIT within the Node pool details page</xhtml:li>
                <xhtml:li>Within the Edit node pool pane, check the 'Enable GKE Metadata Server checkbox'</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container clusters update [CLUSTER_NAME] \                <br/>
  --identity-namespace=[PROJECT_ID].svc.id.goog
              </xhtml:code>
              <xhtml:p>
Note that existing Node pools are unaffected. New Node pools default to                 <xhtml:span class="inline_block">--workload-metadata-from-node=GKE_METADATA_SERVER</xhtml:span>
.              </xhtml:p>
              <xhtml:p>To modify an existing Node pool to enable GKE Metadata Server:</xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container node-pools update [NODEPOOL_NAME] \                <br/>
  --cluster=[CLUSTER_NAME] \                <br/>
  --workload-metadata-from-node=GKE_METADATA_SERVER
              </xhtml:code>
              <xhtml:p>
You may also need to modify workloads in order for them to use Workload Identity as described within                  <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity">https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity</xhtml:a>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>The GKE Metadata Server must be run when using Workload Identity. Because Workload Identity replaces the need to use Metadata Concealment, the two approaches are incompatible.</xhtml:p>
                <xhtml:p>When the GKE Metadata Server and Workload Identity are enabled, unless the Pod is running on the host network, Pods cannot use the the Compute Engine default service account.</xhtml:p>
                <xhtml:p>
You may also need to modify workloads in order for them to use Workoad Identity as described within                    <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity">https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity</xhtml:a>
.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745251" value-id="xccdf_org.cisecurity.benchmarks_value_1745251_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745251"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.5_Node_Configuration_and_Maintenance">
      <xccdf:title xml:lang="en">Node Configuration and Maintenance</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to node configurations in GKE.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5.1_Ensure_Container-Optimized_OS_COS_is_used_for_GKE_node_images" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure Container-Optimized OS (COS) is used for GKE node images</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use Container-Optimized OS (COS) as a managed, optimized and hardened base OS that limits the host's attack surface.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Securely Manage Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:6">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>COS is an operating system image for Compute Engine VMs optimized for running containers. With COS, you can bring up your containers on Google Cloud Platform quickly, efficiently, and securely.</xhtml:p>
          <xhtml:p>Using COS as the node image provides the following benefits:</xhtml:p>
          <xhtml:ul>
            <xhtml:li>
Run containers out of the box: COS instances come pre-installed with the container runtime and               <xhtml:span class="inline_block">cloud-init</xhtml:span>
. With a COS instance, you can bring up your container at the same time you create your VM, with no on-host setup required.            </xhtml:li>
            <xhtml:li>Smaller attack surface: COS has a smaller footprint, reducing your instance's potential attack surface.</xhtml:li>
            <xhtml:li>Locked-down by default: COS instances include a locked-down firewall and other security settings by default.</xhtml:li>
          </xhtml:ul>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/node-images</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/container-optimized-os/docs/</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/container-optimized-os/docs/concepts/security</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select the Kubernetes cluster which does not use COS</xhtml:li>
                <xhtml:li>Under the Node pools heading, select the Node Pool that requires alteration</xhtml:li>
                <xhtml:li>Click EDIT</xhtml:li>
                <xhtml:li>Under the Image Type heading click CHANGE</xhtml:li>
                <xhtml:li>From the pop-up menu select Container-Optimized OS (cos) and click CHANGE</xhtml:li>
                <xhtml:li>Repeat for all non-compliant Node pools.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>
To set the node image to                 <xhtml:span class="inline_block">cos</xhtml:span>
 for an existing cluster's Node pool:              </xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters upgrade [CLUSTER_NAME]\                <br/>
  --image-type cos \                <br/>
  --zone [COMPUTE_ZONE] --node-pool [POOL_NAME]
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>If modifying an existing cluster's Node pool to run COS, the upgrade operation used is long-running and will block other operations on the cluster (including delete) until it has run to completion.</xhtml:p>
                <xhtml:p>
COS nodes also provide an option with                   <xhtml:span class="inline_block">containerd</xhtml:span>
 as the main container runtime directly integrated with Kubernetes instead of                   <xhtml:span class="inline_block">docker</xhtml:span>
. Thus, on these nodes, Docker cannot view or access containers or images managed by Kubernetes. Your applications should not interact with Docker directly. For general troubleshooting or debugging, use crictl instead.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745252" value-id="xccdf_org.cisecurity.benchmarks_value_1745252_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745252"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5.2_Ensure_Node_Auto-Repair_is_enabled_for_GKE_nodes" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure Node Auto-Repair is enabled for GKE nodes</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Nodes in a degraded state are an unknown quantity and so may pose a security risk.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Perform Automated Vulnerability Scans of Externally-Exposed Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:7:6">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Identify</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Run Automated Vulnerability Scanning Tools" urn="urn:cisecurity.org:controls:7.0:3:1">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Enforce Access Control to Data through Automated Tools" urn="urn:cisecurity.org:controls:7.0:14:7">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubernetes Engine's node auto-repair feature helps you keep the nodes in your cluster in a healthy, running state. When enabled, Kubernetes Engine makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, Kubernetes Engine initiates a repair process for that node.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-repair</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select Kubernetes clusters for which node auto-repair is disabled</xhtml:li>
                <xhtml:li>Click on the name of the Node pool that requires node auto-repair to be enabled</xhtml:li>
                <xhtml:li>Within the Node pool details pane click EDIT</xhtml:li>
                <xhtml:li>Under the 'Management' heading, ensure the 'Enable Auto-repair' box is checked.</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To enable node auto-repair for an existing cluster with Node pool, run the following command:</xhtml:p>
              <xhtml:code class="code_block">gcloud container node-pools update $POOL_NAME --cluster $CLUSTER_NAME --zone $COMPUTE_ZONE --enable-autorepair
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>If multiple nodes require repair, Kubernetes Engine might repair them in parallel. Kubernetes Engine limits number of repairs depending on the size of the cluster (bigger clusters have a higher limit) and the number of broken nodes in the cluster (limit decreases if many nodes are broken).</xhtml:p>
                <xhtml:p>Node auto-repair is not available on Alpha Clusters.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745253" value-id="xccdf_org.cisecurity.benchmarks_value_1745253_var"/>
          <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745253"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5.3_Ensure_Node_Auto-Upgrade_is_enabled_for_GKE_nodes" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure Node Auto-Upgrade is enabled for GKE nodes</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Node auto-upgrade keeps nodes at the current Kubernetes and OS security patch level to mitigate known vulnerabilities.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Perform Automated Operating System Patch Management" urn="urn:cisecurity.org:controls:8.0:7:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Perform Automated Application Patch Management" urn="urn:cisecurity.org:controls:8.0:7:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Ensure Software is Supported by Vendor" urn="urn:cisecurity.org:controls:7.0:2:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Identify</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
          <notes:notes xml:lang="en">
            <xhtml:p>Node auto-upgrades is not available for Alpha Clusters.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Node auto-upgrade helps you keep the nodes in your cluster or Node pool up to date with the latest stable patch version of Kubernetes as well as the underlying node operating system. Node auto-upgrade uses the same update mechanism as manual node upgrades.</xhtml:p>
          <xhtml:p>Node pools with node auto-upgrade enabled are automatically scheduled for upgrades when a new stable Kubernetes version becomes available. When the upgrade is performed, the Node pool is upgraded to match the current cluster master version. From a security perspective, this has the benefit of applying security updates automatically to the Kubernetes Engine when security fixes are released.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-upgrades</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/maintenance-windows-and-exclusions</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select Kubernetes clusters for which node auto-upgrade is disabled</xhtml:li>
                <xhtml:li>Click on the name of the Node pool that requires node auto-upgrade to be enabled</xhtml:li>
                <xhtml:li>Within the Node pool details pane click EDIT</xhtml:li>
                <xhtml:li>Under the 'Management' heading, ensure the 'Enable auto-upgrade' box is checked.
Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To enable node auto-upgrade for an existing cluster's Node pool, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container node-pools update [NODE_POOL] \                <br/>
  --cluster [CLUSTER_NAME] --zone [COMPUTE_ZONE] \                <br/>
  --enable-autoupgrade
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Enabling node auto-upgrade does not cause your nodes to upgrade immediately. Automatic upgrades occur at regular intervals at the discretion of the Kubernetes Engine team.</xhtml:p>
                <xhtml:p>To prevent upgrades occurring during a peak period for your cluster, you should define a maintenance window. A maintenance window is a four-hour timeframe that you choose in which automatic upgrades should occur. Upgrades can occur on any day of the week, and at any time within the timeframe. To prevent upgrades from occurring during certain dates, you should define a maintenance exclusion. A maintenance exclusion can span multiple days.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745254" value-id="xccdf_org.cisecurity.benchmarks_value_1745254_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745254"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5.4_When_creating_New_Clusters_-_Automate_GKE_version_management_using_Release_Channels" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">When creating New Clusters - Automate GKE version management using Release Channels</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Subscribe to the Regular or Stable Release Channel to automate version upgrades to the GKE cluster and to reduce version management complexity to the number of features and level of stability required.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Deploy Automated Operating System Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Deploy Automated Software Patch Management Tools" urn="urn:cisecurity.org:controls:7.0:3:5">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Use Standard Hardening Configuration Templates for Databases" urn="urn:cisecurity.org:controls:7.0:18:11">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Release Channels signal a graduating level of stability and production-readiness. These are based on observed performance of GKE clusters running that version and represent experience and confidence in the cluster version.</xhtml:p>
          <xhtml:p>The Regular release channel upgrades every few weeks and is for production users who need features not yet offered in the Stable channel. These versions have passed internal validation, but don't have enough historical data to guarantee their stability. Known issues generally have known workarounds.</xhtml:p>
          <xhtml:p>The Stable release channel upgrades every few months and is for production users who need stability above all else, and for whom frequent upgrades are too risky. These versions have passed internal validation and have been shown to be stable and reliable in production, based on the observed performance of those clusters.</xhtml:p>
          <xhtml:p>Critical security patches are delivered to all release channels.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/11" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/release-channels</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Currently, cluster Release Channels are only configurable at cluster provisioning time.</xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting:                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click CREATE CLUSTER</xhtml:li>
                <xhtml:li>Under the 'Master Version' heading, click the 'Use Release Channels' button</xhtml:li>
                <xhtml:li>Select the 'Regular' or 'Stable' channels from the 'Release Channel' drop down menu</xhtml:li>
                <xhtml:li>Configure the rest of the cluster settings as desired</xhtml:li>
                <xhtml:li>Click CREATE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>Create a new cluster by running the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container clusters create [CLUSTER_NAME] \                <br/>
  --zone [COMPUTE_ZONE] \                <br/>
  --release-channel [RELEASE_CHANNEL]
              </xhtml:code>
              <xhtml:p>
where                 <xhtml:span class="inline_block">[RELEASE_CHANNEL]</xhtml:span>
 is                 <xhtml:span class="inline_block">stable</xhtml:span>
 or                 <xhtml:span class="inline_block">regular</xhtml:span>
 according to your needs.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Once release channels are enabled on a cluster, they cannot be disabled. To stop using release channels, you must recreate the cluster without the                   <xhtml:span class="inline_block">--release-channel</xhtml:span>
 flag.                </xhtml:p>
                <xhtml:p>Node auto-upgrade is enabled (and cannot be disabled), so your cluster is updated automatically from releases available in the chosen release channel.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5.5_Ensure_Shielded_GKE_Nodes_are_Enabled" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure Shielded GKE Nodes are Enabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Shielded GKE Nodes provides verifiable integrity via secure boot, virtual trusted platform module (vTPM)-enabled measured boot, and integrity monitoring.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Use Standard Hardening Configuration Templates for Application Infrastructure" urn="urn:cisecurity.org:controls:8.0:16:7">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Securely Store Master Images" urn="urn:cisecurity.org:controls:7.0:5:3">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Shielded GKE nodes protects clusters against boot- or kernel-level malware or rootkits which persist beyond infected OS.</xhtml:p>
          <xhtml:p>Shielded GKE nodes run firmware which is signed and verified using Google's Certificate Authority, ensuring that the nodes' firmware is unmodified and establishing the root of trust for Secure Boot. GKE node identity is strongly protected via virtual Trusted Platform Module (vTPM) and verified remotely by the master node before the node joins the cluster. Lastly, GKE node integrity (i.e., boot sequence and kernel) is measured and can be monitored and verified remotely.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/7" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:h4>Using Google Cloud Console:</xhtml:h4>
              <xhtml:p>To update an existing cluster to use Shielded GKE nodes:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Navigate to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select the cluster which you wish to enable Shielded GKE Nodes and Click EDIT</xhtml:li>
                <xhtml:li>Locate the 'Shielded GKE Nodes' drop-down menu and select 'Enabled'</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:h4>Using Command Line:</xhtml:h4>
              <xhtml:p>
To migrate an existing cluster, you will need to specify the                 <xhtml:span class="inline_block">--enable-shielded-nodes</xhtml:span>
 flag on a cluster update command:              </xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container clusters update $CLUSTER_NAME \                <br/>
  --zone $CLUSTER_ZONE \                <br/>
  --enable-shielded-nodes
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>After you enable Shielded GKE Nodes in a cluster, any nodes created in a Node pool without Shielded GKE Nodes enabled, or created outside of any Node pool, aren't able to join the cluster.</xhtml:p>
                <xhtml:p>Shielded GKE Nodes can only be used with Container-Optimized OS (COS), COS with containerd, and Ubuntu node images.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745255" value-id="xccdf_org.cisecurity.benchmarks_value_1745255_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745255"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5.6_Ensure_Integrity_Monitoring_for_Shielded_GKE_Nodes_is_Enabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable Integrity Monitoring for Shielded GKE Nodes to be notified of inconsistencies during the node boot sequence.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Perform Automated Vulnerability Scans of Internal Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:7:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Identify</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Perform Automated Vulnerability Scans of Externally-Exposed Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:7:6">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Identify</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Securely Store Master Images" urn="urn:cisecurity.org:controls:7.0:5:3">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Ensure Explicit Error Checking is Performed for All In-house Developed Software" urn="urn:cisecurity.org:controls:7.0:18:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Integrity Monitoring provides active alerting for Shielded GKE nodes which allows administrators to respond to integrity failures and prevent compromised nodes from being deployed into the cluster.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes#system_integrity_monitoring</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Once a Node pool is provisioned, it cannot be updated to enable Integrity Monitoring. You must create new Node pools within the cluster with Integrity Monitoring enabled</xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>From the list of clusters, click on the cluster requiring the update and click ADD NODE POOL</xhtml:li>
                <xhtml:li>Ensure that the 'Integrity monitoring' checkbox is checked under the 'Shielded options' Heading.</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>You will also need to migrate workloads from existing non-conforming Node pools to the newly created Node pool, then the non-conforming pools.</xhtml:p>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To create a Node pool within the cluster with Integrity Monitoring enabled, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container node-pools create [NODEPOOL_NAME] \                <br/>
  --cluster [CLUSTER_NAME] --zone [COMPUTE_ZONE] \                <br/>
  --shielded-integrity-monitoring 
              </xhtml:code>
              <xhtml:p>You will also need to migrate workloads from existing non-conforming Node pools to the newly created Node pool, then delete the non-conforming pools.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745256" value-id="xccdf_org.cisecurity.benchmarks_value_1745256_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745256"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5.7_Ensure_Secure_Boot_for_Shielded_GKE_Nodes_is_Enabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure Secure Boot for Shielded GKE Nodes is Enabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable Secure Boot for Shielded GKE Nodes to verify the digital signature of node boot components.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Perform Automated Vulnerability Scans of Internal Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:7:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Identify</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Perform Automated Vulnerability Scans of Externally-Exposed Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:7:6">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Identify</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Securely Store Master Images" urn="urn:cisecurity.org:controls:7.0:5:3">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>An attacker may seek to alter boot components to persist malware or root kits during system initialisation. Secure Boot helps ensure that the system only runs authentic software by verifying the digital signature of all boot components, and halting the boot process if signature verification fails.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes#secure_boot</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Once a Node pool is provisioned, it cannot be updated to enable Secure Boot. You must create new Node pools within the cluster with Secure Boot enabled.</xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>From the list of clusters, click on the cluster requiring the update and click ADD NODE POOL</xhtml:li>
                <xhtml:li>Ensure that the 'Secure boot' checkbox is checked under the 'Shielded options' Heading</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>You will also need to migrate workloads from existing non-conforming Node pools to the newly created Node pool, then delete the non-conforming pools.</xhtml:p>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To create a Node pool within the cluster with Secure Boot enabled, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container node-pools create [NODEPOOL_NAME] \                <br/>
  --cluster [CLUSTER_NAME] --zone [COMPUTE_ZONE] \                <br/>
  --shielded-secure-boot
              </xhtml:code>
              <xhtml:p>You will also need to migrate workloads from existing non-conforming Node pools to the newly created Node pool, then delete the non-conforming pools.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Secure Boot will not permit the use of third-party unsigned kernel modules.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745257" value-id="xccdf_org.cisecurity.benchmarks_value_1745257_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745257"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.6_Cluster_Networking">
      <xccdf:title xml:lang="en">Cluster Networking</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to network security configurations in GKE.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6.1_Enable_VPC_Flow_Logs_and_Intranode_Visibility" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Enable VPC Flow Logs and Intranode Visibility</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable VPC Flow Logs and Intranode Visibility to see pod-level traffic, even for traffic within a worker node.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Enabling Intranode Visibility makes your intranode pod to pod traffic visible to the networking fabric. With this feature, you can use VPC Flow Logs or other VPC features for intranode traffic.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/intranode-visibility</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select Kubernetes clusters for which intranode visibility is disabled</xhtml:li>
                <xhtml:li>Click on EDIT</xhtml:li>
                <xhtml:li>Set 'Intranode visibility' to 'Enabled'</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To enable intranode visibility on an existing cluster, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container clusters update [CLUSTER_NAME] \                <br/>
    --enable-intra-node-visibility
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>This is a beta feature. Enabling it on existing cluster causes the cluster master and the cluster nodes to restart, which might cause disruption.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745258" value-id="xccdf_org.cisecurity.benchmarks_value_1745258_var"/>
          <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745258"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6.2_Ensure_use_of_VPC-native_clusters" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure use of VPC-native clusters</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Create Alias IPs for the node network CIDR range in order to subsequently configure IP-based policies and firewalling for pods. A cluster that uses Alias IPs is called a 'VPC-native' cluster.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Perform Traffic Filtering Between Network Segments" urn="urn:cisecurity.org:controls:8.0:13:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:control title="Secure Configuration for Network Devices, such as Firewalls, Routers and Switches" urn="urn:cisecurity.org:controls:7.0:11"/>
              <controls:safeguard title="Segment the Network Based on Sensitivity" urn="urn:cisecurity.org:controls:7.0:14:1">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Using Alias IPs has several benefits:</xhtml:p>
          <xhtml:ul>
            <xhtml:li>Pod IPs are reserved within the network ahead of time, which prevents conflict with other compute resources.</xhtml:li>
            <xhtml:li>The networking layer can perform anti-spoofing checks to ensure that egress traffic is not sent with arbitrary source IPs.</xhtml:li>
            <xhtml:li>Firewall controls for Pods can be applied separately from their nodes.</xhtml:li>
            <xhtml:li>Alias IPs allow Pods to directly access hosted services without using a NAT gateway.</xhtml:li>
          </xhtml:ul>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/11" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/alias-ips</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/vpc/docs/alias-ip</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Use of Alias IPs cannot be enabled on an existing cluster. To create a new cluster using Alias IPs, follow the instructions below.</xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click CREATE CLUSTER</xhtml:li>
                <xhtml:li>Configure your cluster as desired. Then, click 'Availability, networking, security, and additional features'</xhtml:li>
                <xhtml:li>In the 'VPC-native' section, leave 'Enable VPC-native (using alias IP)' selected</xhtml:li>
                <xhtml:li>Click CREATE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To enable Alias IP on a new cluster, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters create [CLUSTER_NAME] \                <br/>
  --zone [COMPUTE_ZONE] \                <br/>
  --enable-ip-alias
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You cannot currently migrate an existing cluster that uses routes for Pod routing to a cluster that uses Alias IPs.</xhtml:p>
                <xhtml:p>Cluster IPs for internal services remain only available from within the cluster. If you want to access a Kubernetes Service from within the VPC, but from outside of the cluster, use an internal load balancer.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745259" value-id="xccdf_org.cisecurity.benchmarks_value_1745259_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745259"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6.3_Ensure_Master_Authorized_Networks_is_Enabled" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure Master Authorized Networks is Enabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable Master Authorized Networks to restrict access to the cluster's control plane (master endpoint) to only an allowlist (whitelist) of authorized IPs.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Authorized networks are a way of specifying a restricted range of IP addresses that are permitted to access your cluster's control plane. Kubernetes Engine uses both Transport Layer Security (TLS) and authentication to provide secure access to your cluster's control plane from the public internet. This provides you the flexibility to administer your cluster from anywhere; however, you might want to further restrict access to a set of IP addresses that you control. You can set this restriction by specifying an authorized network.</xhtml:p>
          <xhtml:p>Master Authorized Networks blocks untrusted IP addresses. Google Cloud Platform IPs (such as traffic from Compute Engine VMs) can reach your master through HTTPS provided that they have the necessary Kubernetes credentials.</xhtml:p>
          <xhtml:p>Restricting access to an authorized network can provide additional security benefits for your container cluster, including:</xhtml:p>
          <xhtml:ul>
            <xhtml:li>Better protection from outsider attacks: Authorized networks provide an additional layer of security by limiting external, non-GCP access to a specific set of addresses you designate, such as those that originate from your premises. This helps protect access to your cluster in the case of a vulnerability in the cluster's authentication or authorization mechanism.</xhtml:li>
            <xhtml:li>Better protection from insider attacks: Authorized networks help protect your cluster from accidental leaks of master certificates from your company's premises. Leaked certificates used from outside GCP and outside the authorized IP ranges (for example, from addresses outside your company) are still denied access.</xhtml:li>
          </xhtml:ul>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/authorized-networks</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select Kubernetes clusters for which Master Authorized Networks is disabled</xhtml:li>
                <xhtml:li>Click on EDIT</xhtml:li>
                <xhtml:li>Set 'Master authorized networks' to 'Enabled' and add authorize networks</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To enable Master Authorized Networks for an existing cluster, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters update [CLUSTER_NAME] \                <br/>
  --zone [COMPUTE_ZONE] \                <br/>
  --enable-master-authorized-networks
              </xhtml:code>
              <xhtml:p>
Along with this, you can list authorized networks using the                 <xhtml:span class="inline_block">--master-authorized-networks</xhtml:span>
 flag which contains a list of up to 20 external networks that are allowed to connect to your cluster's control plane through HTTPS. You provide these networks as a comma-separated list of addresses in CIDR notation (such as                 <xhtml:span class="inline_block">90.90.100.0/24</xhtml:span>
).              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>When implementing Master Authorized Networks, be careful to ensure all desired networks are on the allowlist (whitelist) to prevent inadvertently blocking external access to your cluster's control plane.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745260" value-id="xccdf_org.cisecurity.benchmarks_value_1745260_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745260"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6.4_Ensure_clusters_are_created_with_Private_Endpoint_Enabled_and_Public_Access_Disabled" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable access to the Kubernetes API from outside the node network if it is not required.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Deploy Port Level Access Control" urn="urn:cisecurity.org:controls:7.0:1:7">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>In a private cluster, the master node has two endpoints, a private and public endpoint. The private endpoint is the internal IP address of the master, behind an internal load balancer in the master's VPC network. Nodes communicate with the master using the private endpoint. The public endpoint enables the Kubernetes API to be accessed from outside the master's VPC network.</xhtml:p>
          <xhtml:p>Although Kubernetes API requires an authorized token to perform sensitive actions, a vulnerability could potentially expose the Kubernetes publically with unrestricted access. Additionally, an attacker may be able to identify the current cluster and Kubernetes API version and determine whether it is vulnerable to an attack. Unless required, disabling public endpoint will help prevent such threats, and require the attacker to be on the master's VPC network to perform any attack on the Kubernetes API.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/1/subcontrol/7" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Once a cluster is created without enabling Private Endpoint only, it cannot be remediated. Rather, the cluster must be recreated.</xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click CREATE CLUSTER</xhtml:li>
                <xhtml:li>Configure the cluster as desired then click 'Availability, networking, security, and additional features'</xhtml:li>
                <xhtml:li>Under 'Network Security' ensure the 'Private cluster' checkbox is checked</xhtml:li>
                <xhtml:li>Clear the 'Access master using its external IP address' checkbox.</xhtml:li>
                <xhtml:li>Configure other settings as required</xhtml:li>
                <xhtml:li>Click CREATE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>
Create a cluster with a Private Endpoint enabled and Public Access disabled by including the                 <xhtml:span class="inline_block">--enable-private-endpoint</xhtml:span>
 flag within the cluster create command:              </xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters create [CLUSTER_NAME] \                <br/>
  --enable-private-endpoint
              </xhtml:code>
              <xhtml:p>
Setting this flag also requires the setting of                 <xhtml:span class="inline_block">--enable-private-nodes</xhtml:span>
,                 <xhtml:span class="inline_block">--enable-ip-alias</xhtml:span>
 and                 <xhtml:span class="inline_block">--master-ipv4-cidr=[MASTER_CIDR_RANGE]</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>To enable a Private Endpoint, the cluster has to also be configured with private nodes, a private master IP range and IP aliasing enabled.</xhtml:p>
                <xhtml:p>
If the Private Endpoint flag                   <xhtml:span class="inline_block">--enable-private-endpoint</xhtml:span>
 is passed to the gcloud CLI, or the external IP address undefined in the Google Cloud Console during cluster creation, then all access from a public IP address is prohibited.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745261" value-id="xccdf_org.cisecurity.benchmarks_value_1745261_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745261"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6.5_Ensure_clusters_are_created_with_Private_Nodes" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure clusters are created with Private Nodes</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable public IP addresses for cluster nodes, so that they only have private IP addresses. Private Nodes are nodes with no public IP addresses.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Manage Access Control for Remote Assets" urn="urn:cisecurity.org:controls:8.0:13:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:control title="Limitation and Control of Network Ports, Protocols, and Services" urn="urn:cisecurity.org:controls:7.0:9"/>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Disabling public IP addresses on cluster nodes restricts access to only internal networks, forcing attackers to obtain local network access before attempting to compromise the underlying Kubernetes hosts.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Once a cluster is created without enabling Private Nodes, it cannot be remediated. Rather the cluster must be recreated.</xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click CREATE CLUSTER</xhtml:li>
                <xhtml:li>Configure the cluster as desired then click 'Availability, networking, security, and additional features'</xhtml:li>
                <xhtml:li>Under 'Network Security' ensure the 'Private cluster' checkbox is checked</xhtml:li>
                <xhtml:li>Configure other settings as required</xhtml:li>
                <xhtml:li>Click CREATE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>
To create a cluster with Private Nodes enabled, include the                 <xhtml:span class="inline_block">--enable-private-nodes</xhtml:span>
 flag within the cluster create command:              </xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters create [CLUSTER_NAME]  \                <br/>
  --enable-private-nodes
              </xhtml:code>
              <xhtml:p>
Setting this flag also requires the setting of                 <xhtml:span class="inline_block">--enable-ip-alias</xhtml:span>
 and                 <xhtml:span class="inline_block">--master-ipv4-cidr=[MASTER_CIDR_RANGE]</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>To enable Private Nodes, the cluster has to also be configured with a private master IP range and IP Aliasing enabled.</xhtml:p>
                <xhtml:p>Private Nodes do not have outbound access to the public internet. If you want to provide outbound Internet access for your private nodes, you can use Cloud NAT or you can manage your own NAT gateway.</xhtml:p>
                <xhtml:p>To access Google Cloud APIs and services from private nodes, Private Google Access needs to be set on Kubernetes Engine Cluster Subnets.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745262" value-id="xccdf_org.cisecurity.benchmarks_value_1745262_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745262"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6.6_Consider_firewalling_GKE_worker_nodes" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Consider firewalling GKE worker nodes</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Reduce the network attack surface of GKE nodes by using Firewalls to restrict ingress and egress traffic.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Implement and Manage a Firewall on Servers" urn="urn:cisecurity.org:controls:8.0:4:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Implement Application Firewalls" urn="urn:cisecurity.org:controls:7.0:9:5">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Utilizing stringent ingress and egress firewall rules minimizes the ports and services exposed to an network-based attacker, whilst also restricting egress routes within or out of the cluster in the event that a compromised component attempts to form an outbound connection.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/vpc/docs/firewalls</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/vpc/docs/using-firewalls</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Firewall Rules by visiting                   <xhtml:a href="https://console.cloud.google.com/networking/firewalls/list">https://console.cloud.google.com/networking/firewalls/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click CREATE FIREWALL RULE</xhtml:li>
                <xhtml:li>
Configure the firewall rule as required. Ensure the firewall targets your nodes correctly, either selecting the nodes using tags (under 'Targets', select 'Specified target tags', and set 'Target tags' to                   <xhtml:span class="inline_block">[TAG]</xhtml:span>
), or using the Service account associated with node (under 'Targets', select 'Specified service account', set 'Service account scope' as appropriate, and 'Target service account' to                   <xhtml:span class="inline_block">[SERVICE_ACCOUNT]</xhtml:span>
)                </xhtml:li>
                <xhtml:li>Click CREATE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>
Use the following command to generate firewall rules, setting the variables as appropriate. You may want to use the target                 <xhtml:span class="inline_block">[TAG]</xhtml:span>
 and                 <xhtml:span class="inline_block">[SERVICE_ACCOUNT]</xhtml:span>
 previously identified.              </xhtml:p>
              <xhtml:code class="code_block">
gcloud compute firewall-rules create FIREWALL_RULE_NAME \                <br/>
    --network [NETWORK] \                <br/>
    --priority [PRIORITY] \                <br/>
    --direction [DIRECTION] \                <br/>
    --action [ACTION] \                <br/>
    --target-tags [TAG] \                <br/>
    --target-service-accounts [SERVICE_ACCOUNT] \                <br/>
    --source-ranges [SOURCE_CIDR-RANGE] \                <br/>
    --source-tags [SOURCE_TAGS] \                <br/>
    --source-service-accounts=[SOURCE_SERVICE_ACCOUNT] \                <br/>
    --destination-ranges [DESTINATION_CIDR_RANGE] \                <br/>
    --rules [RULES]
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>All instances targeted by a firewall rule, either using a tag or a service account will be affected. Ensure there are no adverse effects on other instances using the target tag or service account before implementing the firewall rule.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6.7_Ensure_Network_Policy_is_Enabled_and_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure Network Policy is Enabled and set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use Network Policy to restrict pod to pod traffic within a cluster and segregate workloads.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Establish and Maintain a Secure Configuration Process for Network Infrastructure" urn="urn:cisecurity.org:controls:8.0:4:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Apply Host-based Firewalls or Port Filtering" urn="urn:cisecurity.org:controls:7.0:9:4">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>By default, all pod to pod traffic within a cluster is allowed. Network Policy creates a pod-level firewall that can be used to restrict traffic between sources. Pod traffic is restricted by having a Network Policy that selects it (through the use of labels). Once there is any Network Policy in a namespace selecting a particular pod, that pod will reject any connections that are not allowed by any Network Policy. Other pods in the namespace that are not selected by any Network Policy will continue to accept all traffic.</xhtml:p>
          <xhtml:p>Network Policies are managed via the Kubernetes Network Policy API and enforced by a network plugin, simply creating the resource without a compatible network plugin to implement it will have no effect. GKE supports Network Policy enforcement through the use of Calico.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/network-policy</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select the cluster for which Network policy is disabled</xhtml:li>
                <xhtml:li>Click EDIT</xhtml:li>
                <xhtml:li>Set 'Network policy for master' to 'Enabled'</xhtml:li>
                <xhtml:li>Click SAVE</xhtml:li>
                <xhtml:li>Once the cluster has updated, repeat steps 1-3</xhtml:li>
                <xhtml:li>Set 'Network Policy for nodes' to 'Enabled'</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To enable Network Policy for an existing cluster, firstly enable the Network Policy add-on:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters update [CLUSTER_NAME] \                <br/>
  --zone [COMPUTE_ZONE] \                <br/>
  --update-addons NetworkPolicy=ENABLED
              </xhtml:code>
              <xhtml:p>Then, enable Network Policy:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters update [CLUSTER_NAME] \                <br/>
  --zone [COMPUTE_ZONE] \                <br/>
  --enable-network-policy
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Network Policy requires the Network Policy add-on. This add-on is included automatically when a cluster with Network Policy is created, but for an existing cluster, needs to be added prior to enabling Network Policy.</xhtml:p>
                <xhtml:p>Enabling/Disabling Network Policy causes a rolling update of all cluster nodes, similar to performing a cluster upgrade. This operation is long-running and will block other operations on the cluster (including delete) until it has run to completion.</xhtml:p>
                <xhtml:p>
If Network Policy is used, a cluster must have at least 2 nodes of type                   <xhtml:span class="inline_block">n1-standard-1</xhtml:span>
 or higher. The recommended minimum size cluster to run Network Policy enforcement is 3                   <xhtml:span class="inline_block">n1-standard-1</xhtml:span>
 instances.                </xhtml:p>
                <xhtml:p>
Enabling Network Policy enforcement consumes additional resources in nodes. Specifically, it increases the memory footprint of the                   <xhtml:span class="inline_block">kube-system</xhtml:span>
 process by approximately 128MB, and requires approximately 300 millicores of CPU.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745263" value-id="xccdf_org.cisecurity.benchmarks_value_1745263_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745263"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.6.8_Ensure_use_of_Google-managed_SSL_Certificates" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure use of Google-managed SSL Certificates</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Encrypt traffic to HTTPS load balancers using Google-managed SSL certificates.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Encrypting traffic between users and your Kubernetes workload is fundamental to protecting data sent over the web.</xhtml:p>
          <xhtml:p>
Google-managed SSL Certificates are provisioned, renewed, and managed for your domain names. This is only available for HTTPS load balancers created using Ingress Resources, and not TCP/UDP load balancers created using Service of             <xhtml:span class="inline_block">type:LoadBalancer</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/managed-certs</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
If services of                 <xhtml:span class="inline_block">type:LoadBalancer</xhtml:span>
 are discovered, consider replacing the Service with an Ingress.              </xhtml:p>
              <xhtml:p>
To configure the Ingress and use Google-managed SSL certificates, follow the instructions as listed at                 <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/managed-certs">https://cloud.google.com/kubernetes-engine/docs/how-to/managed-certs</xhtml:a>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Google-managed SSL Certificates are less flexible than certificates you obtain and manage yourself. Managed certificates support a single, non-wildcard domain. Self-managed certificates can support wildcards and multiple subject alternative names (SANs).</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.7_Logging">
      <xccdf:title xml:lang="en">Logging</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to security-related logging in GKE.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7.1_Ensure_Stackdriver_Kubernetes_Logging_and_Monitoring_is_Enabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure Stackdriver Kubernetes Logging and Monitoring is Enabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Send logs and metrics to a remote aggregator to mitigate the risk of local tampering in the event of a breach.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Collect Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Exporting logs and metrics to a dedicated, persistent datastore such as Stackdriver ensures availability of audit data following a cluster security event, and provides a central location for analysis of log and metric data collated from multiple sources.</xhtml:p>
          <xhtml:p>Currently, there are two mutually exclusive variants of Stackdriver available for use with GKE clusters: Legacy Stackdriver Support and Stackdriver Kubernetes Engine Monitoring Support.</xhtml:p>
          <xhtml:p>Although Stackdriver Kubernetes Engine Monitoring is the preferred option, starting with GKE versions 1.12.7 and 1.13, Legacy Stackdriver is the default option up through GKE version 1.13. The use of either of these services is sufficient to pass the benchmark recommendation.</xhtml:p>
          <xhtml:p>However, note that as Legacy Stackdriver Support is not getting any improvements and lacks features present in Stackdriver Kubernetes Engine Monitoring, Legacy Stackdriver Support may be deprecated in favour of Stackdriver Kubernetes Engine Monitoring Support in future versions of this benchmark.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/monitoring/kubernetes-engine/</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/monitoring/kubernetes-engine/legacy-stackdriver/monitoring</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/monitoring/kubernetes-engine/legacy-stackdriver/logging</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/monitoring/kubernetes-engine/migration</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:p>STACKDRIVER KUBERNETES ENGINE MONITORING SUPPORT (PREFERRED):</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select Kubernetes clusters for which Stackdriver Kubernetes Engine Monitoring is disabled</xhtml:li>
                <xhtml:li>Click on EDIT</xhtml:li>
                <xhtml:li>Set 'Stackdriver Kubernetes Engine Monitoring' to 'Enabled'</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>LEGACY STACKDRIVER SUPPORT:</xhtml:p>
              <xhtml:p>Both Logging and Monitoring support must be enabled.</xhtml:p>
              <xhtml:p>For Logging:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select Kubernetes clusters for which logging is disabled</xhtml:li>
                <xhtml:li>Click on EDIT</xhtml:li>
                <xhtml:li>Set 'Legacy Stackdriver Logging' to 'Enabled'</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>For Monitoring:</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select Kubernetes clusters for which monitoring is disabled</xhtml:li>
                <xhtml:li>Click on EDIT</xhtml:li>
                <xhtml:li>Set 'Legacy Stackdriver Monitoring' to 'Enabled'</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>STACKDRIVER KUBERNETES ENGINE MONITORING SUPPORT (PREFERRED):</xhtml:p>
              <xhtml:p>To enable Stackdriver Kubernetes Engine Monitoring for an existing cluster, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters update [CLUSTER_NAME] \                <br/>
  --zone [COMPUTE_ZONE] \                <br/>
  --enable-stackdriver-kubernetes
              </xhtml:code>
              <xhtml:p>LEGACY STACKDRIVER SUPPORT</xhtml:p>
              <xhtml:p>Both Logging and Monitoring support must be enabled.</xhtml:p>
              <xhtml:p>To enable Legacy Stackdriver Logging for an existing cluster, run the following command:</xhtml:p>
              <xhtml:code class="code_block">gcloud container clusters update [CLUSTER_NAME] --zone [COMPUTE_ZONE] --logging-service logging.googleapis.com
</xhtml:code>
              <xhtml:p>To enable Legacy Stackdriver Monitoring for an existing cluster, run the following command:</xhtml:p>
              <xhtml:code class="code_block">gcloud container clusters update [CLUSTER_NAME] --zone [COMPUTE_ZONE] --monitoring-service monitoring.googleapis.com
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Stackdriver Kubernetes Engine Monitoring and Legacy Stackdriver are incompatible because they have different data models. To move from Legacy Stackdriver to Stackdriver Kubernetes Engine Monitoring, you must manually change a number of your Stackdriver artifacts, including alerting policies, group filters, and log queries. See                   <xhtml:a href="https://cloud.google.com/monitoring/kubernetes-engine/migration">https://cloud.google.com/monitoring/kubernetes-engine/migration</xhtml:a>
.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745264" value-id="xccdf_org.cisecurity.benchmarks_value_1745264_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745264"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745265" value-id="xccdf_org.cisecurity.benchmarks_value_1745265_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745265"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7.2_Enable_Linux_auditd_logging" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Enable Linux auditd logging</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Run the auditd logging daemon to obtain verbose operating system logs from GKE nodes running Container-Optimized OS (COS).</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Auditd logs provide valuable information about the state of the cluster and workloads, such as error messages, login attempts, and binary executions. This information can be used to debug issues or to investigate security incidents.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/linux-auditd-logging</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>Download the example manifests:</xhtml:p>
              <xhtml:code class="code_block">curl https://raw.githubusercontent.com/GoogleCloudPlatform/k8s-node-tools/master/os-audit/cos-auditd-logging.yaml &gt; cos-auditd-logging.yaml
</xhtml:code>
              <xhtml:p>Edit the example manifests if needed. Then, deploy them:</xhtml:p>
              <xhtml:code class="code_block">kubectl apply -f cos-auditd-logging.yaml
</xhtml:code>
              <xhtml:p>
Verify that the logging Pods have started. If you defined a different Namespace in your manifests, replace                 <xhtml:span class="inline_block">cos-auditd</xhtml:span>
 with the name of the namespace you're using:              </xhtml:p>
              <xhtml:code class="code_block">kubectl get pods --namespace=cos-auditd
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Increased logging activity on a node increases resource usage on that node, which may affect the performance of your workload and may incur additional resource costs. Audit logs sent to Stackdriver consume log quota from the project. You may need to increase your log quota and storage to accommodate the additional logs.</xhtml:p>
                <xhtml:p>Note that the provided logging daemonset only works on nodes running Container-Optimized OS (COS).</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.8_Authentication_and_Authorization">
      <xccdf:title xml:lang="en">Authentication and Authorization</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to authentication and authorization in GKE.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8.1_Ensure_Basic_Authentication_using_static_passwords_is_Disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure Basic Authentication using static passwords is Disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable Basic Authentication (basic auth) for API server authentication as it uses static passwords which need to be rotated.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Encrypt or Hash all Authentication Credentials" urn="urn:cisecurity.org:controls:7.0:16:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Basic Authentication allows a user to authenticate to a Kubernetes cluster with a username and static password which is stored in plaintext (without any encryption). Disabling Basic Authentication will prevent attacks like brute force and credential stuffing. It is recommended to disable Basic Authentication and instead use another authentication method such as OpenID Connect.</xhtml:p>
          <xhtml:p>GKE manages authentication via gcloud using the OpenID Connect token method, setting up the Kubernetes configuration, getting an access token, and keeping it up to date. This means Basic Authentication using static passwords and Client Certificate authentication, which both require additional management overhead of key management and rotation, are not necessary and should be disabled.</xhtml:p>
          <xhtml:p>When Basic Authentication is disabled, you will still be able to authenticate to the cluster with other authentication methods, such as OpenID Connect tokens. See also Recommendation 6.8.2 to disable authentication using Client Certificates.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#restrict_authn_methods</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:h4>Using Google Cloud Console:</xhtml:h4>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select the Kubernetes cluster for which Basic Authentication is currently enabled</xhtml:li>
                <xhtml:li>Click on EDIT</xhtml:li>
                <xhtml:li>Set 'Basic authentication' to 'Disabled'</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:h4>Using Command Line:</xhtml:h4>
              <xhtml:p>To update an existing cluster and disable Basic Authentication by removing the static password:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters update [CLUSTER_NAME] \                <br/>
    --no-enable-basic-auth
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Users will no longer be able to authenticate with a static password. You will have to configure and use alternate authentication mechanisms, such as OpenID Connect tokens.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745266" value-id="xccdf_org.cisecurity.benchmarks_value_1745266_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745266"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8.2_Ensure_authentication_using_Client_Certificates_is_Disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure authentication using Client Certificates is Disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable Client Certificates, which require certificate rotation, for authentication. Instead, use another authentication method like OpenID Connect.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:8.0:5:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Use Unique Passwords" urn="urn:cisecurity.org:controls:7.0:4:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Encrypt Transmittal of Username and Authentication Credentials" urn="urn:cisecurity.org:controls:7.0:16:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>With Client Certificate authentication, a client presents a certificate that the API server verifies with the specified Certificate Authority. In GKE, Client Certificates are signed by the cluster root Certificate Authority. When retrieved, the Client Certificate is only base64 encoded and not encrypted.</xhtml:p>
          <xhtml:p>GKE manages authentication via gcloud for you using the OpenID Connect token method, setting up the Kubernetes configuration, getting an access token, and keeping it up to date. This means Basic Authentication using static passwords and Client Certificate authentication, which both require additional management overhead of key management and rotation, are not necessary and should be disabled.</xhtml:p>
          <xhtml:p>When Client Certificate authentication is disabled, you will still be able to authenticate to the cluster with other authentication methods, such as OpenID Connect tokens. See also Recommendation 6.8.1 to disable authentication using static passwords, known as Basic Authentication.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#restrict_authn_methods</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Currently, there is no way to remove a client certificate from an existing cluster. Thus a new cluster must be created.</xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click CREATE CLUSTER</xhtml:li>
                <xhtml:li>Configure as required and the click on 'Availability, networking, security, and additional features' section</xhtml:li>
                <xhtml:li>Ensure that the 'Issue a client certificate' checkbox is not ticked</xhtml:li>
                <xhtml:li>Click CREATE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>Create a new cluster without a Client Certificate:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters create [CLUSTER_NAME] \                 <br/>
 --no-issue-client-certificate
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Users will no longer be able to authenticate with the pre-provisioned x509 certificate. You will have to configure and use alternate authentication mechanisms, such as OpenID Connect tokens.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745267" value-id="xccdf_org.cisecurity.benchmarks_value_1745267_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745267"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8.3_Manage_Kubernetes_RBAC_users_with_Google_Groups_for_GKE" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Manage Kubernetes RBAC users with Google Groups for GKE</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Cluster Administrators should leverage G Suite Groups and Cloud IAM to assign Kubernetes user roles to a collection of users, instead of to individual emails using only Cloud IAM.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Configure Centralized Point of Authentication" urn="urn:cisecurity.org:controls:7.0:16:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Users</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>On- and off-boarding users is often difficult to automate and prone to error. Using a single source of truth for user permissions via G Suite Groups reduces the number of locations that an individual must be off-boarded from, and prevents users gaining unique permissions sets that increase the cost of audit.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control#google-groups-for-gke</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Follow the G Suite Groups instructions at                 <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control#google-groups-for-gke">https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control#google-groups-for-gke</xhtml:a>
.              </xhtml:p>
              <xhtml:p>Then, create a cluster with</xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container clusters create my-cluster \                <br/>
  --security-group="gke-security-groups@[yourdomain.com]"
              </xhtml:code>
              <xhtml:p>
Finally create                 <xhtml:span class="inline_block">Roles</xhtml:span>
,                 <xhtml:span class="inline_block">ClusterRoles</xhtml:span>
,                 <xhtml:span class="inline_block">RoleBindings</xhtml:span>
, and                 <xhtml:span class="inline_block">ClusterRoleBindings</xhtml:span>
 that reference your G Suite Groups.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
When migrating to using security groups, an audit of                   <xhtml:span class="inline_block">RoleBindings</xhtml:span>
 and                   <xhtml:span class="inline_block">ClusterRoleBindings</xhtml:span>
 is required to ensure all users of the cluster are managed using the new groups and not individually.                </xhtml:p>
                <xhtml:p>
When managing                   <xhtml:span class="inline_block">RoleBindings</xhtml:span>
 and                   <xhtml:span class="inline_block">ClusterRoleBindings</xhtml:span>
, be wary of inadvertently removing bindings required by service accounts.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.8.4_Ensure_Legacy_Authorization_ABAC_is_Disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure Legacy Authorization (ABAC) is Disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Legacy Authorization, also known as Attribute-Based Access Control (ABAC) has been superseded by Role-Based Access Control (RBAC) and is not under active development. RBAC is the recommended way to manage permissions in Kubernetes.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:control title="Controlled Use of Administrative Privileges" urn="urn:cisecurity.org:controls:7.0:4"/>
              <controls:control title="Account Monitoring and Control" urn="urn:cisecurity.org:controls:7.0:16"/>
            </controls:framework>
          </controls:cis_controls>
          <notes:notes xml:lang="en">
            <xhtml:p>
On clusters running GKE 1.6 or 1.7, Kubernetes Service accounts have full permissions on the Kubernetes API by default. To ensure that your role-based access control permissions take effect for a Kubernetes service account, you must create or update your cluster with the option               <xhtml:span class="inline_block">--no-enable-legacy-authorization</xhtml:span>
. This requirement is removed for clusters running GKE version 1.8 or higher.            </xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>In Kubernetes, RBAC is used to grant permissions to resources at the cluster and namespace level. RBAC allows you to define roles with rules containing a set of permissions, whilst the legacy authorizer (ABAC) in Kubernetes Engine grants broad, statically defined permissions. As RBAC provides significant security advantages over ABAC, it is recommended option for access control. Where possible, legacy authorization must be disabled for GKE clusters.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#leave_abac_disabled_default_for_110</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select Kubernetes clusters for which Legacy Authorization is enabled</xhtml:li>
                <xhtml:li>Click EDIT</xhtml:li>
                <xhtml:li>Set 'Legacy Authorization' to 'Disabled'</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To disable Legacy Authorization for an existing cluster, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters update [CLUSTER_NAME] \                <br/>
  --zone [COMPUTE_ZONE] \                <br/>
  --no-enable-legacy-authorization
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Once the cluster has the legacy authorizer disabled, you must grant your user the ability to create authorization roles using RBAC to ensure that your role-based access control permissions take effect.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745268" value-id="xccdf_org.cisecurity.benchmarks_value_1745268_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745268"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.9_Storage">
      <xccdf:title xml:lang="en">Storage</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to security-related configurations for storage in GKE.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.9.1_Enable_Customer-Managed_Encryption_Keys_CMEK_for_GKE_Persistent_Disks_PD" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Enable Customer-Managed Encryption Keys (CMEK) for GKE Persistent Disks (PD)</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use Customer-Managed Encryption Keys (CMEK) to encrypt node boot and dynamically-provisioned attached Google Compute Engine Persistent Disks (PDs) using keys managed within Cloud Key Management Service (Cloud KMS).</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Encrypt Sensitive Information at Rest" urn="urn:cisecurity.org:controls:7.0:14:8">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>GCE persistent disks are encrypted at rest by default using envelope encryption with keys managed by Google. For additional protection, users can manage the Key Encryption Keys using Cloud KMS.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/using-cmek</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/compute/docs/disks/customer-managed-encryption</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/security/encryption-at-rest/default-encryption/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>This cannot be remediated by updating an existing cluster. You must either recreate the desired node pool or create a new cluster.</xhtml:p>
              <xhtml:h4>Using Google Cloud Console:</xhtml:h4>
              <xhtml:p>FOR NODE BOOT DISKS:</xhtml:p>
              <xhtml:p>To create a new node pool,</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select Kubernetes clusters for which node boot disk CMEK is disabled</xhtml:li>
                <xhtml:li>Click ADD NODE POOL</xhtml:li>
                <xhtml:li>Ensure Boot disk type is 'Standard persistent disk' or 'SSD persistent disk'</xhtml:li>
                <xhtml:li>Select 'Enable customer-managed encryption for Boot Disk' and select the Cloud KMS encryption key you desire</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>To create a new cluster,</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click CREATE CLUSTER</xhtml:li>
                <xhtml:li>Under the 'default-pool' heading, click 'More options'</xhtml:li>
                <xhtml:li>In the Node pool edit window, select 'Standard persistent disk' or 'SSD Persistent Disk' as the Boot disk type</xhtml:li>
                <xhtml:li>Select 'Enable customer-managed encryption for Boot Disk' check box and choose the Cloud KMS encryption key you desire</xhtml:li>
                <xhtml:li>Configure the rest of the cluster settings as desired</xhtml:li>
                <xhtml:li>Click CREATE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Click Save.</xhtml:p>
              <xhtml:p>FOR ATTACHED DISKS:</xhtml:p>
              <xhtml:p>This is not possible using Google Cloud Console.</xhtml:p>
              <xhtml:h4>Using Command Line:</xhtml:h4>
              <xhtml:p>FOR NODE BOOT DISKS:</xhtml:p>
              <xhtml:p>
Create a new node pool using customer-managed encryption keys for the node boot disk, of                 <xhtml:span class="inline_block">[DISK_TYPE]</xhtml:span>
 either                 <xhtml:span class="inline_block">pd-standard</xhtml:span>
 or                 <xhtml:span class="inline_block">pd-ssd</xhtml:span>
:              </xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container node-pools create [CLUSTER_NAME] \                <br/>
--disk-type [DISK_TYPE] \                <br/>
--boot-disk-kms-key projects/[KEY_PROJECT_ID]/locations/[LOCATION]/keyRings/[RING_NAME]/cryptoKeys/[KEY_NAME]
              </xhtml:code>
              <xhtml:p>
Create a cluster using customer-managed encryption keys for the node boot disk, of                 <xhtml:span class="inline_block">[DISK_TYPE]</xhtml:span>
 either                 <xhtml:span class="inline_block">pd-standard</xhtml:span>
 or                 <xhtml:span class="inline_block">pd-ssd</xhtml:span>
:              </xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container clusters create [CLUSTER_NAME] \                <br/>
--disk-type [DISK_TYPE] \                <br/>
--boot-disk-kms-key projects/[KEY_PROJECT_ID]/locations/[LOCATION]/keyRings/[RING_NAME]/cryptoKeys/[KEY_NAME]
              </xhtml:code>
              <xhtml:p>FOR ATTACHED DISKS:</xhtml:p>
              <xhtml:p>
Follow the instructions detailed at                 <xhtml:a href="https://cloud.google.com/kubernetes-engine/docs/how-to/using-cmek">https://cloud.google.com/kubernetes-engine/docs/how-to/using-cmek</xhtml:a>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>While GKE CMEK is in beta, encryption of dynamically-provisioned attached disks requires the use of the self-provisioned Compute Engine Persistent Disk CSI Driver v0.5.1 or higher.</xhtml:p>
                <xhtml:p>If you are configuring CMEK with a regional cluster, the cluster must run GKE 1.14 or higher.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.10_Other_Cluster_Configurations">
      <xccdf:title xml:lang="en">Other Cluster Configurations</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to any remaining security-related cluster configurations in GKE.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10.1_Ensure_Kubernetes_Web_UI_is_Disabled" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure Kubernetes Web UI is Disabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Kubernetes Web UI (Dashboard) has been a historical source of vulnerability and should only be deployed when necessary.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Ensure Software is Supported by Vendor" urn="urn:cisecurity.org:controls:7.0:2:2">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Identify</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Devices</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Only Use Up-to-date And Trusted Third-Party Components" urn="urn:cisecurity.org:controls:7.0:18:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>You should disable the Kubernetes Web UI (Dashboard) when running on Kubernetes Engine. The Kubernetes Web UI is backed by a highly privileged Kubernetes Service Account.</xhtml:p>
          <xhtml:p>The Google Cloud Console provides all the required functionality of the Kubernetes Web UI and leverages Cloud IAM to restrict user access to sensitive cluster controls and settings.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/2/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#disable_kubernetes_dashboard</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes GCP Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select the Kubernetes cluster for which the web UI is enabled</xhtml:li>
                <xhtml:li>Click EDIT</xhtml:li>
                <xhtml:li>Click on the 'Add-ons' heading to expand, and set 'Kubernetes dashboard' to 'Disabled'</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line:</xhtml:p>
              <xhtml:p>To disable the Kubernetes Dashboard on an existing cluster, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters update [CLUSTER_NAME] \                <br/>
  --zone [ZONE] \                <br/>
  --update-addons=KubernetesDashboard=DISABLED
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Users will be required to manage cluster resources using the Google Cloud Console or the command line. These require appropriate permissions. To use the command line, this requires the installation of the command line client,                   <xhtml:span class="inline_block">kubectl</xhtml:span>
, on the user's device (this is already included in Cloud Shell) and knowledge of command line operations.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745269" value-id="xccdf_org.cisecurity.benchmarks_value_1745269_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745269"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10.2_Ensure_that_Alpha_clusters_are_not_used_for_production_workloads" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that Alpha clusters are not used for production workloads</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Alpha clusters are not covered by an SLA and are not production-ready.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Separate Production and Non-Production Systems" urn="urn:cisecurity.org:controls:8.0:16:8">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Separate Production and Non-Production Systems" urn="urn:cisecurity.org:controls:7.0:18:9">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Alpha clusters are designed for early adopters to experiment with workloads that take advantage of new features before those features are production-ready. They have all Kubernetes API features enabled, but are not covered by the GKE SLA, do not receive security updates, have node auto-upgrade and node auto-repair disabled, and cannot be upgraded. They are also automatically deleted after 30 days.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/concepts/alpha-clusters</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Alpha features cannot be disabled. To remediate, a new cluster must be created.</xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/">https://console.cloud.google.com/kubernetes/</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click CREATE CLUSTER</xhtml:li>
                <xhtml:li>Unless Node Auto-Upgrade and Node Auto-Repair are disabled, under 'Availability, networking, security, and additional features', the option 'Enable Kubernetes alpha features in this cluster' will not be available. Ensure this feature is not checked</xhtml:li>
                <xhtml:li>Click CREATE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line:</xhtml:p>
              <xhtml:p>Upon creating a new cluster</xhtml:p>
              <xhtml:code class="code_block">
gcloud container clusters create [CLUSTER_NAME] \                <br/>
  --zone [COMPUTE_ZONE]
              </xhtml:code>
              <xhtml:p>Do not use the --enable-kubernetes-alpha argument.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Users and workloads will not be able to take advantage of features included within Alpha clusters.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745270" value-id="xccdf_org.cisecurity.benchmarks_value_1745270_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745270"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10.3_Ensure_Pod_Security_Policy_is_Enabled_and_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure Pod Security Policy is Enabled and set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Pod Security Policy should be used to prevent privileged containers where possible and enforce namespace and workload configurations.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:control title="Secure Configuration of Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4"/>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Establish Secure Configurations" urn="urn:cisecurity.org:controls:7.0:5:1">
                <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Deploy System Configuration Management Tools" urn="urn:cisecurity.org:controls:7.0:5:4">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
          <notes:notes xml:lang="en">
            <xhtml:p>Pod Security Policy is Beta in Kubernetes and in GKE. This feature is not covered by any SLA or deprecation policy and might be subject to backward-incompatible changes.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
A Pod Security Policy is a cluster-level resource that controls security sensitive aspects of the pod specification. A             <xhtml:span class="inline_block">PodSecurityPolicy</xhtml:span>
 object defines a set of conditions that a pod must run with in order to be accepted into the system, as well as defaults for the related fields. When a request to create or update a Pod does not meet the conditions in the Pod Security Policy, that request is rejected and an error is returned. The Pod Security Policy admission controller validates requests against available Pod Security Policies.          </xhtml:p>
          <xhtml:p>PodSecurityPolicies specify a list of restrictions, requirements, and defaults for Pods created under the policy. See further details on recommended policies in Recommendation section 5.2.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/pod-security-policies</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:p>There is no means of enabling the Pod Security Policy Admission controller on an existing or new cluster from the console.</xhtml:p>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To enable Pod Security Policy for an existing cluster, run the following command:</xhtml:p>
              <xhtml:code class="code_block">
gcloud beta container clusters update [CLUSTER_NAME] \                <br/>
  --zone [COMPUTE_ZONE] \                <br/>
  --enable-pod-security-policy
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>If you enable the Pod Security Policy controller without first defining and authorizing any actual policies, no users, controllers, or service accounts can create or update Pods. If you are working with an existing cluster, you should define and authorize policies before enabling the controller.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745271" value-id="xccdf_org.cisecurity.benchmarks_value_1745271_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745271"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10.4_Consider_GKE_Sandbox_for_running_untrusted_workloads" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Consider GKE Sandbox for running untrusted workloads</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use GKE Sandbox to restrict untrusted workloads as an additional layer of protection when running in a multi-tenant environment.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Segment Data Processing and Storage Based on Sensitivity" urn="urn:cisecurity.org:controls:8.0:3:12">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Segment the Network Based on Sensitivity" urn="urn:cisecurity.org:controls:7.0:14:1">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Separate Production and Non-Production Systems" urn="urn:cisecurity.org:controls:7.0:18:9">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type/>
                <controls:security_function/>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
          <notes:notes xml:lang="en">
            <xhtml:p>The default node pool (the first node pool in your cluster, created when the cluster is created) cannot use GKE Sandbox.</xhtml:p>
            <xhtml:p>When using GKE Sandbox, your cluster must have at least two node pools. You must always have at least one node pool where GKE Sandbox is disabled. This node pool must contain at least one node, even if all your workloads are sandboxed.</xhtml:p>
            <xhtml:p>
It is optional but recommended that you enable Stackdriver Logging and Stackdriver Monitoring, by adding the flag               <xhtml:span class="inline_block">--enable-stackdriver-kubernetes</xhtml:span>
. gVisor messages are logged.            </xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>GKE Sandbox provides an extra layer of security to prevent untrusted code from affecting the host kernel on your cluster nodes.</xhtml:p>
          <xhtml:p>When you enable GKE Sandbox on a Node pool, a sandbox is created for each Pod running on a node in that Node pool. In addition, nodes running sandboxed Pods are prevented from accessing other GCP services or cluster metadata. Each sandbox uses its own userspace kernel.</xhtml:p>
          <xhtml:p>Multi-tenant clusters and clusters whose containers run untrusted workloads are more exposed to security vulnerabilities than other clusters. Examples include SaaS providers, web-hosting providers, or other organizations that allow their users to upload and run code. A flaw in the container runtime or in the host kernel could allow a process running within a container to 'escape' the container and affect the node's kernel, potentially bringing down the node.</xhtml:p>
          <xhtml:p>The potential also exists for a malicious tenant to gain access to and exfiltrate another tenant's data in memory or on disk, by exploiting such a defect.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/12" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/kubernetes-engine/docs/how-to/sandbox-pods</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Once a node pool is created, GKE Sandbox cannot be enabled, rather a new node pool is required. The default node pool (the first node pool in your cluster, created when the cluster is created) cannot use GKE Sandbox.</xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/">https://console.cloud.google.com/kubernetes/</xhtml:a>
                </xhtml:li>
                <xhtml:li>Click ADD NODE POOL</xhtml:li>
                <xhtml:li>
Configure the Node pool with following settings:
                  <xhtml:ul>
                    <xhtml:li>
For the node version, select                       <xhtml:span class="inline_block">v1.12.6-gke.8</xhtml:span>
 or higher                    </xhtml:li>
                    <xhtml:li>
For the node image, select 'Container-Optimized OS with Containerd (                      <xhtml:span class="inline_block">cos_containerd</xhtml:span>
) (beta)'                    </xhtml:li>
                    <xhtml:li>Under 'Security', select 'Enable sandbox with gVisor'</xhtml:li>
                  </xhtml:ul>
                </xhtml:li>
                <xhtml:li>Configure other Node pool settings as required</xhtml:li>
                <xhtml:li>Click SAVE.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>To enable GKE Sandbox on an existing cluster, a new Node pool must be created.</xhtml:p>
              <xhtml:code class="code_block">
gcloud container node-pools create [NODE_POOL_NAME] \                <br/>
  --zone=[COMPUTE-ZONE] \                <br/>
  --cluster=[CLUSTER_NAME] \                <br/>
  --image-type=cos_containerd \                <br/>
  --sandbox type=gvisor
              </xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Using GKE Sandbox requires the node image to be set to Container-Optimized OS with containerd (                  <xhtml:span class="inline_block">cos_containerd</xhtml:span>
).                </xhtml:p>
                <xhtml:p>It is not currently possible to use GKE Sandbox along with the following Kubernetes features:</xhtml:p>
                <xhtml:ul>
                  <xhtml:li>Accelerators such as GPUs or TPUs</xhtml:li>
                  <xhtml:li>Istio</xhtml:li>
                  <xhtml:li>Monitoring statistics at the level of the Pod or container</xhtml:li>
                  <xhtml:li>Hostpath storage</xhtml:li>
                  <xhtml:li>Per-container PID namespace</xhtml:li>
                  <xhtml:li>CPU and memory limits are only applied for Guaranteed Pods and Burstable Pods, and only when CPU and memory limits are specified for all containers running in the Pod</xhtml:li>
                  <xhtml:li>Pods using PodSecurityPolicies that specify host namespaces, such as hostNetwork, hostPID, or hostIPC</xhtml:li>
                  <xhtml:li>Pods using PodSecurityPolicy settings such as privileged mode</xhtml:li>
                  <xhtml:li>VolumeDevices</xhtml:li>
                  <xhtml:li>Portforward</xhtml:li>
                  <xhtml:li>Linux kernel security modules such as Seccomp, Apparmor, or Selinux Sysctl, NoNewPrivileges, bidirectional MountPropagation, FSGroup, or ProcMount</xhtml:li>
                </xhtml:ul>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10.5_Ensure_use_of_Binary_Authorization" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure use of Binary Authorization</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Binary Authorization helps to protect supply-chain security by only allowing images with verifiable cryptographically signed metadata into the cluster.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Perform Automated Vulnerability Scans of Externally-Exposed Enterprise Assets" urn="urn:cisecurity.org:controls:8.0:7:6">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Identify</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Maintain Secure Images" urn="urn:cisecurity.org:controls:7.0:5:2">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Protect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Binary Authorization provides software supply-chain security for images that you deploy to GKE from Google Container Registry (GCR) or another container image registry.</xhtml:p>
          <xhtml:p>Binary Authorization requires images to be signed by trusted authorities during the development process. These signatures are then validated at deployment time. By enforcing validation, you can gain tighter control over your container environment by ensuring only verified images are integrated into the build-and-release process.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/7/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/binary-authorization/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Using Google Cloud Console</xhtml:p>
              <xhtml:ol>
                <xhtml:li>
Go to Binary Authorization by visiting                   <xhtml:a href="https://console.cloud.google.com/security/binary-authorization">https://console.cloud.google.com/security/binary-authorization</xhtml:a>
                </xhtml:li>
                <xhtml:li>Enable the Binary Authorization API (if disabled)</xhtml:li>
                <xhtml:li>
Go to Kubernetes Engine by visiting                   <xhtml:a href="https://console.cloud.google.com/kubernetes/list">https://console.cloud.google.com/kubernetes/list</xhtml:a>
                </xhtml:li>
                <xhtml:li>Select the Kubernetes cluster for which Binary Authorization is disabled</xhtml:li>
                <xhtml:li>Click EDIT</xhtml:li>
                <xhtml:li>Set 'Binary Authorization' to 'Enabled'</xhtml:li>
                <xhtml:li>Click SAVE</xhtml:li>
                <xhtml:li>
Return to Binary Authorization at                   <xhtml:a href="https://console.cloud.google.com/security/binary-authorization">https://console.cloud.google.com/security/binary-authorization</xhtml:a>
                </xhtml:li>
                <xhtml:li>Set an appropriate policy for your cluster.</xhtml:li>
              </xhtml:ol>
              <xhtml:p>Using Command Line</xhtml:p>
              <xhtml:p>Update the cluster to enable Binary Authorization:</xhtml:p>
              <xhtml:code class="code_block">
gcloud container cluster update [CLUSTER_NAME] \                <br/>
  --zone [COMPUTE-ZONE] \                <br/>
  --enable-binauthz
              </xhtml:code>
              <xhtml:p>
Create a Binary Authorization Policy using the Binary Authorization Policy Reference (                <xhtml:a href="https://cloud.google.com/binary-authorization/docs/policy-yaml-reference">https://cloud.google.com/binary-authorization/docs/policy-yaml-reference</xhtml:a>
) for guidance.              </xhtml:p>
              <xhtml:p>Import the policy file into Binary Authorization:</xhtml:p>
              <xhtml:code class="code_block">gcloud container binauthz policy import [YAML_POLICY]
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Care must be taken when defining policy in order to prevent inadvertent denial of container image deployments. Depending on policy, attestations for existing container images running within the cluster may need to be created before those images are redeployed or pulled as part of the pod churn.</xhtml:p>
                <xhtml:p>To prevent key system images from being denied deployment, consider the use of global policy evaluation mode, which uses a global policy provided by Google and exempts a list of Google-provided system images from further policy evaluation.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:var:1745272" value-id="xccdf_org.cisecurity.benchmarks_value_1745272_var"/>
            <check-content-ref href="CIS_Google_Kubernetes_Engine_(GKE)_Benchmark_v1.2.0-oval.xml" name="oval:org.cisecurity.benchmarks.kubernetes_kubernetes_1:def:1745272"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.10.6_Enable_Cloud_Security_Command_Center_Cloud_SCC" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Enable Cloud Security Command Center (Cloud SCC)</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable Cloud Security Command Center (Cloud SCC) to provide a centralized view of security for your GKE clusters.</xhtml:p>
        </xccdf:description>
        <xccdf:metadata>
          <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
            <controls:framework urn="urn:cisecurity.org:controls:8.0">
              <controls:safeguard title="Monitor Service Providers" urn="urn:cisecurity.org:controls:8.0:15:6">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
            <controls:framework urn="urn:cisecurity.org:controls:7.0">
              <controls:safeguard title="Implement Automated Configuration Monitoring Systems" urn="urn:cisecurity.org:controls:7.0:5:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Applications</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Configure Monitoring Systems to Record Network Packets" urn="urn:cisecurity.org:controls:7.0:12:5">
                <controls:implementation_groups ig2="true" ig3="true"/>
                <controls:asset_type>Network</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
              <controls:safeguard title="Monitor and Block Unauthorized Network Traffic" urn="urn:cisecurity.org:controls:7.0:13:3">
                <controls:implementation_groups ig3="true"/>
                <controls:asset_type>Data</controls:asset_type>
                <controls:security_function>Detect</controls:security_function>
              </controls:safeguard>
            </controls:framework>
          </controls:cis_controls>
          <notes:notes xml:lang="en">
            <xhtml:p>Cloud SCC is only available at the organization level. Your GCP projects must belong to a GCP organization.</xhtml:p>
          </notes:notes>
        </xccdf:metadata>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Cloud Security Command Center (Cloud SCC) is the canonical security and data risk database for GCP. Cloud SCC enables you to understand your security and data attack surface by providing asset inventory, discovery, search, and management.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/15/subcontrol/6" system="http://cisecurity.org/20-cc/v8.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/13/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/12/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://cloud.google.com/security-command-center/</xccdf:ident>
        <xccdf:ident system="URL">https://cloud.google.com/security-command-center/docs/quickstart-scc-setup</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Follow the instructions at                 <xhtml:a href="https://cloud.google.com/security-command-center/docs/quickstart-scc-setup">https://cloud.google.com/security-command-center/docs/quickstart-scc-setup</xhtml:a>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
  </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>0BNDGB1ybrgK2pNdINCNYNK8iZo=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
lWi4T5FvPezc10tozbmW/fqqssxHg3fuoKDeW4904kppmPgidRnrb7F4Iv4QNqpiaSnZM4xmG260
RWGjH1BkZzogYjTdaOUkzXsyKUgl8CKx9dnFd/Jnj8SUoaKC+bX8hXaEbCxUnXI5cxh15BuS7UWJ
5PCsRnpzk5KyQoEDLXCYD5MGra3bVP8unGuljutjj/3a4GJ2/OqkFUmS6vd94qUvz+kmntYZcw48
w1aVUDHNr/lM/LLqYrS1HooB5ah2CnVcUXts2afPBljCYfZKTEZi2woNPnWUAKepCEvKO1IUmhR0
JaO1yY5du0UOhunHizmZM5EBcKbPhFuKlKQ0jQ==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFUjCCBDqgAwIBAgIIPx+qZKptEY4wDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNv
bSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMw
MQYDVQQDEypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMjAw
OTA4MTMzOTM5WhcNMjMxMDI4MDAzMjA1WjCBkzELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE5ldyBZ
b3JrMRcwFQYDVQQHEw5FYXN0IEdyZWVuYnVzaDErMCkGA1UEChMiQ2VudGVyIGZvciBJbnRlcm5l
dCBTZWN1cml0eSwgSW5jLjErMCkGA1UEAxMiQ2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwg
SW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDBp4+sl9kB5JRmnQH0wcbLLz/t
n2HoD6TRl3xJj12V61njBNgaiGzvoSl07sFLnESukb0CU44MzYDoUMdx3HJUcEAeMY/9eITqGUnk
N4WsP145eFqH7FoszOY/4NYlgYMYt8ZP2kRHyim9LpQTLT/1mBaUkY2f2e5uUCootH3iT8W3/sK2
flLzWfLgXTvkhJm4Uvw1RErBFs15+krW0KWtnZ6NmiDhmV0CnFGNnd1meGZPs2sBXEVGLJVSKzoT
G9Ht/oWyRLRcJuXpHoXTYpkqM2MsixmSaJy5b6/D35r0NXHru3p1gkX2a0VgJQxxWqLi3bVPzpl3
PlJu3C8M/FUCAwEAAaOCAYUwggGBMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwMw
DgYDVR0PAQH/BAQDAgeAMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwuZ29kYWRkeS5jb20v
Z2RpZzJzNS02LmNybDBdBgNVHSAEVjBUMEgGC2CGSAGG/W0BBxcCMDkwNwYIKwYBBQUHAgEWK2h0
dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQQBMHYGCCsG
AQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUF
BzAChjRodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0
MB8GA1UdIwQYMBaAFEDCvSeOzDSDMKIz1/tss/C0LIDOMB0GA1UdDgQWBBT7fOf4ISDprbE+qUFe
+friFTKgHjANBgkqhkiG9w0BAQsFAAOCAQEAT0XLw2vmuq6e58bkLDXdqKeGQjREDChLw2Mae9LI
JB93QgdA2OCLA1FwU2s7lawEDcma9wPiugxVGoaQNOfRw2/+cz0xmR3uaKQq6I24dWbHF20N2tSz
1RAAK1lRZKewA1fj+qqKWjzETA0LpqZlaFF+CKBpQcyfYyQRZxpHkB1vvKMf4kMIRKruvl4ixLjN
uAZrbQUWlXuq/MUkVP3FgdxWBPfmMGyngHs4hNMaSQGb1TEhBjj+PGoSunAyaOgO/P94XJPQQX3O
2oNDsPou6gKcNtbZrH+iYTJ8rcqQTontMwSP/HrYj8lgG3neG53vk05p0jCn2M5W0ukJ4LPEnA==
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>