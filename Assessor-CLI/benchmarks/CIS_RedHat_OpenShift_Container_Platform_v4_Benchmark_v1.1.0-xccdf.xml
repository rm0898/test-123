<xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.1.0_CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
  <xccdf:status date="2021-03-22">draft</xccdf:status>
  <xccdf:title xml:lang="en">CIS RedHat OpenShift Container Platform v4 Benchmark</xccdf:title>
  <xccdf:description xml:lang="en">
    <xhtml:p>This document provides prescriptive guidance for establishing a secure configuration posture for OpenShift 4.5 and 4.6</xhtml:p>
    <xhtml:p>**Note: **The set of configuration files mentioned throughout this benchmark are specific to Red Hatâ€™s CNCF certified Kubernetes distribution, Red Hat OpenShift Container Platform.</xhtml:p>
    <xhtml:p>Each section includes information about the default configuration of an OpenShift cluster and a set of recommendations for hardening the configuration, inspired by the CIS Kubernetes benchmark. For each hardening recommendation, information on how to implement the control and/or how to verify or audit the control is provided. In some cases, remediation information is also provided.</xhtml:p>
    <xhtml:p>The majority of the settings in the hardening guide are in place by default. The audit information for these settings is provided so that you can verify that the cluster admin has not made changes that would be less secure than the OpenShift defaults. A small number of items require configuration. Finally, there are some recommendations that require decisions by the customer, such as audit log size, retention and related settings.</xhtml:p>
    <xhtml:p>The recommendations that require decisions based on your needs are:</xhtml:p>
    <xhtml:ul>
      <xhtml:li>Configure encryption of data at rest in etcd datastore</xhtml:li>
      <xhtml:li>Manage Image Provenance</xhtml:li>
      <xhtml:li>Set the --event-qps argument as appropriate</xhtml:li>
      <xhtml:li>Configure the API server audit log retention</xhtml:li>
      <xhtml:li>Configure cluster logging to forward audit logs off the cluster</xhtml:li>
      <xhtml:li>Configure the audit log file size</xhtml:li>
      <xhtml:li>Adjust the garbage collection settings as needed</xhtml:li>
      <xhtml:li>Create custom Security Context Constraints as needed</xhtml:li>
      <xhtml:li>Configure Network Policies as appropriate</xhtml:li>
      <xhtml:li>In OCP 4.6 and above, configure audit policies as appropriate</xhtml:li>
    </xhtml:ul>
  </xccdf:description>
  <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
  <xccdf:version>1.1.0</xccdf:version>
  <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1">
    <xccdf:title xml:lang="en">Level 1</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>Items in this profile intend to:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>be practical and prudent;</xhtml:li>
        <xhtml:li>provide a clear security benefit; and</xhtml:li>
        <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
      </xhtml:ul>
    </xccdf:description>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1_Ensure_that_the_API_server_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.2_Ensure_that_the_API_server_pod_specification_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.3_Ensure_that_the_controller_manager_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.4_Ensure_that_the_controller_manager_pod_specification_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.5_Ensure_that_the_scheduler_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.6_Ensure_that_the_scheduler_pod_specification_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.7_Ensure_that_the_etcd_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.8_Ensure_that_the_etcd_pod_specification_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.9_Ensure_that_the_Container_Network_Interface_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.10_Ensure_that_the_Container_Network_Interface_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.11_Ensure_that_the_etcd_data_directory_permissions_are_set_to_700_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.12_Ensure_that_the_etcd_data_directory_ownership_is_set_to_etcdetcd" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.13_Ensure_that_the_admin.conf_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.14_Ensure_that_the_admin.conf_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.15_Ensure_that_the_scheduler.conf_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.16_Ensure_that_the_scheduler.conf_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.17_Ensure_that_the_controller-manager.conf_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.18_Ensure_that_the_controller-manager.conf_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.19_Ensure_that_the_OpenShift_PKI_directory_and_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.20_Ensure_that_the_OpenShift_PKI_certificate_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.21_Ensure_that_the_OpenShift_PKI_key_file_permissions_are_set_to_600" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_that_anonymous_requests_are_authorized" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_that_the_--basic-auth-file_argument_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.3_Ensure_that_the_--token-auth-file_parameter_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.4_Use_https_for_kubelet_connections" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.5_Ensure_that_the_kubelet_uses_certificates_to_authenticate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.6_Verify_that_the_kubelet_certificate_authority_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.7_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.8_Verify_that_the_Node_authorizer_is_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.9_Verify_that_RBAC_is_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.10_Ensure_that_the_APIPriorityAndFairness_feature_gate_is_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.11_Ensure_that_the_admission_control_plugin_AlwaysAdmit_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.12_Ensure_that_the_admission_control_plugin_AlwaysPullImages_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.13_Ensure_that_the_admission_control_plugin_SecurityContextDeny_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.14_Ensure_that_the_admission_control_plugin_ServiceAccount_is_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.15_Ensure_that_the_admission_control_plugin_NamespaceLifecycle_is_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.16_Ensure_that_the_admission_control_plugin_SecurityContextConstraint_is_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.17_Ensure_that_the_admission_control_plugin_NodeRestriction_is_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.18_Ensure_that_the_--insecure-bind-address_argument_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.19_Ensure_that_the_--insecure-port_argument_is_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.20_Ensure_that_the_--secure-port_argument_is_not_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.21_Ensure_that_the_healthz_endpoint_is_protected_by_RBAC" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.22_Ensure_that_the_--audit-log-path_argument_is_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.23_Ensure_that_the_audit_logs_are_forwarded_off_the_cluster_for_retention" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.24_Ensure_that_the_maximumRetainedFiles_argument_is_set_to_10_or_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.25_Ensure_that_the_maximumFileSizeMegabytes_argument_is_set_to_100_or_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.26_Ensure_that_the_--request-timeout_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.27_Ensure_that_the_--service-account-lookup_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.28_Ensure_that_the_--service-account-key-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.29_Ensure_that_the_--etcd-certfile_and_--etcd-keyfile_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.30_Ensure_that_the_--tls-cert-file_and_--tls-private-key-file_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.31_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.32_Ensure_that_the_--etcd-cafile_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.33_Ensure_that_the_--encryption-provider-config_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.34_Ensure_that_encryption_providers_are_appropriately_configured" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.35_Ensure_that_the_API_Server_only_makes_use_of_Strong_Cryptographic_Ciphers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.1_Ensure_that_garbage_collection_is_configured_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.2_Ensure_that_controller_manager_healthz_endpoints_are_protected_by_RBAC" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.3_Ensure_that_the_--use-service-account-credentials_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.4_Ensure_that_the_--service-account-private-key-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.5_Ensure_that_the_--root-ca-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.7_Ensure_that_the_--bind-address_argument_is_set_to_127.0.0.1" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.1_Ensure_that_the_healthz_endpoints_for_the_scheduler_are_protected_by_RBAC" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.2_Verify_that_the_scheduler_API_service_is_protected_by_authentication_and_authorization" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_that_the_--cert-file_and_--key-file_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_that_the_--client-cert-auth_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_that_the_--auto-tls_argument_is_not_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_that_the_--peer-cert-file_and_--peer-key-file_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_Ensure_that_the_--peer-client-cert-auth_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_that_the_--peer-auto-tls_argument_is_not_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_that_a_minimal_audit_policy_is_created" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_kubelet_service_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Ensure_that_the_kubelet_service_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_If_proxy_kubeconfig_file_exists_ensure_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_If_proxy_kubeconfig_file_exists_ensure_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_the_--kubeconfig_kubelet.conf_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_that_the_--kubeconfig_kubelet.conf_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Ensure_that_the_certificate_authorities_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Ensure_that_the_client_certificate_authorities_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.9_Ensure_that_the_kubelet_--config_configuration_file_has_permissions_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Ensure_that_the_kubelet_configuration_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Ensure_that_the_--anonymous-auth_argument_is_set_to_false" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Verify_that_the_read_only_port_is_not_used_or_is_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Ensure_that_the_--streaming-connection-idle-timeout_argument_is_not_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Ensure_that_the_--protect-kernel-defaults_argument_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Ensure_that_the_--make-iptables-util-chains_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Ensure_that_the_--hostname-override_argument_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.10_Ensure_that_the_--tls-cert-file_and_--tls-private-key-file_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.11_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.12_Verify_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.13_Ensure_that_the_Kubelet_only_makes_use_of_Strong_Cryptographic_Ciphers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_access_to_secrets" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Minimize_access_to_create_pods" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_that_default_service_accounts_are_not_actively_used." selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Minimize_the_admission_of_privileged_containers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Minimize_the_admission_of_containers_with_added_capabilities" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_that_the_CNI_in_use_supports_Network_Policies" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Prefer_using_secrets_as_files_over_secrets_as_environment_variables" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7.1_Create_administrative_boundaries_between_resources_using_namespaces" selected="true"/>
  </xccdf:Profile>
  <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2">
    <xccdf:title xml:lang="en">Level 2</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This profile extends the "Level 1" profile. Items in this profile exhibit one or more of the following characteristics:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>are intended for environments or use cases where security is paramount</xhtml:li>
        <xhtml:li>acts as defense in depth measure</xhtml:li>
        <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
      </xhtml:ul>
    </xccdf:description>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.1_Ensure_that_the_API_server_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.2_Ensure_that_the_API_server_pod_specification_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.3_Ensure_that_the_controller_manager_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.4_Ensure_that_the_controller_manager_pod_specification_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.5_Ensure_that_the_scheduler_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.6_Ensure_that_the_scheduler_pod_specification_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.7_Ensure_that_the_etcd_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.8_Ensure_that_the_etcd_pod_specification_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.9_Ensure_that_the_Container_Network_Interface_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.10_Ensure_that_the_Container_Network_Interface_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.11_Ensure_that_the_etcd_data_directory_permissions_are_set_to_700_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.12_Ensure_that_the_etcd_data_directory_ownership_is_set_to_etcdetcd" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.13_Ensure_that_the_admin.conf_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.14_Ensure_that_the_admin.conf_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.15_Ensure_that_the_scheduler.conf_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.16_Ensure_that_the_scheduler.conf_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.17_Ensure_that_the_controller-manager.conf_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.18_Ensure_that_the_controller-manager.conf_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.19_Ensure_that_the_OpenShift_PKI_directory_and_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.20_Ensure_that_the_OpenShift_PKI_certificate_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1.21_Ensure_that_the_OpenShift_PKI_key_file_permissions_are_set_to_600" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_that_anonymous_requests_are_authorized" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_that_the_--basic-auth-file_argument_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.3_Ensure_that_the_--token-auth-file_parameter_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.4_Use_https_for_kubelet_connections" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.5_Ensure_that_the_kubelet_uses_certificates_to_authenticate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.6_Verify_that_the_kubelet_certificate_authority_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.7_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.8_Verify_that_the_Node_authorizer_is_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.9_Verify_that_RBAC_is_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.10_Ensure_that_the_APIPriorityAndFairness_feature_gate_is_enabled" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.11_Ensure_that_the_admission_control_plugin_AlwaysAdmit_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.12_Ensure_that_the_admission_control_plugin_AlwaysPullImages_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.13_Ensure_that_the_admission_control_plugin_SecurityContextDeny_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.14_Ensure_that_the_admission_control_plugin_ServiceAccount_is_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.15_Ensure_that_the_admission_control_plugin_NamespaceLifecycle_is_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.16_Ensure_that_the_admission_control_plugin_SecurityContextConstraint_is_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.17_Ensure_that_the_admission_control_plugin_NodeRestriction_is_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.18_Ensure_that_the_--insecure-bind-address_argument_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.19_Ensure_that_the_--insecure-port_argument_is_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.20_Ensure_that_the_--secure-port_argument_is_not_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.21_Ensure_that_the_healthz_endpoint_is_protected_by_RBAC" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.22_Ensure_that_the_--audit-log-path_argument_is_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.23_Ensure_that_the_audit_logs_are_forwarded_off_the_cluster_for_retention" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.24_Ensure_that_the_maximumRetainedFiles_argument_is_set_to_10_or_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.25_Ensure_that_the_maximumFileSizeMegabytes_argument_is_set_to_100_or_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.26_Ensure_that_the_--request-timeout_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.27_Ensure_that_the_--service-account-lookup_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.28_Ensure_that_the_--service-account-key-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.29_Ensure_that_the_--etcd-certfile_and_--etcd-keyfile_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.30_Ensure_that_the_--tls-cert-file_and_--tls-private-key-file_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.31_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.32_Ensure_that_the_--etcd-cafile_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.33_Ensure_that_the_--encryption-provider-config_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.34_Ensure_that_encryption_providers_are_appropriately_configured" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2.35_Ensure_that_the_API_Server_only_makes_use_of_Strong_Cryptographic_Ciphers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.1_Ensure_that_garbage_collection_is_configured_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.2_Ensure_that_controller_manager_healthz_endpoints_are_protected_by_RBAC" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.3_Ensure_that_the_--use-service-account-credentials_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.4_Ensure_that_the_--service-account-private-key-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.5_Ensure_that_the_--root-ca-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.6_Ensure_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3.7_Ensure_that_the_--bind-address_argument_is_set_to_127.0.0.1" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.1_Ensure_that_the_healthz_endpoints_for_the_scheduler_are_protected_by_RBAC" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4.2_Verify_that_the_scheduler_API_service_is_protected_by_authentication_and_authorization" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_that_the_--cert-file_and_--key-file_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_that_the_--client-cert-auth_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_that_the_--auto-tls_argument_is_not_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_that_the_--peer-cert-file_and_--peer-key-file_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_Ensure_that_the_--peer-client-cert-auth_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_that_the_--peer-auto-tls_argument_is_not_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_Ensure_that_a_unique_Certificate_Authority_is_used_for_etcd" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Client_certificate_authentication_should_not_be_used_for_users" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_that_a_minimal_audit_policy_is_created" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_that_the_audit_policy_covers_key_security_concerns" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_kubelet_service_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Ensure_that_the_kubelet_service_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.3_If_proxy_kubeconfig_file_exists_ensure_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.4_If_proxy_kubeconfig_file_exists_ensure_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_the_--kubeconfig_kubelet.conf_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_that_the_--kubeconfig_kubelet.conf_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Ensure_that_the_certificate_authorities_file_permissions_are_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Ensure_that_the_client_certificate_authorities_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.9_Ensure_that_the_kubelet_--config_configuration_file_has_permissions_set_to_644_or_more_restrictive" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Ensure_that_the_kubelet_configuration_file_ownership_is_set_to_rootroot" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Ensure_that_the_--anonymous-auth_argument_is_set_to_false" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Verify_that_the_read_only_port_is_not_used_or_is_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Ensure_that_the_--streaming-connection-idle-timeout_argument_is_not_set_to_0" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Ensure_that_the_--protect-kernel-defaults_argument_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Ensure_that_the_--make-iptables-util-chains_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Ensure_that_the_--hostname-override_argument_is_not_set" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.9_Ensure_that_the_kubeAPIQPS_--event-qps_argument_is_set_to_0_or_a_level_which_ensures_appropriate_event_capture" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.10_Ensure_that_the_--tls-cert-file_and_--tls-private-key-file_arguments_are_set_as_appropriate" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.11_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.12_Verify_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2.13_Ensure_that_the_Kubelet_only_makes_use_of_Strong_Cryptographic_Ciphers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_access_to_secrets" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Minimize_access_to_create_pods" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_that_default_service_accounts_are_not_actively_used." selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Minimize_the_admission_of_privileged_containers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.6_Minimize_the_admission_of_root_containers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Minimize_the_admission_of_containers_with_added_capabilities" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2.9_Minimize_the_admission_of_containers_with_capabilities_assigned" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_that_the_CNI_in_use_supports_Network_Policies" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3.2_Ensure_that_all_Namespaces_have_Network_Policies_defined" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Prefer_using_secrets_as_files_over_secrets_as_environment_variables" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.4.2_Consider_external_secret_storage" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.5.1_Configure_Image_Provenance_using_image_controller_configuration_parameters" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7.1_Create_administrative_boundaries_between_resources_using_namespaces" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7.2_Ensure_that_the_seccomp_profile_is_set_to_dockerdefault_in_your_pod_definitions" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7.3_Apply_Security_Context_to_Your_Pods_and_Containers" selected="true"/>
    <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.7.4_The_default_namespace_should_not_be_used" selected="true"/>
  </xccdf:Profile>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473530_var" operator="equals" type="string">
    <title>Ensure that the kubelet service file permissions are set to 644 or more restrictive</title>
    <description>This value is used in Rule: Ensure that the kubelet service file permissions are set to 644 or more restrictive</description>
    <value>644</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473531_var" operator="equals" type="string">
    <title>Ensure that the kubelet service file ownership is set to root:root</title>
    <description>This value is used in Rule: Ensure that the kubelet service file ownership is set to root:root</description>
    <value>root:root</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473532_var" operator="equals" type="string">
    <title>Ensure that the certificate authorities file permissions are set to 644 or more restrictive</title>
    <description>This value is used in Rule: Ensure that the certificate authorities file permissions are set to 644 or more restrictive</description>
    <value>600</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473533_var" operator="equals" type="string">
    <title>Ensure that the client certificate authorities file ownership is set to root:root</title>
    <description>This value is used in Rule: Ensure that the client certificate authorities file ownership is set to root:root</description>
    <value>root:root</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473534_var" operator="equals" type="string">
    <title>Ensure that the kubelet --config configuration file has permissions set to 644 or more restrictive</title>
    <description>This value is used in Rule: Ensure that the kubelet --config configuration file has permissions set to 644 or more restrictive</description>
    <value>600</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473535_var" operator="equals" type="string">
    <title>Ensure that the kubelet configuration file ownership is set to root:root</title>
    <description>This value is used in Rule: Ensure that the kubelet configuration file ownership is set to root:root</description>
    <value>root:root</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1474647_var" operator="pattern match" type="string">
    <title>Ensure that the --anonymous-auth argument is set to false</title>
    <description>This value is used in Rule: Ensure that the --anonymous-auth argument is set to false</description>
    <value>--anonymous-auth=false</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1474648_var" operator="pattern match" type="string">
    <title>Ensure that the --authorization-mode argument is not set to AlwaysAllow</title>
    <description>This value is used in Rule: Ensure that the --authorization-mode argument is not set to AlwaysAllow</description>
    <value>authorization-mode=AlwaysAllow</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1474649_var" operator="pattern match" type="string">
    <title>Ensure that the --client-ca-file argument is set as appropriate</title>
    <description>This value is used in Rule: Ensure that the --client-ca-file argument is set as appropriate</description>
    <value>client-ca-file=/etc/kubernetes/cert/ca.pem</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473543_var" operator="pattern match" type="string">
    <title>Verify that the read only port is not used or is set to 0</title>
    <description>This value is used in Rule: Verify that the read only port is not used or is set to 0</description>
    <value>read-only-port=0</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473544_var" operator="pattern match" type="string">
    <title>Verify that the read only port is not used or is set to 0</title>
    <description>This value is used in Rule: Verify that the read only port is not used or is set to 0</description>
    <value>read-only-port=0</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473539_var" operator="pattern match" type="string">
    <title>Ensure that the --streaming-connection-idle-timeout argument is not set to 0</title>
    <description>This value is used in Rule: Ensure that the --streaming-connection-idle-timeout argument is not set to 0</description>
    <value>streaming-connection-idle-timeout=0</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473540_var" operator="pattern match" type="string">
    <title>Ensure that the kubeAPIQPS [--event-qps] argument is set to 0 or a level which ensures appropriate event capture</title>
    <description>This value is used in Rule: Ensure that the kubeAPIQPS [--event-qps] argument is set to 0 or a level which ensures appropriate event capture</description>
    <value>event-qps=[0-9]</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473541_var" operator="pattern match" type="string">
    <title>Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate</title>
    <description>This value is used in Rule: Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate</description>
    <value>tls-cert-file=/etc/kubernetes/cert/kubelet.pem</value>
  </Value>
  <Value id="xccdf_org.cisecurity.benchmarks_value_1473542_var" operator="pattern match" type="string">
    <title>Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate</title>
    <description>This value is used in Rule: Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate</description>
    <value>tls-private-key-file=/etc/kubernetes/cert/kubelet-key.pem</value>
  </Value>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Control_Plane_Components">
    <xccdf:title xml:lang="en">Control Plane Components</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section consists of security recommendations for the direct configuration of Kubernetes control plane processes. These recommendations assume that the OpenShift cluster has 3 master nodes, as that is the default configuration on installation. These recommendations may not be directly applicable for cluster operators in environments where these components are managed by a 3rd party such as OpenShift Dedicated, Azure Red Hat OpenShift or Red Hat OpenShift Service on AWS.</xhtml:p>
      <xhtml:p>All Audit and Remediation commands assume that you are logged into the OpenShift cluster with the cluster admin role, cluster bound.</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.1_Master_Node_Configuration_Files">
      <xccdf:title xml:lang="en">Master Node Configuration Files</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.1_Ensure_that_the_API_server_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the API server pod specification file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the API server pod specification file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The API server pod specification file controls various parameters that set the behavior of the API server. You should restrict its file permissions to maintain the integrity of the file. The file should be writable only by the administrators on the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/architecture/control-plane.html#defining-masters_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.2_Ensure_that_the_API_server_pod_specification_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the API server pod specification file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the API server pod specification file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The API server pod specification file controls various parameters that set the behavior of the API server. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/architecture/control-plane.html#defining-masters_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.3_Ensure_that_the_controller_manager_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the controller manager pod specification file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the controller manager pod specification file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The controller manager pod specification file controls various parameters that set the behavior of the Controller Manager on the master node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/architecture/control-plane.html#defining-masters_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.4_Ensure_that_the_controller_manager_pod_specification_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the controller manager pod specification file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the controller manager pod specification file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The controller manager pod specification file controls various parameters that set the behavior of various components of the master node. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/architecture/control-plane.html#defining-masters_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.5_Ensure_that_the_scheduler_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the scheduler pod specification file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the scheduler pod specification file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The scheduler pod specification file controls various parameters that set the behavior of the Scheduler service in the master node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/architecture/control-plane.html#defining-masters_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-kube-scheduler-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/nodes/scheduling/nodes-scheduler-about.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-scheduler/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.6_Ensure_that_the_scheduler_pod_specification_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the scheduler pod specification file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the scheduler pod specification file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The scheduler pod specification file controls various parameters that set the behavior of the             <xhtml:span class="inline_block">kube-scheduler</xhtml:span>
 service in the master node. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/architecture/control-plane.html#defining-masters_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-kube-scheduler-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/nodes/scheduling/nodes-scheduler-about.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-scheduler/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.7_Ensure_that_the_etcd_pod_specification_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the etcd pod specification file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">/etc/kubernetes/manifests/etcd.yaml</xhtml:span>
 file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The etcd pod specification file             <xhtml:span class="inline_block">/etc/kubernetes/manifests/etcd.yaml</xhtml:span>
 controls various parameters that set the behavior of the             <xhtml:span class="inline_block">etcd</xhtml:span>
 service in the master node.             <xhtml:span class="inline_block">etcd</xhtml:span>
 is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/architecture/control-plane.html#defining-masters_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/master/bindata/etcd/pod.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://etcd.io/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.8_Ensure_that_the_etcd_pod_specification_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the etcd pod specification file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">/etc/kubernetes/manifests/etcd.yaml</xhtml:span>
 file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The etcd pod specification file             <xhtml:span class="inline_block">/etc/kubernetes/manifests/etcd.yaml</xhtml:span>
 controls various parameters that set the behavior of the             <xhtml:span class="inline_block">etcd</xhtml:span>
 service in the master node.             <xhtml:span class="inline_block">etcd</xhtml:span>
 is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://coreos.com/etcd</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/etcd/</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/architecture/control-plane.html#defining-masters_control-plane</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.9_Ensure_that_the_Container_Network_Interface_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the Container Network Interface file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the Container Network Interface files have permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Container Network Interface provides various networking options for overlay networking. You should consult their documentation and restrict their respective file permissions to maintain the integrity of those files. Those files should be writable by only the administrators on the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/networking/cluster-network-operator.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/cluster-administration/networking/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.10_Ensure_that_the_Container_Network_Interface_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the Container Network Interface file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the Container Network Interface files have ownership set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Container Network Interface provides various networking options for overlay networking. You should consult their documentation and restrict their respective file permissions to maintain the integrity of those files. Those files should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/networking/cluster-network-operator.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/cluster-administration/networking/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.11_Ensure_that_the_etcd_data_directory_permissions_are_set_to_700_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the etcd data directory permissions are set to 700 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the etcd data directory has permissions of             <xhtml:span class="inline_block">700</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">etcd</xhtml:span>
 is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should not be readable or writable by any group members or the world.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/architecture/control-plane.html#defining-masters_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://etcd.io/#data-dir</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
No remediation required. File permissions are managed by the                 <xhtml:span class="inline_block">etcd</xhtml:span>
 operator.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.12_Ensure_that_the_etcd_data_directory_ownership_is_set_to_etcdetcd" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the etcd data directory ownership is set to etcd:etcd</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">etcd</xhtml:span>
 data directory ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">etcd</xhtml:span>
 is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
          <xhtml:p>
NOTE: The only users that exist on an RHCOS OpenShift node are root and core. This is intentional, as regular management of the underlying RHCOS cluster nodes is designed to be performed via the OpenShift API itself. The core user is a member of the wheel group, which gives it permission to use             <xhtml:span class="inline_block">sudo</xhtml:span>
 for running privileged commands. Adding additional users at the node level is highly discouraged.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/architecture/control-plane.html#defining-masters_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://etcd.io/#data-dir</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file ownership is managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.13_Ensure_that_the_admin.conf_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the admin.conf file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">admin.conf</xhtml:span>
 file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">admin.conf</xhtml:span>
 is the administrator             <xhtml:span class="inline_block">kubeconfig</xhtml:span>
 file defining various settings for the administration of the cluster. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/cli_reference/openshift_cli/administrator-cli-commands.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.14_Ensure_that_the_admin.conf_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the admin.conf file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">admin.conf</xhtml:span>
 file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">admin.conf</xhtml:span>
 file contains the admin credentials for the cluster. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/cli_reference/openshift_cli/administrator-cli-commands.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/setup-tools/kubeadm/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.15_Ensure_that_the_scheduler.conf_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the scheduler.conf file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">scheduler.conf</xhtml:span>
 file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">scheduler.conf</xhtml:span>
 file is the             <xhtml:span class="inline_block">kubeconfig</xhtml:span>
 file for the Scheduler. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.4/operators/operator-reference.html#cluster-kube-scheduler-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/nodes/scheduling/nodes-scheduler-about.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/scheduling-eviction/kube-scheduler/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.16_Ensure_that_the_scheduler.conf_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the scheduler.conf file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">scheduler.conf</xhtml:span>
 file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">scheduler.conf</xhtml:span>
 file is the kubeconfig file for the Scheduler. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-kube-scheduler-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.3/nodes/scheduling/nodes-scheduler-about.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/scheduling-eviction/kube-scheduler/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.17_Ensure_that_the_controller-manager.conf_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the controller-manager.conf file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">controller-manager.conf</xhtml:span>
 file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">controller-manager.conf</xhtml:span>
 file is the             <xhtml:span class="inline_block">kubeconfig</xhtml:span>
 file for the Controller Manager. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.18_Ensure_that_the_controller-manager.conf_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the controller-manager.conf file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">controller-manager.conf</xhtml:span>
 file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">controller-manager.conf</xhtml:span>
 file is the             <xhtml:span class="inline_block">kubeconfig</xhtml:span>
 file for the Controller Manager. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.19_Ensure_that_the_OpenShift_PKI_directory_and_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the OpenShift PKI directory and file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the OpenShift PKI directory and file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.20_Ensure_that_the_OpenShift_PKI_certificate_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the OpenShift PKI certificate file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that OpenShift PKI certificate files have permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>OpenShift makes use of a number of certificate files as part of the operation of its components. The permissions on these files should be set to 644 or more restrictive to protect their integrity.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1.21_Ensure_that_the_OpenShift_PKI_key_file_permissions_are_set_to_600" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the OpenShift PKI key file permissions are set to 600</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the OpenShift PKI key files have permissions of             <xhtml:span class="inline_block">600</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
OpenShift makes use of a number of key files as part of the operation of its components. The permissions on these files should be set to             <xhtml:span class="inline_block">600</xhtml:span>
 to protect their integrity and confidentiality.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required; file permissions are managed by the operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.2_API_Server">
      <xccdf:title xml:lang="en">API Server</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to API server configuration flags.</xhtml:p>
        <xhtml:p>
OpenShift includes two API servers, the OpenShift API server and the Kubernetes API server. All API calls are directed to the Open Shift API server and then Kubernetes objects are delegated to           <xhtml:span class="inline_block">kube-apiserver</xhtml:span>
.        </xhtml:p>
        <xhtml:p>
The cluster configuration resource (CR) APIServer holds configuration settings (like serving certificates, client CA and CORS domains) shared by all API servers in the system, among them especially           <xhtml:span class="inline_block">kube-apiserver</xhtml:span>
 and           <xhtml:span class="inline_block">openshift-apiserver</xhtml:span>
. The canonical name of an instance is 'cluster'. Changes to the API server configurations should be done in the APIServer custom resource definition (CRD): apiservers.config.openshift.io        </xhtml:p>
        <xhtml:p>
The OpenShift API Server is managed by the           <xhtml:span class="inline_block">openshift-apiserver-operator</xhtml:span>
        </xhtml:p>
        <xhtml:p>
The Kubernetes API Server is managed by the           <xhtml:span class="inline_block">openshift-kube-apiserver-operator</xhtml:span>
        </xhtml:p>
        <xhtml:p>Both are managed by the Cluster Version Operator</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.1_Ensure_that_anonymous_requests_are_authorized" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that anonymous requests are authorized</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>When anonymous requests to the API server are allowed, they must be authorized.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the API server. You should rely on authentication to authorize anonymous requests.</xhtml:p>
          <xhtml:p>If you are using RBAC authorization, it is generally considered reasonable to allow anonymous access to the API Server for health checks and discovery purposes, and hence this recommendation is not scored. However, you should consider whether anonymous discovery is an acceptable risk for your purposes.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/understanding-authentication.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/using-rbac.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-authentication-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/authentication/#anonymous-requests</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. The default configuration should not be modified.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Anonymous requests are assigned to the                   <xhtml:span class="inline_block">system:unauthenticated</xhtml:span>
 group which allows the system to determine which actions are allowed.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.2_Ensure_that_the_--basic-auth-file_argument_is_not_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --basic-auth-file argument is not set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not use basic authentication.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Basic authentication uses plaintext credentials for authentication. Currently, the basic authentication credentials last indefinitely, and the password cannot be changed without restarting the API server. The basic authentication is currently supported for convenience. Hence, basic authentication should not be used.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/16/subcontrol/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/configuring-internal-oauth.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/understanding-authentication.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-authentication-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/authentication/#static-password-file</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
None required.                 <xhtml:span class="inline_block">--basic-auth-file</xhtml:span>
 cannot be configured on OpenShift.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>OpenShift uses tokens and certificates for authentication.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.3_Ensure_that_the_--token-auth-file_parameter_is_not_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --token-auth-file parameter is not set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not use token based authentication.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The token-based authentication utilizes static tokens to authenticate requests to the             <xhtml:span class="inline_block">apiserver</xhtml:span>
. The tokens are stored in clear-text in a file on the             <xhtml:span class="inline_block">apiserver</xhtml:span>
, and cannot be revoked or rotated without restarting the             <xhtml:span class="inline_block">apiserver</xhtml:span>
. Hence, do not use static token-based authentication.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/16/subcontrol/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/configuring-internal-oauth.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/understanding-authentication.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-authentication-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/authentication/#static-token-file</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None is required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
OpenShift does not use the                   <xhtml:span class="inline_block">token-auth-file</xhtml:span>
 flag. OpenShift includes a built-in OAuth server rather than relying on a static token file. The OAuth server is integrated with the API server.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.4_Use_https_for_kubelet_connections" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Use https for kubelet connections</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use https for kubelet connections.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Connections from             <xhtml:span class="inline_block">apiserver</xhtml:span>
 to             <xhtml:span class="inline_block">kubelets</xhtml:span>
 could potentially carry sensitive data such as secrets and keys. It is thus important to use in-transit encryption for any communication between the             <xhtml:span class="inline_block">apiserver</xhtml:span>
 and             <xhtml:span class="inline_block">kubelets</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L12-L13</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L94-L98</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation is required. OpenShift platform components use X.509 certificates for authentication. OpenShift manages the CAs and certificates for platform components. This is not configurable.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
You require TLS to be configured on                   <xhtml:span class="inline_block">apiserver</xhtml:span>
 as well as                   <xhtml:span class="inline_block">kubelets</xhtml:span>
.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.5_Ensure_that_the_kubelet_uses_certificates_to_authenticate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the kubelet uses certificates to authenticate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable certificate based kubelet authentication.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The apiserver, by default, does not authenticate itself to the kubelet's HTTPS endpoints. The requests from the apiserver are treated anonymously. You should set up certificate-based kubelet authentication to ensure that the apiserver authenticates itself to kubelets when submitting requests.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L12-L13</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L94-L98</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/architecture/control-plane-node-communication/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation is required. OpenShift platform components use X.509 certificates for authentication. OpenShift manages the CAs and certificates for platform components. This is not configurable.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Require TLS to be configured on the apiserver as well as kubelets.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.6_Verify_that_the_kubelet_certificate_authority_is_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Verify that the kubelet certificate authority is set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Verify kubelet's certificate before establishing connection.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubeletâ€™s port-forwarding functionality. These connections terminate at the kubeletâ€™s HTTPS endpoint. By default, the apiserver does not verify the kubeletâ€™s serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/architecture/control-plane-node-communication/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation is required. OpenShift platform components use X.509 certificates for authentication. OpenShift manages the CAs and certificates for platform components. This is not configurable.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You require TLS to be configured on apiserver as well as kubelets.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.7_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --authorization-mode argument is not set to AlwaysAllow</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not always authorize all requests.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The API Server, can be configured to allow all requests. This mode should not be used on any production cluster.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/using-rbac.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/admin/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/authorization/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None. RBAC is always on and the OpenShift API server does not use the values assigned to the flag authorization-mode.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Only authorized requests will be served.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.8_Verify_that_the_Node_authorizer_is_enabled" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Verify that the Node authorizer is enabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Restrict kubelet nodes to reading only objects associated with them.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The Node authorization mode only allows kubelets to read             <xhtml:span class="inline_block">Secret</xhtml:span>
,             <xhtml:span class="inline_block">ConfigMap</xhtml:span>
,             <xhtml:span class="inline_block">PersistentVolume</xhtml:span>
, and 	            <xhtml:span class="inline_block">PersistentVolumeClaim</xhtml:span>
 objects associated with their nodes.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/node/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/46076</xccdf:ident>
        <xccdf:ident system="URL">https://acotten.com/post/kube17-security</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation is required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.9_Verify_that_RBAC_is_enabled" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Verify that RBAC is enabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Turn on Role Based Access Control.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Role Based Access Control (RBAC) allows fine-grained control over the operations that different entities can perform on different objects in the cluster. It is recommended to use the RBAC authorization mode.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/using-rbac.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-authentication-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/bootkube/manifests/cluster-role-binding-kube-apiserver.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L17-L21</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/rbac/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None. It is not possible to disable RBAC.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>When RBAC is enabled you will need to ensure that appropriate RBAC settings (including Roles, RoleBindings and ClusterRoleBindings) are configured to allow appropriate access.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.10_Ensure_that_the_APIPriorityAndFairness_feature_gate_is_enabled" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the APIPriorityAndFairness feature gate is enabled</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Limit the rate at which the API server accepts requests.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Using             <xhtml:span class="inline_block">EventRateLimit</xhtml:span>
 admission control enforces a limit on the number of events that the API Server will accept in a given time slice. A misbehaving workload could overwhelm and DoS the API Server, making it unavailable. This particularly applies to a multi-tenant cluster, where there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. Hence, it is recommended to limit the rate of events that the API server will accept.          </xhtml:p>
          <xhtml:p>Note: This is an Alpha feature in the Kubernetes 1.15 release.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/8/subcontrol/4" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/admission-plug-ins.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L34-L78</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/cluster-administration/flow-control/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#eventratelimit</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#eventratelimit</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/staebler/community/blob/9873b632f4d99b5d99c38c9b15fe2f8b93d0a746/contributors/design-proposals/admission_control_event_rate_limit.md</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation is required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None, as the OpenShift kubelet has been fixed to send fewer requests.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.11_Ensure_that_the_admission_control_plugin_AlwaysAdmit_is_not_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the admission control plugin AlwaysAdmit is not set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not allow all requests.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Setting admission control plugin             <xhtml:span class="inline_block">AlwaysAdmit</xhtml:span>
 allows all requests and does not filter any requests.          </xhtml:p>
          <xhtml:p>
The             <xhtml:span class="inline_block">AlwaysAdmit</xhtml:span>
 admission controller was deprecated in Kubernetes v1.13. Its behavior was equivalent to turning off all admission controllers.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/admission-plug-ins.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L34-L78</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#alwaysadmit</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
No remediation is required. The                 <xhtml:span class="inline_block">AlwaysAdmit</xhtml:span>
 admission controller cannot be enabled in OpenShift.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Only requests explicitly allowed by the admissions control plugins would be served.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.12_Ensure_that_the_admission_control_plugin_AlwaysPullImages_is_not_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the admission control plugin AlwaysPullImages is not set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Always pull images.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Setting admission control policy to             <xhtml:span class="inline_block">AlwaysPullImages</xhtml:span>
 forces every new pod to pull the required images every time. In a multi-tenant cluster users can be assured that their private images can only be used by those who have the credentials to pull them. Without this admission control policy, once an image has been pulled to a node, any pod from any user can use it simply by knowing the imageâ€™s name, without any authorization check against the image ownership. When this plug-in is enabled, images are always pulled prior to starting containers, which means valid credentials are required.          </xhtml:p>
          <xhtml:p>
However, turning on this admission plugin can introduce new kinds of cluster failure modes. OpenShift 4 master and infrastructure components are deployed as pods. Enabling this feature can result in cases where loss of contact to an image registry can cause a redeployed infrastructure pod (            <xhtml:span class="inline_block">oauth-server</xhtml:span>
 for example) to fail on an image pull for an image that is currently present on the node. We use             <xhtml:span class="inline_block">PullIfNotPresent</xhtml:span>
 so that a loss of image registry access does not prevent the pod from starting.  If it becomes             <xhtml:span class="inline_block">PullAlways</xhtml:span>
, then an image registry access outage can cause key infrastructure components to fail.          </xhtml:p>
          <xhtml:p>
This can be managed per container. When OpenShift Container Platform creates containers, it uses the containerâ€™s             <xhtml:span class="inline_block">imagePullPolicy</xhtml:span>
 to determine if the image should be pulled prior to starting the container. There are three possible values for             <xhtml:span class="inline_block">imagePullPolicy</xhtml:span>
:             <xhtml:span class="inline_block">Always</xhtml:span>
,             <xhtml:span class="inline_block">IfNotPresent</xhtml:span>
,             <xhtml:span class="inline_block">Never</xhtml:span>
. If a containerâ€™s             <xhtml:span class="inline_block">imagePullPolicy</xhtml:span>
 parameter is not specified, OpenShift Container Platform sets it based on the imageâ€™s tag. If the tag is latest, OpenShift Container Platform defaults             <xhtml:span class="inline_block">imagePullPolicy</xhtml:span>
 to             <xhtml:span class="inline_block">Always</xhtml:span>
. Otherwise, OpenShift Container Platform defaults             <xhtml:span class="inline_block">imagePullPolicy</xhtml:span>
 to             <xhtml:span class="inline_block">IfNotPresent</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/openshift_images/managing_images/image-pull-policy.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/admission-plug-ins.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L34-L78</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#alwayspullimages</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Credentials would be required to pull the private images every time. Also, in trusted environments, this might increases load on network, registry, and decreases speed.</xhtml:p>
                <xhtml:p>This setting could impact offline or isolated clusters, which have images pre-loaded and do not have access to a registry to pull in-use images. This setting is not appropriate for clusters which use this configuration.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.13_Ensure_that_the_admission_control_plugin_SecurityContextDeny_is_not_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the admission control plugin SecurityContextDeny is not set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">SecurityContextDeny</xhtml:span>
 admission controller can be used to deny pods which make use of some             <xhtml:span class="inline_block">SecurityContext</xhtml:span>
 fields which could allow for privilege escalation in the cluster. This should be used where             <xhtml:span class="inline_block">PodSecurityPolicy</xhtml:span>
 is not in place within the cluster.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">SecurityContextDeny</xhtml:span>
 can be used to provide a layer of security for clusters which do not have             <xhtml:span class="inline_block">PodSecurityPolicies</xhtml:span>
 enabled.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/admission-plug-ins.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L34-L78</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#securitycontextdeny</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#working-with-rbac</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. The Security Context Constraint admission controller cannot be disabled in OpenShift 4.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
The                   <xhtml:span class="inline_block">SecurityContextDeny</xhtml:span>
 admission controller cannot be enabled as it conflicts with the                   <xhtml:span class="inline_block">SecurityContextConstraint</xhtml:span>
 admission controller.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.14_Ensure_that_the_admission_control_plugin_ServiceAccount_is_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the admission control plugin ServiceAccount is set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Automate service accounts management.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>When you create a pod, if you do not specify a service account, it is automatically assigned the default service account in the same namespace. You should create your own service account and let the API server manage its security tokens.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/16" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/understanding-and-creating-service-accounts.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/admission-plug-ins.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L34-L78</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#serviceaccount</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. OpenShift is configured to use service accounts by default.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.15_Ensure_that_the_admission_control_plugin_NamespaceLifecycle_is_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the admission control plugin NamespaceLifecycle is set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Reject creating objects in a namespace that is undergoing termination.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Setting admission control policy to             <xhtml:span class="inline_block">NamespaceLifecycle</xhtml:span>
 ensures that objects cannot be created in non-existent namespaces, and that namespaces undergoing termination are not used for creating the new objects. This is recommended to enforce the integrity of the namespace termination process and also for the availability of the newer objects.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/admission-plug-ins.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L34-L78</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#namespacelifecycle</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Ensure that the                 <xhtml:span class="inline_block">--disable-admission-plugins</xhtml:span>
 parameter does not include                 <xhtml:span class="inline_block">NamespaceLifecycle</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.16_Ensure_that_the_admission_control_plugin_SecurityContextConstraint_is_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the admission control plugin SecurityContextConstraint is set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Reject creating pods that do not match Pod Security Policies.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
A Pod Security Policy is a cluster-level resource that controls the actions that a pod can perform and what it has the ability to access. The             <xhtml:span class="inline_block">PodSecurityPolicy</xhtml:span>
 objects define a set of conditions that a pod must run with in order to be accepted into the system. Pod Security Policies are composed of settings and strategies that control the security features a pod has access to and hence this must be used to control pod access permissions.          </xhtml:p>
          <xhtml:p>
Note: When the             <xhtml:span class="inline_block">PodSecurityPolicy</xhtml:span>
 admission plugin is in use, there needs to be at least one             <xhtml:span class="inline_block">PodSecurityPolicy</xhtml:span>
 in place for ANY pods to be admitted. See section 5.2 for recommendations on             <xhtml:span class="inline_block">PodSecurityPolicy</xhtml:span>
 settings.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/admission-plug-ins.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L34-L78</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#podsecuritypolicy</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. Security Context Constraints are enabled by default in OpenShift and cannot be disabled.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Default Security Context Constraint objects are present on the cluster and granted by default based on roles. Custom SCCs can be created and granted as needed.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.17_Ensure_that_the_admission_control_plugin_NodeRestriction_is_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the admission control plugin NodeRestriction is set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Limit the             <xhtml:span class="inline_block">Node</xhtml:span>
 and             <xhtml:span class="inline_block">Pod</xhtml:span>
 objects that a kubelet could modify.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Using the             <xhtml:span class="inline_block">NodeRestriction</xhtml:span>
 plug-in ensures that the kubelet is restricted to the             <xhtml:span class="inline_block">Node</xhtml:span>
 and             <xhtml:span class="inline_block">Pod</xhtml:span>
 objects that it could modify as defined. Such kubelets will only be allowed to modify their own             <xhtml:span class="inline_block">Node</xhtml:span>
 API object, and only modify             <xhtml:span class="inline_block">Pod</xhtml:span>
 API objects that are bound to their node.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/admission-plug-ins.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/origin/blob/release-4.5/vendor/k8s.io/kubernetes/cmd/kubeadm/app/phases/controlplane/manifests.go#L132</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
The                 <xhtml:span class="inline_block">NodeRestriction</xhtml:span>
 plugin cannot be disabled.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.18_Ensure_that_the_--insecure-bind-address_argument_is_not_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --insecure-bind-address argument is not set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not bind the insecure API service.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
If you bind the             <xhtml:span class="inline_block">apiserver</xhtml:span>
 to an insecure address, basically anyone who could connect to it over the insecure port, would have unauthenticated and unencrypted access to your master node. The             <xhtml:span class="inline_block">apiserver</xhtml:span>
 doesn't do any authentication checking for insecure binds and traffic to the Insecure API port is not encrypted, allowing attackers to potentially read sensitive data in transit.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L104-L105</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Connections to the API server will require valid authentication credentials.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.19_Ensure_that_the_--insecure-port_argument_is_set_to_0" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --insecure-port argument is set to 0</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not bind to insecure port.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Setting up the             <xhtml:span class="inline_block">apiserver</xhtml:span>
 to serve on an insecure port would allow unauthenticated and unencrypted access to your master node. This would allow attackers who could access this port, to easily take control of the cluster.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L102-L103</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L103-L105</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/kube-apiserver/pod.yaml#L155-L157</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. The configuration is managed by the API server operator.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>All components that use the API must connect via the secured port, authenticate themselves, and be authorized to use the API.</xhtml:p>
                <xhtml:p>This includes:</xhtml:p>
                <xhtml:ul>
                  <xhtml:li>kube-controller-manager</xhtml:li>
                  <xhtml:li>kube-proxy</xhtml:li>
                  <xhtml:li>kube-scheduler</xhtml:li>
                  <xhtml:li>kubelets</xhtml:li>
                </xhtml:ul>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.20_Ensure_that_the_--secure-port_argument_is_not_set_to_0" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --secure-port argument is not set to 0</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not disable the secure port.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The secure port is used to serve https with authentication and authorization. If you disable it, no https traffic is served and all traffic is served unencrypted.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L102-L103</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L103-L105</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You need to set the API Server up with the right TLS certificates.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.21_Ensure_that_the_healthz_endpoint_is_protected_by_RBAC" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the healthz endpoint is protected by RBAC</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable profiling, if not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://github.com/openshift/kubernetes-kubelet/blob/master/config/v1beta1/types.go#L259-L277</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/kube-apiserver/pod.yaml#L71-L84</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/community/blob/master/contributors/devel/profiling.md</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required as profiling data is protected by RBAC.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Profiling information would not be available.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.22_Ensure_that_the_--audit-log-path_argument_is_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --audit-log-path argument is set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable auditing on the Kubernetes API Server and set the desired audit log path.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Auditing the Kubernetes API Server provides a security-relevant chronological set of records documenting the sequence of activities that have affected the system by individual users, administrators or other components of the system. Even though currently, Kubernetes provides only basic audit capabilities, it should be enabled. You can enable it by setting an appropriate audit log path.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-audit-log.html</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/master/bindata/v4.1.0/config/defaultconfig.yaml#L22-L31</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/debug-application-cluster/audit/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/features/issues/22</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
None required. This is managed by the cluster                 <xhtml:span class="inline_block">apiserver</xhtml:span>
 operator.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.23_Ensure_that_the_audit_logs_are_forwarded_off_the_cluster_for_retention" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the audit logs are forwarded off the cluster for retention</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Retain the logs for at least 30 days or as appropriate.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Retaining logs for at least 30 days ensures that you can go back in time and investigate or correlate any events. Set your audit log retention period to 30 days or as per your business requirements.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://access.redhat.com/solutions/4262201</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/logging/cluster-logging-external.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-audit-log.html</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L41-L77</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/debug-application-cluster/audit/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/features/issues/22</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Follow the documentation for log forwarding.                 <xhtml:a href="https://docs.openshift.com/container-platform/4.5/logging/cluster-logging-external.html">Forwarding logs to third party systems</xhtml:a>
              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.24_Ensure_that_the_maximumRetainedFiles_argument_is_set_to_10_or_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the maximumRetainedFiles argument is set to 10 or as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Retain 10 or an appropriate number of old log files.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. For example, if you have set file size of 100 MB and the number of old log files to keep as 10, you would have approximately 1 GB of log data that you could potentially use for your analysis.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://access.redhat.com/solutions/4262201</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-audit-log.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/master/bindata/v4.1.0/config/defaultconfig.yaml#L165-168</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-authentication-operator/blob/master/bindata/oauth-apiserver/deploy.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/debug-application-cluster/audit/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/features/issues/22</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Set the                 <xhtml:span class="inline_block">maximumRetainedFiles</xhtml:span>
 parameter to                 <xhtml:span class="inline_block">10</xhtml:span>
 or as an appropriate number of files.              </xhtml:p>
              <xhtml:code class="code_block">maximumRetainedFiles: 10
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.25_Ensure_that_the_maximumFileSizeMegabytes_argument_is_set_to_100_or_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the maximumFileSizeMegabytes argument is set to 100 or as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Rotate log files on reaching 100 MB or as appropriate.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. If you have set file size of 100 MB and the number of old log files to keep as 10, you would have approximately 1 GB of log data that you could potentially use for your analysis.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://access.redhat.com/solutions/4262201</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-audit-log.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/debug-application-cluster/audit/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/features/issues/22</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Set the                 <xhtml:span class="inline_block">audit-log-maxsize</xhtml:span>
 parameter to                 <xhtml:span class="inline_block">100</xhtml:span>
 or as an appropriate number.              </xhtml:p>
              <xhtml:code class="code_block">maximumFileSizeMegabytes: 100
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.26_Ensure_that_the_--request-timeout_argument_is_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --request-timeout argument is set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Set global request timeout for API server requests as appropriate.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Setting global request timeout allows extending the API server request timeout limit to a duration appropriate to the user's connection speed. By default, it is set to 60 seconds which might be problematic on slower connections making cluster resources inaccessible once the data volume for requests exceeds what can be transmitted in 60 seconds. But, setting this timeout limit to be too large can exhaust the API server resources making it prone to Denial-of-Service attack. Hence, it is recommended to set this limit as appropriate and change the default limit of 60 seconds only if needed.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/51415</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>TBD</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.27_Ensure_that_the_--service-account-lookup_argument_is_set_to_true" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --service-account-lookup argument is set to true</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Validate service account before validating token.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
If             <xhtml:span class="inline_block">--service-account-lookup</xhtml:span>
 is not enabled, the             <xhtml:span class="inline_block">apiserver</xhtml:span>
 only verifies that the authentication token is valid, and does not validate that the service account token mentioned in the request is actually present in             <xhtml:span class="inline_block">etcd</xhtml:span>
. This allows using a service account token even after the corresponding service account is deleted. This is an example of time of check to time of use security issue.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/16" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L145-L146</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/24167</xccdf:ident>
        <xccdf:ident system="URL">https://en.wikipedia.org/wiki/Time-of-check_to_time-of-use</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>TBD</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.28_Ensure_that_the_--service-account-key-file_argument_is_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --service-account-key-file argument is set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Explicitly set a service account public key file for service accounts on the apiserver.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
By default, if no             <xhtml:span class="inline_block">--service-account-key-file</xhtml:span>
 is specified to the             <xhtml:span class="inline_block">apiserver</xhtml:span>
, it uses the private key from the TLS serving certificate to verify service account tokens. To ensure that the keys for service account tokens could be rotated as needed, a separate public/private key pair should be used for signing service account tokens. Hence, the public key should be specified to the             <xhtml:span class="inline_block">apiserver</xhtml:span>
 with             <xhtml:span class="inline_block">--service-account-key-file</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/3" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/24167</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
The OpenShift API server does not use the                 <xhtml:span class="inline_block">service-account-key-file</xhtml:span>
 argument. The                 <xhtml:span class="inline_block">ServiceAccount</xhtml:span>
 token                 <xhtml:span class="inline_block">authenticator</xhtml:span>
 is configured with                 <xhtml:span class="inline_block">serviceAccountConfig.publicKeyFiles</xhtml:span>
. OpenShift does not reuse the apiserver TLS key. This is not configurable.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>The corresponding private key must be provided to the controller manager. You would need to securely maintain the key file and rotate the keys based on your organization's key rotation policy.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.29_Ensure_that_the_--etcd-certfile_and_--etcd-keyfile_arguments_are_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">etcd</xhtml:span>
 should be configured to make use of TLS encryption for client connections.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">etcd</xhtml:span>
 is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the             <xhtml:span class="inline_block">etcd</xhtml:span>
 server using a client certificate and key.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.4/security/certificate-types-descriptions.html#etcd-certificates_ocp-certificates</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://etcd.io/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
OpenShift automatically manages TLS and client certificate authentication for                 <xhtml:span class="inline_block">etcd</xhtml:span>
. This is not configurable.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
TLS and client certificate authentication are configured by default for                   <xhtml:span class="inline_block">etcd</xhtml:span>
.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.30_Ensure_that_the_--tls-cert-file_and_--tls-private-key-file_arguments_are_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Setup TLS connection on the API server.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>API server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#user-provided-certificates-for-the-api-server_ocp-certificates</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://rootsquash.com/2016/05/10/securing-the-kubernetes-api/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kelseyhightower/docker-kubernetes-tls-guide</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>OpenShift automatically manages TLS authentication for the API server communication with the node/kublet. This is not configurable.</xhtml:p>
              <xhtml:p>You may optionally set a custom default certificate to be used by the API server when serving content in order to enable clients to access the API server at a different host name or without the need to distribute the cluster-managed certificate authority (CA) certificates to the clients.  Follow the directions in the OpenShift documentation</xhtml:p>
              <xhtml:p>
                <xhtml:a href="https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#user-provided-certificates-for-the-api-server_ocp-certificates">User-provided certificates for the API server</xhtml:a>
              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>TLS and client certificate authentication must be configured for your Kubernetes cluster deployment. By default, OpenShift uses X.509 certificates to provide secure connections between the API server and node/kubelet. OpenShift Container Platform monitors certificates for proper validity, for the cluster certificates it issues and manages. The OpenShift Container Platform manages certificate rotation and the alerting framework has rules to help identify when a certificate issue is about to occur.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.31_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --client-ca-file argument is set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Setup TLS connection on the API server.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
API server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic. If             <xhtml:span class="inline_block">--client-ca-file</xhtml:span>
 argument is set, any request presenting a client certificate signed by one of the authorities in the             <xhtml:span class="inline_block">client-ca-file</xhtml:span>
 is authenticated with an identity corresponding to the CommonName of the client certificate.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#user-provided-certificates-for-the-api-server_ocp-certificates</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://rootsquash.com/2016/05/10/securing-the-kubernetes-api/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kelseyhightower/docker-kubernetes-tls-guide</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>OpenShift automatically manages TLS authentication for the API server communication with the node/kublet. This is not configurable.</xhtml:p>
              <xhtml:p>You may optionally set a custom default certificate to be used by the API server when serving content in order to enable clients to access the API server at a different host name or without the need to distribute the cluster-managed certificate authority (CA) certificates to the clients.</xhtml:p>
              <xhtml:code class="code_block">User-provided certificates must be provided in a kubernetes.io/tls type Secret in the openshift-config namespace. Update the API server cluster configuration, the apiserver/cluster resource, to enable the use of the user-provided certificate.
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>TLS and client certificate authentication must be configured for your Kubernetes cluster deployment. By default, OpenShift uses X.509 certificates to provide secure connections between the API server and node/kubelet. OpenShift Container Platform monitors certificates for proper validity, for the cluster certificates it issues and manages. The OpenShift Container Platform alerting framework has rules to help identify when a certificate issue is about to occur. These rules consist of the following checks:</xhtml:p>
                <xhtml:ul>
                  <xhtml:li>API server client certificate expiration is less than five minutes.</xhtml:li>
                </xhtml:ul>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.32_Ensure_that_the_--etcd-cafile_argument_is_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --etcd-cafile argument is set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">etcd</xhtml:span>
 should be configured to make use of TLS encryption for client connections.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">etcd</xhtml:span>
 is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the             <xhtml:span class="inline_block">etcd</xhtml:span>
 server using a SSL Certificate Authority file.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#etcd-certificates_ocp-certificates</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#etcd-cluster-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://etcd.io/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
None required. OpenShift generates the                 <xhtml:span class="inline_block">etcd-cafile</xhtml:span>
 and sets the arguments appropriately in the API server. Communication with                 <xhtml:span class="inline_block">etcd</xhtml:span>
 is secured by the                 <xhtml:span class="inline_block">etcd</xhtml:span>
 serving CA.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
TLS and client certificate authentication must be configured for                   <xhtml:span class="inline_block">etcd</xhtml:span>
.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.33_Ensure_that_the_--encryption-provider-config_argument_is_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --encryption-provider-config argument is set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Encrypt             <xhtml:span class="inline_block">etcd</xhtml:span>
 key-value store.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">etcd</xhtml:span>
 is a highly available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted at rest to avoid any disclosures.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/5" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/encrypting-etcd.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#etcd-cluster-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/</xccdf:ident>
        <xccdf:ident system="URL">https://acotten.com/post/kube17-security</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/features/issues/92</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Follow the OpenShift documentation for                 <xhtml:a href="https://docs.openshift.com/container-platform/4.5/security/encrypting-etcd.html">Encrypting etcd data | Authentication | OpenShift Container Platform 4.5</xhtml:a>
              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
When you enable                   <xhtml:span class="inline_block">etcd</xhtml:span>
 encryption, the following OpenShift API server and Kubernetes API server resources are encrypted:                </xhtml:p>
                <xhtml:ul>
                  <xhtml:li>Secrets</xhtml:li>
                  <xhtml:li>ConfigMaps</xhtml:li>
                  <xhtml:li>Routes</xhtml:li>
                  <xhtml:li>OAuth access tokens</xhtml:li>
                  <xhtml:li>OAuth authorize tokens</xhtml:li>
                </xhtml:ul>
                <xhtml:p>
When you enable                   <xhtml:span class="inline_block">etcd</xhtml:span>
 encryption, encryption keys are created. These keys are rotated on a weekly basis. You must have these keys in order to restore from an                   <xhtml:span class="inline_block">etcd</xhtml:span>
 backup.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.34_Ensure_that_encryption_providers_are_appropriately_configured" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that encryption providers are appropriately configured</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Where             <xhtml:span class="inline_block">etcd</xhtml:span>
 encryption is used, appropriate providers should be configured.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Where             <xhtml:span class="inline_block">etcd</xhtml:span>
 encryption is used, it is important to ensure that the appropriate set of encryption providers is used. Currently, the             <xhtml:span class="inline_block">aescbc</xhtml:span>
,             <xhtml:span class="inline_block">kms</xhtml:span>
 and             <xhtml:span class="inline_block">secretbox</xhtml:span>
 are likely to be appropriate options.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/5" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/encrypting-etcd.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#etcd-cluster-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/</xccdf:ident>
        <xccdf:ident system="URL">https://acotten.com/post/kube17-security</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/features/issues/92</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/#providers</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Follow the OpenShift documentation for                 <xhtml:a href="https://docs.openshift.com/container-platform/4.5/security/encrypting-etcd.html">Encrypting etcd data | Authentication | OpenShift Container Platform 4.5</xhtml:a>
              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
When you enable                   <xhtml:span class="inline_block">etcd</xhtml:span>
 encryption, the following OpenShift API server and Kubernetes API server resources are encrypted:                </xhtml:p>
                <xhtml:ul>
                  <xhtml:li>Secrets</xhtml:li>
                  <xhtml:li>ConfigMaps</xhtml:li>
                  <xhtml:li>Routes</xhtml:li>
                  <xhtml:li>OAuth access tokens</xhtml:li>
                  <xhtml:li>OAuth authorize tokens</xhtml:li>
                </xhtml:ul>
                <xhtml:p>
When you enable                   <xhtml:span class="inline_block">etcd</xhtml:span>
 encryption, encryption keys are created. These keys are rotated on a weekly basis. You must have these keys in order to restore from an                   <xhtml:span class="inline_block">etcd</xhtml:span>
 backup.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2.35_Ensure_that_the_API_Server_only_makes_use_of_Strong_Cryptographic_Ciphers" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the API Server only makes use of Strong Cryptographic Ciphers</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Ensure that the API server is configured to only use strong cryptographic ciphers.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/networking/ingress-operator.html#nw-ingress-controller-configuration-parameters_configuring-ingress</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/rest_api/config_apis/apiserver-config-openshift-io-v1.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#openshift-apiserver-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#23-use-secure-cipher-suites</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Follow the directions above and in the OpenShift documentation Configuring Ingress.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>API server clients that cannot support the custom cryptographic ciphers will not be able to make connections to the API server.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.3_Controller_Manager">
      <xccdf:title xml:lang="en">Controller Manager</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
This section contains recommendations relating to Controller Manager configuration flags. In OpenShift 4, the Controller Manager is managed with the cluster Controller Manager Operator. There are two operators: the OpenShift Controller operator and the Kube Controller operator. The OpenShift Controller Manager operator manages the OpenShift Controller Manager. The Kubernetes Controller Manager operator manages and updates the           <xhtml:a href="https://github.com/kubernetes/kubernetes">Kubernetes Controller Manager</xhtml:a>
 deployed on top of           <xhtml:a href="https://openshift.io/">OpenShift</xhtml:a>
.  All calls are directed to the OpenShift Controller Manager and then Kubernetes objects are delegated to the Kubernetes Controller Manager.        </xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3.1_Ensure_that_garbage_collection_is_configured_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that garbage collection is configured as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Activate garbage collector on pod termination, as appropriate.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. The current setting for garbage collection is 12,500 terminated pods which might be too high for your system to sustain. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-garbage-collection.html</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/kubernetes-kubelet/blob/origin-4.5-kubernetes-1.18.3/config/v1beta1/types.go#L554-L604</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/28484</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
To configure, follow the directions in                 <xhtml:a href="https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring">Configuring garbage collection for containers and images</xhtml:a>
              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3.2_Ensure_that_controller_manager_healthz_endpoints_are_protected_by_RBAC" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that controller manager healthz endpoints are protected by RBAC</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable profiling, if not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/tree/master</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/bootkube/bootstrap-manifests/kube-controller-manager-pod.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/bootkube/manifests/00_openshift-kube-controller-manager-ns.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/v4.1.0/kube-controller-manager/kubeconfig-cm.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/community/blob/master/contributors/devel/sig-scalability/profiling.md</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required;  profiling is protected by RBAC.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Profiling information would not be available.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3.3_Ensure_that_the_--use-service-account-credentials_argument_is_set_to_true" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --use-service-account-credentials argument is set to true</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use individual service account credentials for each controller.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The controller manager creates a service account per controller in the             <xhtml:span class="inline_block">kube-system</xhtml:span>
 namespace, generates a credential for it, and builds a dedicated API client with that service account credential for each controller loop to use. Setting the             <xhtml:span class="inline_block">--use-service-account-credentials</xhtml:span>
 to true runs each control loop within the controller manager using a separate service account credential. When used in combination with RBAC, this ensures that the control loops run with the minimum permissions required to perform their intended tasks.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/tree/master</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/bootkube/bootstrap-manifests/kube-controller-manager-pod.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/bootkube/config/bootstrap-config-overrides.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/v4.1.0/kube-controller-manager/kubeconfig-cm.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-openshift-controller-manager-operator/blob/release-4.5/bindata/v3.11.0/openshift-controller-manager/ds.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-openshift-controller-manager-operator/blob/release-4.5/bindata/v3.11.0/openshift-controller-manager/sa.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-openshift-controller-manager-operator/blob/release-4.5/bindata/v3.11.0/openshift-controller-manager/separate-sa-role.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-openshift-controller-manager-operator/blob/release-4.5/bindata/v3.11.0/openshift-controller-manager/separate-sa-rolebinding.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/blob/release-1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller-roles.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/blob/release-1.6/plugin/pkg/auth/authorizer/rbac/bootstrappolicy/testdata/controller-role-bindings.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/rbac/#controller-roles</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
The OpenShift Controller Manager operator manages and updates the OpenShift Controller Manager. The Kubernetes Controller Manager operator manages and updates the                 <xhtml:a href="https://github.com/kubernetes/kubernetes">Kubernetes Controller Manager</xhtml:a>
 deployed on top of                 <xhtml:a href="https://openshift.io/">OpenShift</xhtml:a>
. This operator is configured via                 <xhtml:a href="https://github.com/openshift/api/blob/master/operator/v1/types_kubecontrollermanager.go">KubeControllerManager</xhtml:a>
 custom resource.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Whatever authorizer is configured for the cluster, it must grant sufficient permissions to the service accounts to perform their intended tasks. When using the RBAC authorizer, those roles are created and bound to the appropriate service accounts in the                   <xhtml:span class="inline_block">kube-system</xhtml:span>
 namespace automatically with default roles and                   <xhtml:span class="inline_block">rolebindings</xhtml:span>
 that are auto-reconciled on startup.                </xhtml:p>
                <xhtml:p>
If using other authorization methods (ABAC, Webhook, etc), the cluster deployer is responsible for granting appropriate permissions to the service accounts (the required permissions can be seen by inspecting the                   <xhtml:span class="inline_block">controller-roles.yaml</xhtml:span>
 and                   <xhtml:span class="inline_block">controller-role-bindings.yaml</xhtml:span>
 files for the RBAC roles.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3.4_Ensure_that_the_--service-account-private-key-file_argument_is_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --service-account-private-key-file argument is set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Explicitly set a service account private key file for service accounts on the controller manager.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
To ensure that keys for service account tokens can be rotated as needed, a separate public/private key pair should be used for signing service account tokens. The private key should be specified to the controller manager with             <xhtml:span class="inline_block">--service-account-private-key-file</xhtml:span>
 as appropriate.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#service-ca-certificates_ocp-certificates</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/bootkube/bootstrap-manifests/kube-controller-manager-pod.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/bootkube/config/bootstrap-config-overrides.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/v4.1.0/kube-controller-manager/kubeconfig-cm.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. OpenShift manages the service account credentials for the scheduler automatically.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You would need to securely maintain the key file and rotate the keys based on your organization's key rotation policy.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3.5_Ensure_that_the_--root-ca-file_argument_is_set_as_appropriate" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --root-ca-file argument is set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Allow pods to verify the API server's serving certificate before establishing connections.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Processes running within pods that need to contact the API server must verify the API server's serving certificate. Failing to do so could be a subject to man-in-the-middle attacks.</xhtml:p>
          <xhtml:p>
Providing the root certificate for the API server's serving certificate to the controller manager with the             <xhtml:span class="inline_block">--root-ca-file</xhtml:span>
 argument allows the controller manager to inject the trusted bundle into pods so that they can verify TLS connections to the API server.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#service-ca-certificates_ocp-certificates</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/bootkube/bootstrap-manifests/kube-controller-manager-pod.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/bootkube/config/bootstrap-config-overrides.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/v4.1.0/kube-controller-manager/kubeconfig-cm.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/11000</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. Certificates for OpenShift platform components are automatically created and rotated by the OpenShift Container Platform.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>OpenShift clusters manage and maintain certificate authorities and certificates for cluster components.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3.6_Ensure_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the RotateKubeletServerCertificate argument is set to true</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable kubelet server certificate rotation on controller-manager.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">RotateKubeletServerCertificate</xhtml:span>
 causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.          </xhtml:p>
          <xhtml:p>Note: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/bootkube/bootstrap-manifests/kube-controller-manager-pod.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/bootkube/config/bootstrap-config-overrides.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator/blob/release-4.5/bindata/v4.1.0/kube-controller-manager/kubeconfig-cm.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/blob/release-1.11/pkg/kubelet/apis/kubeletconfig/v1beta1/types.go</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/#approval-controller</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/features/issues/267</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/45059</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. Certificates for OpenShift platform components are automatically created and rotated by the OpenShift Container Platform.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3.7_Ensure_that_the_--bind-address_argument_is_set_to_127.0.0.1" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --bind-address argument is set to 127.0.0.1</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not bind the Controller Manager service to non-loopback insecure addresses.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The Controller Manager API service which runs on port 10257/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#cluster-openshift-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/operators/operator-reference.html#kube-controller-manager-operator_red-hat-operators</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-controller-manager-operator</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. The OpenShift operators configure this correctly.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1.4_Scheduler">
      <xccdf:title xml:lang="en">Scheduler</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations relating to Scheduler configuration flags.</xhtml:p>
        <xhtml:p>In OpenShift 4, the Scheduler is managed with the Kubernetes Scheduler Operator. The Kubernetes Scheduler Operator manages and updates the Kubernetes Scheduler deployed on top of OpenShift Container Platform. The operator is installed with the Cluster Version Operator (CVO). The Kubernetes Scheduler Operator contains the following components:</xhtml:p>
        <xhtml:ul>
          <xhtml:li>Operator</xhtml:li>
          <xhtml:li>Bootstrap manifest renderer</xhtml:li>
          <xhtml:li>Installer based on static pods</xhtml:li>
          <xhtml:li>Configuration observer</xhtml:li>
        </xhtml:ul>
        <xhtml:p>By default, the Operator exposes Prometheus metrics through the metrics service</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4.1_Ensure_that_the_healthz_endpoints_for_the_scheduler_are_protected_by_RBAC" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the healthz endpoints for the scheduler are protected by RBAC</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable profiling, if not needed.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-scheduler-operator</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-scheduler-operator/blob/release-4.5/bindata/v4.1.0/kube-scheduler/svc.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-scheduler-operator/blob/release-4.5/bindata/v4.1.0/kube-scheduler/pod.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-scheduler-operator/blob/release-4.5/bindata/v4.1.0/kube-scheduler/pod.yaml#L32-L37</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-scheduler/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/community/blob/master/contributors/devel/profiling.md</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>A fix to this issue: https://bugzilla.redhat.com/show_bug.cgi?id=1889488</xhtml:p>
              <xhtml:p>None required. Profiling is protected by RBAC and cannot be disabled.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Profiling information would not be available.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4.2_Verify_that_the_scheduler_API_service_is_protected_by_authentication_and_authorization" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Verify that the scheduler API service is protected by authentication and authorization</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not bind the scheduler service to non-loopback insecure addresses.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The Scheduler API service which runs on port 10251/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-scheduler-operator</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-scheduler-operator/blob/release-4.5/bindata/v4.1.0/kube-scheduler/svc.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-scheduler-operator/blob/release-4.5/bindata/v4.1.0/kube-scheduler/pod.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-scheduler-operator/blob/release-4.5/bindata/v4.1.0/kube-scheduler/pod.yaml#L32-L37</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-scheduler/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
By default, the                 <xhtml:span class="inline_block">--bind-address</xhtml:span>
 argument is not present, the readinessProbe and                 <xhtml:span class="inline_block">livenessProbe</xhtml:span>
 arguments are set to                 <xhtml:span class="inline_block">10251</xhtml:span>
 and the                 <xhtml:span class="inline_block">port</xhtml:span>
 argument is set to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:p>
              <xhtml:p>Check the status of this issue: https://bugzilla.redhat.com/show_bug.cgi?id=1889488</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_etcd">
    <xccdf:title xml:lang="en">etcd</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section covers recommendations for etcd configuration.
The OpenShift cluster-etcd-operator (CEO) is an operator that handles the scaling of etcd during cluster bootstrap and regular operation. The operator also manages provisioning etcd dependencies such as TLS certificates.</xhtml:p>
      <xhtml:p>OpenShift uses X.509 certificates to provide secure communication to etcd. OpenShift generates these files and sets the arguments appropriately. etcd certificates are used for encrypted communication between etcd member peers, as well as encrypted client traffic. The following certificates are generated and used by etcd and other processes that communicate with etcd:</xhtml:p>
      <xhtml:ul>
        <xhtml:li>Peer certificates: Used for communication between etcd members.</xhtml:li>
        <xhtml:li>Client certificates: Used for encrypted server-client communication. Client certificates are currently used by the API server only, and no other service should connect to etcd directly except for the proxy. Client secrets (etcd-client, etcd-metric-client, etcd-metric-signer, and etcd-signer) are added to the openshift-config, openshift-monitoring, and openshift-kube-apiserver namespaces.</xhtml:li>
        <xhtml:li>Server certificates: Used by the etcd server for authenticating client requests.</xhtml:li>
        <xhtml:li>Metric certificates: All metric consumers connect to proxy with metric-client certificates.</xhtml:li>
      </xhtml:ul>
    </xccdf:description>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1_Ensure_that_the_--cert-file_and_--key-file_arguments_are_set_as_appropriate" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Ensure that the --cert-file and --key-file arguments are set as appropriate</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>
Configure TLS encryption for the           <xhtml:span class="inline_block">etcd</xhtml:span>
 service.        </xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>
          <xhtml:span class="inline_block">etcd</xhtml:span>
 is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit.        </xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#etcd-certificates_ocp-certificates</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/master/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/</xccdf:ident>
      <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>
OpenShift does not use the               <xhtml:span class="inline_block">etcd-certfile</xhtml:span>
 or               <xhtml:span class="inline_block">etcd-keyfil</xhtml:span>
e flags. Certificates for               <xhtml:span class="inline_block">etcd</xhtml:span>
 are managed by the               <xhtml:span class="inline_block">etcd</xhtml:span>
 cluster operator.            </xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Client connections only over TLS would be served.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2_Ensure_that_the_--client-cert-auth_argument_is_set_to_true" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Ensure that the --client-cert-auth argument is set to true</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Enable client authentication on etcd service.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#etcd-certificates_ocp-certificates</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/release-4.5/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/master/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/</xccdf:ident>
      <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/#client-cert-auth</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>This setting is managed by the cluster etcd operator. No remediation required.</xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>All clients attempting to access the etcd server will require a valid client certificate.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3_Ensure_that_the_--auto-tls_argument_is_not_set_to_true" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Ensure that the --auto-tls argument is not set to true</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Do not use self-signed certificates for TLS.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#etcd-certificates_ocp-certificates</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/release-4.5/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/master/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/</xccdf:ident>
      <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/#auto-tls</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>This setting is managed by the cluster etcd operator. No remediation required.</xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Clients will not be able to use self-signed certificates for TLS.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4_Ensure_that_the_--peer-cert-file_and_--peer-key-file_arguments_are_set_as_appropriate" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Ensure that the --peer-cert-file and --peer-key-file arguments are set as appropriate</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>etcd should be configured to make use of TLS encryption for peer connections.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit and also amongst peers in the etcd clusters.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#etcd-certificates_ocp-certificates</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/release-4.5/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/master/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/</xccdf:ident>
      <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>None. This configuration is managed by the etcd operator.</xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>etcd cluster peers are set up TLS for their communication.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5_Ensure_that_the_--peer-client-cert-auth_argument_is_set_to_true" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Ensure that the --peer-client-cert-auth argument is set to true</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>etcd should be configured for peer authentication.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.1"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#etcd-certificates_ocp-certificates</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/release-4.5/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/release-4.5/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/</xccdf:ident>
      <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/#peer-client-cert-auth</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>This setting is managed by the cluster etcd operator. No remediation required.</xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>All peers attempting to communicate with the etcd server require a valid client certificate for authentication.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6_Ensure_that_the_--peer-auto-tls_argument_is_not_set_to_true" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Ensure that the --peer-auto-tls argument is not set to true</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Do not use automatically generated self-signed certificates for TLS connections between peers.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster. Hence, do not use self-signed certificates for authentication.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#etcd-certificates_ocp-certificates</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/release-4.5/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/master/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/#peer-auto-tls</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/#peer-auto-tls</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>This setting is managed by the cluster etcd operator. No remediation required.</xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>All peers attempting to communicate with the etcd server require a valid client certificate for authentication.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
    <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7_Ensure_that_a_unique_Certificate_Authority_is_used_for_etcd" role="unscored" selected="false" weight="0.0">
      <xccdf:title xml:lang="en">Ensure that a unique Certificate Authority is used for etcd</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>Use a different certificate authority for etcd from the one used for Kubernetes.</xhtml:p>
      </xccdf:description>
      <xccdf:rationale xml:lang="en">
        <xhtml:p>etcd is a highly available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. Its access should be restricted to specifically designated clients and peers only.</xhtml:p>
        <xhtml:p>Authentication to etcd is based on whether the certificate presented was issued by a trusted certificate authority. There is no checking of certificate attributes such as common name or subject alternative name. As such, if any attackers were able to gain access to any certificate issued by the trusted certificate authority, they would be able to gain full access to the etcd database.</xhtml:p>
      </xccdf:rationale>
      <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9" system="http://cisecurity.org/20-cc/v6.1"/>
      <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9" system="http://cisecurity.org/20-cc/v7.0"/>
      <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/security/certificate-types-descriptions.html#etcd-certificates_ocp-certificates</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/release-4.5/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://github.com/openshift/cluster-etcd-operator/blob/master/bindata/etcd/pod.yaml#L154-L167</xccdf:ident>
      <xccdf:ident system="URL">https://etcd.io/</xccdf:ident>
      <xccdf:fixtext xml:lang="en">
        <xhtml:div>
          <xhtml:p>
            <xhtml:p>None required. Certificates for etcd are managed by the OpenShift cluster etcd operator.</xhtml:p>
            <xhtml:p class="bold">Impact:</xhtml:p>
            <xhtml:p>
              <xhtml:p>Additional management of the certificates and keys for the dedicated certificate authority will be required.</xhtml:p>
            </xhtml:p>
          </xhtml:p>
        </xhtml:div>
      </xccdf:fixtext>
    </xccdf:Rule>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_Control_Plane_Configuration">
    <xccdf:title xml:lang="en">Control Plane Configuration</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations for cluster-wide areas, such as authentication and logging. Unlike section 1 these recommendations should apply to all deployments.</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.1_Authentication_and_Authorization">
      <xccdf:title xml:lang="en">Authentication and Authorization</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1.1_Client_certificate_authentication_should_not_be_used_for_users" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Client certificate authentication should not be used for users</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Kubernetes provides the option to use client certificates for user authentication. However as there is no way to revoke these certificates when a user leaves an organization or loses their credential, they are not suitable for this purpose.</xhtml:p>
          <xhtml:p>It is not possible to fully disable client certificate use within a cluster as it is used for component to component authentication.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>With any authentication mechanism the ability to revoke credentials if they are compromised or no longer required, is a key control. Kubernetes client certificate authentication does not allow for this due to a lack of support for certificate revocation.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/understanding-identity-provider.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/using-rbac.html#authorization-overview_using-rbac</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/remove-kubeadmin.html</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Configure an identity provider for the OpenShift cluster.                 <xhtml:a href="https://docs.openshift.com/container-platform/4.5/authentication/understanding-identity-provider.html">Understanding identity provider configuration | Authentication | OpenShift Container Platform 4.5</xhtml:a>
. Once an identity provider has been defined, you can use RBAC to define and apply permissions. After you define an identity provider and create a new                 <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 user, remove the                 <xhtml:span class="inline_block">kubeadmin</xhtml:span>
 user to improve cluster security.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>External mechanisms for authentication generally require additional software to be deployed.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3.2_Logging">
      <xccdf:title xml:lang="en">Logging</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.1_Ensure_that_a_minimal_audit_policy_is_created" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that a minimal audit policy is created</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Kubernetes can audit the details of requests made to the API server. The             <xhtml:span class="inline_block">--audit-policy-file</xhtml:span>
 flag must be set for this logging to be enabled.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Logging is an important detective control for all systems, to detect potential unauthorised access.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-audit-log.html</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/master/bindata/v4.1.0/config/defaultconfig.yaml#L17-L31</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/debug-application-cluster/audit/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>No remediation required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Audit logs will be created on the master nodes, which will consume disk space. Care should be taken to avoid generating too large volumes of log information as this could impact the available of the cluster nodes.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2.2_Ensure_that_the_audit_policy_covers_key_security_concerns" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the audit policy covers key security concerns</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Ensure that the audit policy created for the cluster covers key security concerns.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Security audit logs should cover access and modification of key resources in the cluster, to enable them to form an effective part of a security environment.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.6/nodes/nodes/nodes-nodes-audit-config.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-audit-log.html#nodes-pods-audit-log-basic_nodes-nodes-audit-log</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L47-L77</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L34-L78</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/k8scop/k8s-security-dashboard/blob/master/configs/kubernetes/adv-audit.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/debug-application-cluster/audit/#audit-policy</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/falcosecurity/falco/blob/master/examples/k8s_audit_config/audit-policy.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/blob/master/cluster/gce/gci/configure-helper.sh#L735</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>In OpenShift 4.6 and higher, if appropriate for your needs, modify the audit policy.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Increasing audit logging will consume resources on the nodes or other log destinations.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Worker_Nodes">
    <xccdf:title xml:lang="en">Worker Nodes</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section consists of security recommendations for the components that run on Kubernetes worker nodes.</xhtml:p>
      <xhtml:p>Note that these components may also run on Kubernetes master nodes, so the recommendations in this section should be applied to master nodes as well as worker nodes where the master nodes make use of these components.</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.1_Worker_Node_Configuration_Files">
      <xccdf:title xml:lang="en">Worker Node Configuration Files</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section covers recommendations for configuration files on the worker nodes. As the same files exist on the master nodes, the same commands should be run on all nodes.</xhtml:p>
        <xhtml:p>In OpenShift 4, node configuration files are managed by the Machine Config Operator.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.1_Ensure_that_the_kubelet_service_file_permissions_are_set_to_644_or_more_restrictive" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the kubelet service file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Ensure that the kubelet service file has permissions of 644 or more restrictive.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The kubelet service file controls various parameters that set the behavior of the kubelet service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#44-joining-your-nodes</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/setup-tools/kubeadm/#kubelet-drop-in</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
By default, the kubelet service file has permissions of                 <xhtml:span class="inline_block">644</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1473530" value-id="xccdf_org.cisecurity.benchmarks_value_1473530_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473530"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.2_Ensure_that_the_kubelet_service_file_ownership_is_set_to_rootroot" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the kubelet service file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the kubelet service file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The kubelet service file controls various parameters that set the behavior of the kubelet service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#44-joining-your-nodes</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/setup-tools/kubeadm/#kubelet-drop-in</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
By default, the kubelet service file has ownership of                 <xhtml:span class="inline_block">root:root</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks:var:1473531" value-id="xccdf_org.cisecurity.benchmarks_value_1473531_var"/>
          <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473531"/>
        </check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.3_If_proxy_kubeconfig_file_exists_ensure_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">If proxy kubeconfig file exists ensure permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
If             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 is running, and if it is using a file-based kubeconfig file, ensure that the proxy kubeconfig file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 kubeconfig file controls various parameters of the             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.          </xhtml:p>
          <xhtml:p>
It is possible to run             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 with the kubeconfig parameters configured as a Kubernetes ConfigMap instead of a file. In this case, there is no proxy kubeconfig file.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/networking/openshift_sdn/configuring-kube-proxy.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-proxy/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None needed.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.4_If_proxy_kubeconfig_file_exists_ensure_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">If proxy kubeconfig file exists ensure ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
If             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 is running, ensure that the file ownership of its kubeconfig file is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The kubeconfig file for             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 controls various parameters for the             <xhtml:span class="inline_block">kube-proxy</xhtml:span>
 service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/networking/openshift_sdn/configuring-kube-proxy.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kube-proxy/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. The configuration is managed by OpenShift operators.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.5_Ensure_that_the_--kubeconfig_kubelet.conf_file_permissions_are_set_to_644_or_more_restrictive" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --kubeconfig kubelet.conf file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">kubelet.conf</xhtml:span>
 file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">kubelet.conf</xhtml:span>
 file is the kubeconfig file for the node, and controls various parameters that set the behavior and identity of the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/master/01-master-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/worker/01-worker-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.6_Ensure_that_the_--kubeconfig_kubelet.conf_file_ownership_is_set_to_rootroot" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --kubeconfig kubelet.conf file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the             <xhtml:span class="inline_block">kubelet.conf</xhtml:span>
 file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">kubelet.conf</xhtml:span>
 file is the kubeconfig file for the node, and controls various parameters that set the behavior and identity of the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/master/01-master-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/worker/01-worker-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.7_Ensure_that_the_certificate_authorities_file_permissions_are_set_to_644_or_more_restrictive" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the certificate authorities file permissions are set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the certificate authorities file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The certificate authorities file controls the authorities used to validate API requests. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/master/01-master-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/worker/01-worker-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/authentication/#x509-client-certs</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1473532" value-id="xccdf_org.cisecurity.benchmarks_value_1473532_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473532"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.8_Ensure_that_the_client_certificate_authorities_file_ownership_is_set_to_rootroot" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the client certificate authorities file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that the certificate authorities file ownership is set to             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The certificate authorities file controls the authorities used to validate API requests. You should set its file ownership to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/master/01-master-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/worker/01-worker-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/authentication/#x509-client-certs</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1473533" value-id="xccdf_org.cisecurity.benchmarks_value_1473533_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473533"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.9_Ensure_that_the_kubelet_--config_configuration_file_has_permissions_set_to_644_or_more_restrictive" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the kubelet --config configuration file has permissions set to 644 or more restrictive</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that if the kubelet refers to a configuration file with the             <xhtml:span class="inline_block">--config</xhtml:span>
 argument, that file has permissions of             <xhtml:span class="inline_block">644</xhtml:span>
 or more restrictive.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The kubelet reads various parameters, including security settings, from a config file specified by the             <xhtml:span class="inline_block">--config</xhtml:span>
 argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/docs/KubeletConfigDesign.md</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1473534" value-id="xccdf_org.cisecurity.benchmarks_value_1473534_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473534"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1.10_Ensure_that_the_kubelet_configuration_file_ownership_is_set_to_rootroot" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the kubelet configuration file ownership is set to root:root</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Ensure that if the kubelet refers to a configuration file with the             <xhtml:span class="inline_block">--config</xhtml:span>
 argument, that file is owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The kubelet reads various parameters, including security settings, from a config file specified by the             <xhtml:span class="inline_block">--config</xhtml:span>
 argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be owned by             <xhtml:span class="inline_block">root:root</xhtml:span>
.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/docs/KubeletConfigDesign.md</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
          <check-export export-name="oval:org.cisecurity.benchmarks:var:1473535" value-id="xccdf_org.cisecurity.benchmarks_value_1473535_var"/>
          <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473535"/>
        </check>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4.2_Kubelet">
      <xccdf:title xml:lang="en">Kubelet</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>This section contains recommendations for kubelet configuration. In OpenShift 4, the kubelet is managed by the Machine Config Operator.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.1_Ensure_that_the_--anonymous-auth_argument_is_set_to_false" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --anonymous-auth argument is set to false</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable anonymous requests to the Kubelet server.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the Kubelet server. You should rely on authentication to authorize access and disallow anonymous requests.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/docs/KubeletConfigDesign.md</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/#kubelet-authentication</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Follow the instructions in the documentation to create a Kubelet config CRD and set the                 <xhtml:span class="inline_block">anonymous-auth</xhtml:span>
 is set to                 <xhtml:span class="inline_block">false</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Anonymous requests will be rejected.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1474647" value-id="xccdf_org.cisecurity.benchmarks_value_1474647_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1474647"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.2_Ensure_that_the_--authorization-mode_argument_is_not_set_to_AlwaysAllow" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --authorization-mode argument is not set to AlwaysAllow</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not allow all requests. Enable explicit authorization.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubelets, by default, allow all authenticated requests (even anonymous ones) without needing explicit authorization checks from the apiserver. You should restrict this behavior and only allow explicitly authorized requests.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/docs/KubeletConfigDesign.md</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/#kubelet-authentication</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required. Unauthenticated/Unauthorized users have no access to OpenShift nodes.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Unauthorized requests will be denied.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1474648" value-id="xccdf_org.cisecurity.benchmarks_value_1474648_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1474648"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.3_Ensure_that_the_--client-ca-file_argument_is_set_as_appropriate" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --client-ca-file argument is set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable Kubelet authentication using certificates.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubeletâ€™s port-forwarding functionality. These connections terminate at the kubeletâ€™s HTTPS endpoint. By default, the apiserver does not verify the kubeletâ€™s serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks. Enabling Kubelet certificate authentication ensures that the apiserver could authenticate the Kubelet before submitting any requests.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/docs/KubeletConfigDesign.md</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L28-L29</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
None required. Changing the                 <xhtml:span class="inline_block">clientCAFile</xhtml:span>
 value is unsupported.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You require TLS to be configured on apiserver as well as kubelets.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1474649" value-id="xccdf_org.cisecurity.benchmarks_value_1474649_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1474649"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.4_Verify_that_the_read_only_port_is_not_used_or_is_set_to_0" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Verify that the read only port is not used or is set to 0</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Disable the read-only port.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The Kubelet process provides a read-only API in addition to the main Kubelet API. Unauthenticated access is provided to this read-only API which could possibly retrieve potentially sensitive information about the cluster.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/docs/KubeletConfigDesign.md</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.5/bindata/v4.1.0/config/defaultconfig.yaml#L28-L29</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/cluster-kube-apiserver-operator/blob/release-4.6/bindata/v4.1.0/config/defaultconfig.yaml#L114-L115</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/kubernetes-kubelet/blob/origin-4.5-kubernetes-1.18.3/config/v1beta1/types.go#L135-L141</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
In earlier versions of OpenShift 4, the                 <xhtml:span class="inline_block">read-only-port</xhtml:span>
 argument is not used.              </xhtml:p>
              <xhtml:p>
Follow the instructions in the documentation to create a Kubelet config CRD and set the                 <xhtml:span class="inline_block">--read-only-port</xhtml:span>
 is set to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Removal of the read-only port will require that any service which made use of it will need to be re-configured to use the main Kubelet API.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="OR">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1473543" value-id="xccdf_org.cisecurity.benchmarks_value_1473543_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473543"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1473544" value-id="xccdf_org.cisecurity.benchmarks_value_1473544_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473544"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.5_Ensure_that_the_--streaming-connection-idle-timeout_argument_is_not_set_to_0" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --streaming-connection-idle-timeout argument is not set to 0</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not disable timeouts on streaming connections.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Setting idle timeouts ensures that you are protected against Denial-of-Service attacks, inactive connections and running out of ephemeral ports.</xhtml:p>
          <xhtml:p>
            <xhtml:strong>Note:</xhtml:strong>
 By default,             <xhtml:span class="inline_block">--streaming-connection-idle-timeout</xhtml:span>
 is set to 4 hours which might be too high for your environment. Setting this as appropriate would additionally ensure that such streaming connections are timed out after serving legitimate use cases.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/18552</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Follow the instructions in the documentation to create a Kubelet config CRD and set the                 <xhtml:span class="inline_block">--streaming-connection-idle-timeout</xhtml:span>
 to the desired value. Do not set the value to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Long-lived connections could be interrupted.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1473539" value-id="xccdf_org.cisecurity.benchmarks_value_1473539_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473539"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.6_Ensure_that_the_--protect-kernel-defaults_argument_is_not_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --protect-kernel-defaults argument is not set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Protect tuned kernel parameters from overriding kubelet default kernel parameter values.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/3" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/kubernetes-kubelet/blob/origin-4.5-kubernetes-1.18.3/config/v1beta1/types.go#L618-L626</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
None required. The OpenShift 4 kubelet modifies the system tunable; using the                 <xhtml:span class="inline_block">protect-kernel-defaults</xhtml:span>
 flag will cause the kubelet to fail on start if the tunables don't match the kubelet configuration and the OpenShift node will fail to start.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You would have to re-tune kernel parameters to match kubelet parameters.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.7_Ensure_that_the_--make-iptables-util-chains_argument_is_set_to_true" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --make-iptables-util-chains argument is set to true</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Allow Kubelet to manage iptables.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubelets can automatically manage the required changes to iptables based on how you choose your networking options for the pods. It is recommended to let kubelets manage the changes to iptables. This ensures that the iptables configuration remains in sync with pods networking configuration. Manually configuring iptables with dynamic pod network configuration changes might hamper the communication between pods/containers and to the outside world. You might have iptables rules too restrictive or too open.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/kubernetes-kubelet/blob/origin-4.5-kubernetes-1.18.3/config/v1beta1/types.go#L618-L626</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
None required. The                 <xhtml:span class="inline_block">--make-iptables-util-chains</xhtml:span>
 argument is set to true by default.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Kubelet would manage the iptables on the system and keep it in sync. If you are using any other iptables management solution, then there might be some conflicts.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.8_Ensure_that_the_--hostname-override_argument_is_not_set" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --hostname-override argument is not set</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not override node hostnames.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Overriding hostnames could potentially break TLS setup between the kubelet and the apiserver. Additionally, with overridden hostnames, it becomes increasingly difficult to associate logs with a particular node and process them for security analytics. Hence, you should setup your kubelet nodes with resolvable FQDNs and avoid overriding the hostnames with IPs.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/3" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/master/01-master-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/worker/01-worker-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/22063</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Some cloud providers may require this flag to ensure that hostname matches names issued by the cloud provider.  In these environments, this recommendation should not apply.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.9_Ensure_that_the_kubeAPIQPS_--event-qps_argument_is_set_to_0_or_a_level_which_ensures_appropriate_event_capture" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the kubeAPIQPS [--event-qps] argument is set to 0 or a level which ensures appropriate event capture</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Security relevant information should be captured.  The             <xhtml:span class="inline_block">--event-qps</xhtml:span>
 flag on the Kubelet can be used to limit the rate at which events are gathered.  Setting this too low could result in relevant events not being logged, however the unlimited setting of             <xhtml:span class="inline_block">0</xhtml:span>
 could result in a denial of service on the kubelet.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>It is important to capture all events and not restrict event creation. Events are an important source of security information and analytics that ensure that your environment is consistently monitored using the event data.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/6" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters_</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/master/01-master-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/worker/01-worker-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/apis/kubeletconfig/v1beta1/types.go</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Follow the documentation to edit kubelet parameters</xhtml:p>
              <xhtml:p>https://docs.openshift.com/container-platform/4.5/scalability_and_performance/recommended-host-practices.html#create-a-kubeletconfig-crd-to-edit-kubelet-parameters</xhtml:p>
              <xhtml:code class="code_block">KubeAPIQPS: &lt;QPS&gt;
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Setting this parameter to                   <xhtml:span class="inline_block">0</xhtml:span>
 could result in a denial of service condition due to excessive events being created.  The cluster's event processing and storage systems should be scaled to handle expected event loads.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1473540" value-id="xccdf_org.cisecurity.benchmarks_value_1473540_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473540"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.10_Ensure_that_the_--tls-cert-file_and_--tls-private-key-file_arguments_are_set_as_appropriate" role="full" selected="false" weight="1.0">
        <xccdf:title xml:lang="en">Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Setup TLS connection on the Kubelets.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The connections from the             <xhtml:span class="inline_block">apiserver</xhtml:span>
 to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubeletâ€™s port-forwarding functionality. These connections terminate at the kubeletâ€™s HTTPS endpoint. By default, the             <xhtml:span class="inline_block">apiserver</xhtml:span>
 does not verify the kubeletâ€™s serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/</xccdf:ident>
        <xccdf:ident system="URL">https://rootsquash.com/2016/05/10/securing-the-kubernetes-api/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kelseyhightower/docker-kubernetes-tls-guide</xccdf:ident>
        <xccdf:ident system="URL">https://jvns.ca/blog/2017/08/05/how-kubernetes-certificates-work/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
OpenShift automatically manages TLS authentication for the API server communication with the                 <xhtml:span class="inline_block">node/kublet</xhtml:span>
. This is not configurable.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>TLS and client certificate authentication must be configured for your Kubernetes cluster deployment.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
        <xccdf:complex-check operator="AND">
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1473541" value-id="xccdf_org.cisecurity.benchmarks_value_1473541_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473541"/>
          </check>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-export export-name="oval:org.cisecurity.benchmarks:var:1473542" value-id="xccdf_org.cisecurity.benchmarks_value_1473542_var"/>
            <check-content-ref href="CIS_RedHat_OpenShift_Container_Platform_v4_Benchmark_v1.1.0-oval.xml" name="oval:org.cisecurity.benchmarks:def:1473542"/>
          </check>
        </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.11_Ensure_that_the_--rotate-certificates_argument_is_not_set_to_false" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the --rotate-certificates argument is not set to false</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable kubelet client certificate rotation.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">--rotate-certificates</xhtml:span>
 setting causes the kubelet to rotate its client certificates by creating new CSRs as its existing credentials expire. This automated periodic rotation ensures that the there is no downtime due to expired certificates and thus addressing availability in the CIA security triad.          </xhtml:p>
          <xhtml:p>Note: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/architecture/control-plane.html#understanding-machine-config-operator_control-plane</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/kubernetes-kubelet/blob/origin-4.5-kubernetes-1.18.3/config/v1beta1/types.go#L172-L181</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/master/01-master-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/worker/01-worker-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/41912</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/#kubelet-configuration</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/imported/release/notes/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/feature-gates/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.12_Verify_that_the_RotateKubeletServerCertificate_argument_is_set_to_true" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Verify that the RotateKubeletServerCertificate argument is set to true</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Enable kubelet server certificate rotation.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
            <xhtml:span class="inline_block">RotateKubeletServerCertificate</xhtml:span>
 causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.          </xhtml:p>
          <xhtml:p>Note: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/master/01-master-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/openshift/machine-config-operator/blob/release-4.5/templates/worker/01-worker-kubelet/_base/files/kubelet.yaml</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/45059</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/#kubelet-configuration</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2.13_Ensure_that_the_Kubelet_only_makes_use_of_Strong_Cryptographic_Ciphers" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the Kubelet only makes use of Strong Cryptographic Ciphers</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Ensure that the Kubelet is configured to only use strong cryptographic ciphers.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/3/subcontrol/4" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Follow the directions above and in the OpenShift documentation to configure the                 <xhtml:span class="inline_block">tlsSecurityProfile</xhtml:span>
.                 <xhtml:a href="https://docs.openshift.com/container-platform/4.5/networking/ingress-operator.html#nw-ingress-controller-configuration-parameters_configuring-ingress">Configuring Ingress</xhtml:a>
              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Kubelet clients that cannot support modern cryptographic ciphers will not be able to make connections to the Kubelet API.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
  </xccdf:Group>
  <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_Policies">
    <xccdf:title xml:lang="en">Policies</xccdf:title>
    <xccdf:description xml:lang="en">
      <xhtml:p>This section contains recommendations for various Kubernetes policies which are important to the security of the environment.</xhtml:p>
    </xccdf:description>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.1_RBAC_and_Service_Accounts">
      <xccdf:title xml:lang="en">RBAC and Service Accounts</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_that_the_cluster-admin_role_is_only_used_where_required" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the cluster-admin role is only used where required</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
The RBAC role             <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 provides wide-ranging powers over the environment and should be used only where and when needed.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Kubernetes provides a set of default roles where RBAC is used. Some of these roles such as             <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 provide wide-ranging privileges which should only be applied where absolutely necessary. Roles such as             <xhtml:span class="inline_block">cluster-admin</xhtml:span>
 allow super-user access to perform any action on any resource. When used in a             <xhtml:span class="inline_block">ClusterRoleBinding</xhtml:span>
, it gives full control over every resource in the cluster and in all namespaces. When used in a             <xhtml:span class="inline_block">RoleBinding</xhtml:span>
, it gives full control over every resource in the rolebinding's namespace, including the namespace itself.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/rbac/#user-facing-roles</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Identify all                 <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 to the cluster-admin role. Check if they are used and if they need this role or if they could use a role with fewer privileges.              </xhtml:p>
              <xhtml:p>
Where possible, first bind users to a lower privileged role and then remove the                 <xhtml:span class="inline_block">clusterrolebinding</xhtml:span>
 to the cluster-admin role :              </xhtml:p>
              <xhtml:code class="code_block">oc delete clusterrolebinding [name]
</xhtml:code>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Care should be taken before removing any                   <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 from the environment to ensure they were not required for operation of the cluster. Specifically, modifications should not be made to                   <xhtml:span class="inline_block">clusterrolebindings</xhtml:span>
 with the                   <xhtml:span class="inline_block">system:</xhtml:span>
 prefix as they are required for the operation of system components.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.2_Minimize_access_to_secrets" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize access to secrets</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster.  Access to these secrets should be restricted to the smallest possible group of users to reduce the risk of privilege escalation.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Inappropriate access to secrets stored within the Kubernetes cluster can allow for an attacker to gain additional access to the Kubernetes cluster or external resources whose credentials are stored as secrets.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Where possible, remove                 <xhtml:span class="inline_block">get</xhtml:span>
,                 <xhtml:span class="inline_block">list</xhtml:span>
 and                 <xhtml:span class="inline_block">watch</xhtml:span>
 access to                 <xhtml:span class="inline_block">secret</xhtml:span>
 objects in the cluster.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Care should be taken not to remove access to secrets to system components which require this for their operation</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.3_Minimize_wildcard_use_in_Roles_and_ClusterRoles" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize wildcard use in Roles and ClusterRoles</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Kubernetes Roles and ClusterRoles provide access to resources based on sets of objects and actions that can be taken on those objects.  It is possible to set either of these to be the wildcard "*" which matches all items.</xhtml:p>
          <xhtml:p>Use of wildcards is not optimal from a security perspective as it may allow for inadvertent access to be granted when new resources are added to the Kubernetes API either as CRDs or in later versions of the product.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The principle of least privilege recommends that users are provided only the access required for their role and nothing more.  The use of wildcard rights grants is likely to provide excessive rights to the Kubernetes API.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Where possible replace any use of wildcards in clusterroles and roles with specific objects or actions.</xhtml:p>
              <xhtml:p/>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.4_Minimize_access_to_create_pods" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize access to create pods</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>The ability to create pods in a namespace can provide a number of opportunities for privilege escalation, such as assigning privileged service accounts to these pods or mounting hostPaths with access to sensitive data (unless Pod Security Policies are implemented to restrict this access)</xhtml:p>
          <xhtml:p>As such, access to create new pods should be restricted to the smallest possible group of users.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>The ability to create pods in a cluster opens up possibilities for privilege escalation and should be restricted, where possible.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Where possible, remove                 <xhtml:span class="inline_block">create</xhtml:span>
 access to                 <xhtml:span class="inline_block">pod</xhtml:span>
 objects in the cluster.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Care should be taken not to remove access to pods to system components which require this for their operation</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_that_default_service_accounts_are_not_actively_used." role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that default service accounts are not actively used.</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
The             <xhtml:span class="inline_block">default</xhtml:span>
 service account should not be used to ensure that rights granted to applications can be more easily audited and reviewed.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Kubernetes provides a             <xhtml:span class="inline_block">default</xhtml:span>
 service account which is used by cluster workloads where no specific service account is assigned to the pod.          </xhtml:p>
          <xhtml:p>Where access to the Kubernetes API from a pod is required, a specific service account should be created for that pod, and rights granted to that service account.</xhtml:p>
          <xhtml:p>The default service account should be configured such that it does not provide a service account token and does not have any explicit rights assignments.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>All workloads which require access to the Kubernetes API will require an explicit service account to be created.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_that_Service_Account_Tokens_are_only_mounted_where_necessary" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that Service Account Tokens are only mounted where necessary</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Service accounts tokens should not be mounted in pods except where the workload running in the pod explicitly needs to communicate with the API server</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Mounting service account tokens inside pods can provide an avenue for privilege escalation attacks where an attacker is able to compromise a single pod in the cluster.</xhtml:p>
          <xhtml:p>Avoiding mounting these tokens removes this attack avenue.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Modify the definition of pods and service accounts which do not need to mount service account tokens to disable it.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Pods mounted without service account tokens will not be able to communicate with the API server, except where the resource is available to unauthenticated principals.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.2_Pod_Security_Policies">
      <xccdf:title xml:lang="en">Pod Security Policies</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>A Pod Security Policy (SCC) is a cluster-level resource that controls security settings for pods. PodSecurityPolicies are used in conjunction with the PodSecurityPolicy admission controller plugin.</xhtml:p>
        <xhtml:p>OpenShift uses the Security Context Constraint (SCC) admission controller plugin instead of PodSecurityPolicies. The SCC plugin cannot be disabled. The PSP plugin cannot be enabled.</xhtml:p>
        <xhtml:p>Similar to the way that RBAC resources control user access, administrators can use Security Context Constraints (SCCs) to control permissions for pods. These permissions include actions that a pod, a collection of containers, can perform and what resources it can access. You can use SCCs to define a set of conditions that a pod must run with in order to be accepted into the system.</xhtml:p>
        <xhtml:p>By default, OpenShift 4 is configured with multiple SCCs. You can query SCCs with the following command:</xhtml:p>
        <xhtml:code class="code_block">oc get scc
</xhtml:code>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.1_Minimize_the_admission_of_privileged_containers" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of privileged containers</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Do not generally permit containers to be run with the             <xhtml:span class="inline_block">securityContext.privileged</xhtml:span>
 flag set to             <xhtml:span class="inline_block">true</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Privileged containers have access to all Linux Kernel capabilities and devices. A container running with full privileges can do almost everything that the host can do. This flag exists to allow special use-cases, like manipulating the network stack and accessing devices.</xhtml:p>
          <xhtml:p>There should be at least one Security Context Constraint (SCC) defined which does not permit privileged containers.</xhtml:p>
          <xhtml:p>If you need to run privileged containers, this should be defined in a separate SCC and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that SCC.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a SCC as described in the OpenShift documentation, ensuring that the                 <xhtml:span class="inline_block">Allow Privileged</xhtml:span>
 field is set to                 <xhtml:span class="inline_block">false</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Pods defined with                   <xhtml:span class="inline_block">spec.containers[].securityContext.privileged: true</xhtml:span>
 will not be permitted.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.2_Minimize_the_admission_of_containers_wishing_to_share_the_host_process_ID_namespace" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers wishing to share the host process ID namespace</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Do not generally permit containers to be run with the             <xhtml:span class="inline_block">hostPID</xhtml:span>
 flag set to true.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A container running in the host's PID namespace can inspect processes running outside the container. If the container also has access to ptrace capabilities this can be used to escalate privileges outside of the container.</xhtml:p>
          <xhtml:p>There should be at least one Security Context Constraint (SCC) defined which does not permit containers to share the host PID namespace.</xhtml:p>
          <xhtml:p>If you need to run containers which require hostPID, this should be defined in a separate SCC and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that SCC.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a SCC as described in the OpenShift documentation, ensuring that the                 <xhtml:span class="inline_block">Allow Host PID</xhtml:span>
 field is set to false.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Pods defined with                   <xhtml:span class="inline_block">Allow Host PID:  true</xhtml:span>
 will not be permitted unless they are run under a specific SCC.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.3_Minimize_the_admission_of_containers_wishing_to_share_the_host_IPC_namespace" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers wishing to share the host IPC namespace</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Do not generally permit containers to be run with the             <xhtml:span class="inline_block">hostIPC</xhtml:span>
 flag set to true.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A container running in the host's IPC namespace can use IPC to interact with processes outside the container.</xhtml:p>
          <xhtml:p>There should be at least one Security Context Constraint (SCC) defined which does not permit containers to share the host IPC namespace.</xhtml:p>
          <xhtml:p>If you have a requirement to containers which require hostIPC, this should be defined in a separate SCC and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that SCC.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a SCC as described in the OpenShift documentation, ensuring that the                 <xhtml:span class="inline_block">Allow Host IPC</xhtml:span>
 field is set to                 <xhtml:span class="inline_block">false</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Pods defined with                   <xhtml:span class="inline_block">Allow Host IPC: true</xhtml:span>
 will not be permitted unless they are run under a specific SCC.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.4_Minimize_the_admission_of_containers_wishing_to_share_the_host_network_namespace" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers wishing to share the host network namespace</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Do not generally permit containers to be run with the             <xhtml:span class="inline_block">hostNetwork</xhtml:span>
 flag set to true.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A container running in the host's network namespace could access the local loopback device, and could access network traffic to and from other pods.</xhtml:p>
          <xhtml:p>There should be at least one Security Context Constraint (SCC) defined which does not permit containers to share the host network namespace.</xhtml:p>
          <xhtml:p>If you have need to run containers which require hostNetwork, this should be defined in a separate SCC and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that SCC.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a SCC as described in the OpenShift documentation, ensuring that the                 <xhtml:span class="inline_block">Allow Host Network</xhtml:span>
 field is omitted or set to                 <xhtml:span class="inline_block">false</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Pods defined with                   <xhtml:span class="inline_block">Allow Host Network: true</xhtml:span>
 will not be permitted unless they are run under a specific SCC.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.5_Minimize_the_admission_of_containers_with_allowPrivilegeEscalation" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers with allowPrivilegeEscalation</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Do not generally permit containers to be run with the             <xhtml:span class="inline_block">allowPrivilegeEscalation</xhtml:span>
 flag set to             <xhtml:span class="inline_block">true</xhtml:span>
.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
A container running with the             <xhtml:span class="inline_block">allowPrivilegeEscalation</xhtml:span>
 flag set to             <xhtml:span class="inline_block">true</xhtml:span>
 may have processes that can gain more privileges than their parent.          </xhtml:p>
          <xhtml:p>There should be at least one Security Context Constraint (SCC) defined which does not permit containers to allow privilege escalation. The option exists (and is defaulted to true) to permit setuid binaries to run.</xhtml:p>
          <xhtml:p>If you have need to run containers which use setuid binaries or require privilege escalation, this should be defined in a separate SCC and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that SCC.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a SCC as described in the OpenShift documentation, ensuring that the                 <xhtml:span class="inline_block">Allow Privilege Escalation</xhtml:span>
 field is set to                 <xhtml:span class="inline_block">false</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
Pods defined with                   <xhtml:span class="inline_block">Allow Privilege Escalation: true</xhtml:span>
 will not be permitted unless they are run under a specific SCC.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.6_Minimize_the_admission_of_root_containers" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of root containers</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not generally permit containers to be run as the root user.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Containers may run as any Linux user. Containers which run as the root user, whilst constrained by Container Runtime security features still have an escalated likelihood of container breakout.</xhtml:p>
          <xhtml:p>Ideally, all containers should run as a defined non-UID 0 user.</xhtml:p>
          <xhtml:p>There should be at least one Security Context Constraint (SCC) defined which does not permit root users in a container.</xhtml:p>
          <xhtml:p>If you need to run root containers, this should be defined in a separate SCC and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that SCC.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
None required. By default, OpenShift includes the non-root SCC with the the                 <xhtml:span class="inline_block">Run As User Strategy</xhtml:span>
 is set to either                 <xhtml:span class="inline_block">MustRunAsNonRoot</xhtml:span>
.  If additional SCCs are appropriate, follow the OpenShift documentation to create custom SCCs.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Pods with containers which run as the root user will not be permitted.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.7_Minimize_the_admission_of_containers_with_the_NET_RAW_capability" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers with the NET_RAW capability</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not generally permit containers with the potentially dangerous NET_RAW capability.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Containers run with a default set of capabilities as assigned by the Container Runtime. By default this can include potentially dangerous capabilities. With Docker as the container runtime the NET_RAW capability is enabled which may be misused by malicious containers.</xhtml:p>
          <xhtml:p>Ideally, all containers should drop this capability.</xhtml:p>
          <xhtml:p>There should be at least one Security Context Constraint (SCC) defined which prevents containers with the NET_RAW capability from launching.</xhtml:p>
          <xhtml:p>If you need to run containers with this capability, this should be defined in a separate SCC and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that SCC.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
        <xccdf:ident system="URL">https://www.nccgroup.trust/uk/our-research/abusing-privileged-and-unprivileged-linux-containers/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Create a SCC as described in the OpenShift documentation, ensuring that the                 <xhtml:span class="inline_block">Required Drop Capabilities</xhtml:span>
 is set to include either                 <xhtml:span class="inline_block">NET_RAW</xhtml:span>
 or                 <xhtml:span class="inline_block">ALL</xhtml:span>
.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Pods with containers which run with the NET_RAW capability will not be permitted.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.8_Minimize_the_admission_of_containers_with_added_capabilities" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers with added capabilities</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not generally permit containers with capabilities assigned beyond the default set.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Containers run with a default set of capabilities as assigned by the Container Runtime. Capabilities outside this set can be added to containers which could expose them to risks of container breakout attacks.</xhtml:p>
          <xhtml:p>There should be at least one Security Context Constraint (SCC) defined which prevents containers with capabilities beyond the default set from launching.</xhtml:p>
          <xhtml:p>If you need to run containers with additional capabilities, this should be defined in a separate SCC and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that SCC.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
        <xccdf:ident system="URL">https://www.nccgroup.com/uk/our-research/abusing-privileged-and-unprivileged-linux-containers/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Ensure that                 <xhtml:span class="inline_block">Allowed Capabilities</xhtml:span>
 is set to an empty array for every  SCC in the cluster except for the                 <xhtml:span class="inline_block">privileged</xhtml:span>
 SCC.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Pods with containers which require capabilities outside the default set will not be permitted.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2.9_Minimize_the_admission_of_containers_with_capabilities_assigned" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Minimize the admission of containers with capabilities assigned</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Do not generally permit containers with capabilities</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Containers run with a default set of capabilities as assigned by the Container Runtime. Capabilities are parts of the rights generally granted on a Linux system to the root user.</xhtml:p>
          <xhtml:p>In many cases applications running in containers do not require any capabilities to operate, so from the perspective of the principal of least privilege use of capabilities should be minimized.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/authentication/managing-security-context-constraints.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies</xccdf:ident>
        <xccdf:ident system="URL">https://www.nccgroup.com/uk/our-research/abusing-privileged-and-unprivileged-linux-containers/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Review the use of capabilities in applications running on your cluster. Where a namespace contains applications which do not require any Linux capabilities to operate consider adding a SCC which forbids the admission of containers which do not drop all capabilities.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Pods with containers which require capabilities to operate will not be permitted.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.3_Network_Policies_and_CNI">
      <xccdf:title xml:lang="en">Network Policies and CNI</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3.1_Ensure_that_the_CNI_in_use_supports_Network_Policies" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the CNI in use supports Network Policies</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>There are a variety of CNI plugins available for Kubernetes. If the CNI in use does not support Network Policies it may not be possible to effectively restrict traffic in the cluster.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubernetes network policies are enforced by the CNI plugin in use. As such it is important to ensure that the CNI plugin supports both Ingress and Egress network policies.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/networking/openshift-sdn/about-openshift-sdn.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>None required.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3.2_Ensure_that_all_Namespaces_have_Network_Policies_defined" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that all Namespaces have Network Policies defined</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use network policies to isolate traffic in your cluster network.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. A network policy is a specification of how selections of pods are allowed to communicate with each other and other network endpoints.</xhtml:p>
          <xhtml:p>Network Policies are namespace scoped. When a network policy is introduced to a given namespace, all traffic not allowed by the policy is denied. However, if there are no network policies in a namespace all traffic will be allowed into and out of the pods in that namespace.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14/subcontrol/1" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/networking/network_policy/about-network-policy.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/networking/network_policy/creating-network-policy.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/networking/network_policy/multitenant-network-policy.html</xccdf:ident>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.5/networking/network_policy/default-network-policy.html</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/services-networking/network-policies/</xccdf:ident>
        <xccdf:ident system="URL">https://octetz.com/docs/2019/2019-04-22-netpol-api-k8s/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/docs/tasks/administer-cluster/declare-network-policy/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
Follow the documentation and create                 <xhtml:span class="inline_block">NetworkPolicy</xhtml:span>
 objects as you need them.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Once network policies are in use within a given namespace, traffic not explicitly allowed by a network policy will be denied. As such it is important to ensure that, when introducing network policies, legitimate traffic is not blocked.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.4_Secrets_Management">
      <xccdf:title xml:lang="en">Secrets Management</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.1_Prefer_using_secrets_as_files_over_secrets_as_environment_variables" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Prefer using secrets as files over secrets as environment variables</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Kubernetes supports mounting secrets as data volumes or as environment variables. Minimize the use of environment variable secrets.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>It is reasonably common for application code to log out its environment (particularly in the event of an error). This will include any secret values passed in as environment variables, so secrets can easily be exposed to any user or entity who has access to the logs.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>If possible, rewrite application code to read secrets from mounted secret files, rather than from environment variables.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>Application code which expects to read secrets in the form of environment variables would need modification</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.4.2_Consider_external_secret_storage" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Consider external secret storage</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Consider the use of an external secrets storage and management system, instead of using Kubernetes Secrets directly, if you have more complex secret management needs. Ensure the solution requires authentication to access secrets, has auditing of access to and use of secrets, and encrypts secrets. Some solutions also make it easier to rotate secrets.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubernetes supports secrets as first-class objects, but care needs to be taken to ensure that access to secrets is carefully limited. Using an external secrets provider can ease the management of access to secrets, especially where secrets are used across both Kubernetes and non-Kubernetes environments.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Refer to the secrets management options offered by your cloud provider or a third-party secrets management solution.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.5_Extensible_Admission_Control">
      <xccdf:title xml:lang="en">Extensible Admission Control</xccdf:title>
      <xccdf:description xml:lang="en"/>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.5.1_Configure_Image_Provenance_using_image_controller_configuration_parameters" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Configure Image Provenance using image controller configuration parameters</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Configure Image Provenance for your deployment.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Kubernetes supports plugging in provenance rules to accept or reject the images in your deployments. You could configure such rules to ensure that only approved images are deployed in the cluster.</xhtml:p>
          <xhtml:p>
You can control which images can be imported, tagged, and run in a cluster using the image controller. For additional information on the image controller, see             <xhtml:a href="https://docs.openshift.com/container-platform/4.5/openshift_images/image-configuration.html">Image configuration resources</xhtml:a>
          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/18" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#imagepolicywebhook</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/community/blob/master/contributors/design-proposals/image-provenance.md</xccdf:ident>
        <xccdf:ident system="URL">https://hub.docker.com/r/dnurmi/anchore-toolbox/</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/22888</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Follow the OpenShift documentation: [Image configuration resources](https://docs.openshift.com/container-platform/4.5/openshift_images/image-configuration.html</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You need to regularly maintain your provenance configuration based on container image updates.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
    <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5.7_General_Policies">
      <xccdf:title xml:lang="en">General Policies</xccdf:title>
      <xccdf:description xml:lang="en">
        <xhtml:p>These policies relate to general cluster management topics, like namespace best practices and policies applied to pod objects in the cluster.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7.1_Create_administrative_boundaries_between_resources_using_namespaces" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Create administrative boundaries between resources using namespaces</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Use namespaces to isolate your Kubernetes objects.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>
Limiting the scope of user permissions can reduce the impact of mistakes or malicious activities. A Kubernetes namespace allows you to partition created resources into logically named groups. Resources created in one namespace can be hidden from other namespaces. By default, each resource created by a user in Kubernetes cluster runs in a default namespace, called             <xhtml:span class="inline_block">default</xhtml:span>
. You can create additional namespaces and attach resources and users to them. You can use Kubernetes Authorization plugins to create policies that segregate access to namespace resources between different users.          </xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/</xccdf:ident>
        <xccdf:ident system="URL">https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Follow the documentation and create namespaces for objects in your deployment as you need them.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>You need to switch between namespaces for administration.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7.2_Ensure_that_the_seccomp_profile_is_set_to_dockerdefault_in_your_pod_definitions" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Ensure that the seccomp profile is set to docker/default in your pod definitions</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>
Enable             <xhtml:span class="inline_block">default</xhtml:span>
 seccomp profile in your pod definitions.          </xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/5" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/4" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://docs.openshift.com/container-platform/4.2/authentication/managing-security-context-constraints.html#security-context-constraints-about_configuring-internal-oauth</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/issues/39845</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/kubernetes/pull/21790</xccdf:ident>
        <xccdf:ident system="URL">https://github.com/kubernetes/community/blob/master/contributors/design-proposals/seccomp.md#examples</xccdf:ident>
        <xccdf:ident system="URL">https://docs.docker.com/engine/security/seccomp/</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>
To enable the                 <xhtml:span class="inline_block">default</xhtml:span>
 seccomp profile, use the reserved value                 <xhtml:span class="inline_block">/runtime/default</xhtml:span>
 that will make sure that the pod uses the default policy available on the host.              </xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>
If the                   <xhtml:span class="inline_block">default</xhtml:span>
 seccomp profile is too restrictive for you, you will need to create and manage your own seccomp profiles.                </xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7.3_Apply_Security_Context_to_Your_Pods_and_Containers" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">Apply Security Context to Your Pods and Containers</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Apply Security Context to Your Pods and Containers</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume. There are two levels of security context: pod level security context, and container level security context.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/3" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/5" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident system="URL">https://kubernetes.io/docs/concepts/policy/security-context/</xccdf:ident>
        <xccdf:ident system="URL">https://learn.cisecurity.org/benchmarks</xccdf:ident>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Follow the Kubernetes documentation and apply security contexts to your pods. For a suggested list of security contexts, you may refer to the CIS Security Benchmark for Docker Containers.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>If you incorrectly apply security contexts, you may have trouble running the pods.</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.7.4_The_default_namespace_should_not_be_used" role="unscored" selected="false" weight="0.0">
        <xccdf:title xml:lang="en">The default namespace should not be used</xccdf:title>
        <xccdf:description xml:lang="en">
          <xhtml:p>Kubernetes provides a default namespace, where objects are placed if no namespace is specified for them. Placing objects in this namespace makes application of RBAC and other controls more difficult.</xhtml:p>
        </xccdf:description>
        <xccdf:rationale xml:lang="en">
          <xhtml:p>Resources in a Kubernetes cluster should be segregated by namespace, to allow for security controls to be applied at that level and to make it easier to manage resources.</xhtml:p>
        </xccdf:rationale>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/9/subcontrol/4" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
        <xccdf:ident cc6:controlURI="http://cisecurity.org/20-cc/v6.1/control/14" system="http://cisecurity.org/20-cc/v6.1"/>
        <xccdf:fixtext xml:lang="en">
          <xhtml:div>
            <xhtml:p>
              <xhtml:p>Ensure that namespaces are created to allow for appropriate segregation of Kubernetes resources and that all new resources are created in a specific namespace.</xhtml:p>
              <xhtml:p class="bold">Impact:</xhtml:p>
              <xhtml:p>
                <xhtml:p>None</xhtml:p>
              </xhtml:p>
            </xhtml:p>
          </xhtml:div>
        </xccdf:fixtext>
      </xccdf:Rule>
    </xccdf:Group>
  </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>ZE8cQLeNkfLBh/chOCljhWFz8BA=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
vMvjZ4GjDOI6+jI9KOCYcaRsrW2O9k1ld1HivezDsFT1+knmwKKC9VETJBONuc2XKbdq6JmKPB5V
pqbOuSVwQPQ+BleRCoosNZ23CmzE9fJ3+kK1lAPrx7ZayzjbC3pjt0cpS2l+pN1WciWDBcDYA+Eu
+x1i5CXzGvwRe/HHjvePJ68oefazEAID7mFTjlZJZgcIX4zhRjnSKJtQOijkr8qRz5rErvqc5dh3
0kMut0OAgQ2hrY+NR8PojhpTSSFKD5CS9cLEJsHQwnBJlsP4u5EMmMxxNwVekYdJK2Pcl1DmR1OX
ADxUR6na1NuiC1dWFG4CWQXdNYjvAbEYfTYvYg==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFUjCCBDqgAwIBAgIIPx+qZKptEY4wDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNv
bSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMw
MQYDVQQDEypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMjAw
OTA4MTMzOTM5WhcNMjMxMDI4MDAzMjA1WjCBkzELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE5ldyBZ
b3JrMRcwFQYDVQQHEw5FYXN0IEdyZWVuYnVzaDErMCkGA1UEChMiQ2VudGVyIGZvciBJbnRlcm5l
dCBTZWN1cml0eSwgSW5jLjErMCkGA1UEAxMiQ2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwg
SW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDBp4+sl9kB5JRmnQH0wcbLLz/t
n2HoD6TRl3xJj12V61njBNgaiGzvoSl07sFLnESukb0CU44MzYDoUMdx3HJUcEAeMY/9eITqGUnk
N4WsP145eFqH7FoszOY/4NYlgYMYt8ZP2kRHyim9LpQTLT/1mBaUkY2f2e5uUCootH3iT8W3/sK2
flLzWfLgXTvkhJm4Uvw1RErBFs15+krW0KWtnZ6NmiDhmV0CnFGNnd1meGZPs2sBXEVGLJVSKzoT
G9Ht/oWyRLRcJuXpHoXTYpkqM2MsixmSaJy5b6/D35r0NXHru3p1gkX2a0VgJQxxWqLi3bVPzpl3
PlJu3C8M/FUCAwEAAaOCAYUwggGBMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwMw
DgYDVR0PAQH/BAQDAgeAMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwuZ29kYWRkeS5jb20v
Z2RpZzJzNS02LmNybDBdBgNVHSAEVjBUMEgGC2CGSAGG/W0BBxcCMDkwNwYIKwYBBQUHAgEWK2h0
dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQQBMHYGCCsG
AQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUF
BzAChjRodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0
MB8GA1UdIwQYMBaAFEDCvSeOzDSDMKIz1/tss/C0LIDOMB0GA1UdDgQWBBT7fOf4ISDprbE+qUFe
+friFTKgHjANBgkqhkiG9w0BAQsFAAOCAQEAT0XLw2vmuq6e58bkLDXdqKeGQjREDChLw2Mae9LI
JB93QgdA2OCLA1FwU2s7lawEDcma9wPiugxVGoaQNOfRw2/+cz0xmR3uaKQq6I24dWbHF20N2tSz
1RAAK1lRZKewA1fj+qqKWjzETA0LpqZlaFF+CKBpQcyfYyQRZxpHkB1vvKMf4kMIRKruvl4ixLjN
uAZrbQUWlXuq/MUkVP3FgdxWBPfmMGyngHs4hNMaSQGb1TEhBjj+PGoSunAyaOgO/P94XJPQQX3O
2oNDsPou6gKcNtbZrH+iYTJ8rcqQTontMwSP/HrYj8lgG3neG53vk05p0jCn2M5W0ukJ4LPEnA==
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>
0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==
</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>